<!DOCTYPE html>
<html lang="en">
<!-- scarlett  -->

<head>
    <meta charset="UTF-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description"
        content="The Software for generation hashes(crypto-pairs from pub/private keys) of the PiriChain system.">

    <title>PIRI Hashes Generator</title>
    <link rel="icon" href="./favicon.ico" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>


    <!-- Google tag (gtag.js) -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-LTGW85D79N');
    </script>

    <style>
        /* thai */
        @font-face {
            font-family: 'Chakra Petch';
            font-style: normal;
            font-weight: 300;
            font-display: block;
            src: url(https://fonts.gstatic.com/s/chakrapetch/v11/cIflMapbsEk7TDLdtEz1BwkeNIh1U5_F7AY.woff2) format('woff2');
            unicode-range: U+0E01-0E5B, U+200C-200D, U+25CC;
        }

        /* vietnamese */
        @font-face {
            font-family: 'Chakra Petch';
            font-style: normal;
            font-weight: 300;
            font-display: block;
            src: url(https://fonts.gstatic.com/s/chakrapetch/v11/cIflMapbsEk7TDLdtEz1BwkeNIh1SJ_F7AY.woff2) format('woff2');
            unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;
        }

        /* latin-ext */
        @font-face {
            font-family: 'Chakra Petch';
            font-style: normal;
            font-weight: 300;
            font-display: block;
            src: url(https://fonts.gstatic.com/s/chakrapetch/v11/cIflMapbsEk7TDLdtEz1BwkeNIh1SZ_F7AY.woff2) format('woff2');
            unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
        }

        /* latin */
        @font-face {
            font-family: 'Chakra Petch';
            font-style: normal;
            font-weight: 300;
            font-display: block;
            src: url(https://fonts.gstatic.com/s/chakrapetch/v11/cIflMapbsEk7TDLdtEz1BwkeNIh1R5_F.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
        }
    </style>
    <style>
        html *:not(#videozone *) {
            font-family: 'Chakra Petch', sans-serif;
        }

        .flex-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: start;
        }

        .flex-item {
            width: 100%;
            min-width: 200px;
            max-width: 635px;
        }

        .footer-container {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }

        .footer-item {
            padding: 15px;
        }

        .img0 {
            width: 100%;
            cursor: pointer;
        }

        .slideshow-container {
            width: 100%;
            position: relative;
            margin: auto;
            align-items: center;
            display: flex;
            justify-content: center;
        }

        .mySlides {
            display: none;
            text-align: center;
            position: relative;
        }

        .prev,
        .next {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            margin-top: -22px;
            padding: 16px;
            color: #b0b0b0;
            font-weight: bold;
            font-size: 18px;
            transition: 0.6s ease;
            border-radius: 0 3px 3px 0;
            user-select: none;
            background-color: brown;
            text-decoration: none;
        }

        .prev {
            left: 0;
        }

        .next {
            right: 0;
            border-radius: 3px 0 0 3px;
        }


        .prev:hover,
        .next:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }


        .dot {
            cursor: pointer;
            height: 15px;
            width: 15px;
            margin: 0 2px;
            background-color: #bbb;
            border-radius: 50%;
            display: inline-block;
            transition: background-color 0.6s ease;
        }

        .active,
        .dot:hover {
            background-color: #717171;
        }

        .fade {
            animation-name: fade;
            animation-duration: 1.5s;
        }

        @keyframes fade {
            from {
                opacity: .4
            }

            to {
                opacity: 1
            }
        }

        #myImg {
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
        }

        #myImg:hover {
            opacity: 0.7;
        }


        .modal {
            display: flex;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.9);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            margin: auto;
            display: block;
            position: absolute;
            max-width: -moz-fit-content;
            max-width: fit-content;
            width: 80%;

            animation-name: zoom;
            animation-duration: 0.6s;
        }

        @keyframes zoom {
            from {
                transform: scale(0)
            }

            to {
                transform: scale(1)
            }
        }

        .checkout2Modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.9);
            justify-content: center;
        }

        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
        }

        .close:hover,
        .close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }

        @media only screen and (max-width: 700px) {
            .modal-content {
                width: 100%;
            }
        }

        /* CSS */
        .button-30 {
            align-items: center;
            appearance: none;
            background-color: #FCFCFD;
            border-radius: 4px;
            border-width: 0;
            box-shadow: rgba(45, 35, 66, 0.4) 0 2px 4px, rgba(45, 35, 66, 0.3) 0 7px 13px -3px, #D6D6E7 0 -3px 0 inset;
            box-sizing: border-box;
            color: #36395A;
            cursor: pointer;
            display: inline-flex;
            font-family: "JetBrains Mono", monospace;
            height: 42px;
            justify-content: center;
            line-height: 1;
            list-style: none;
            overflow: hidden;
            padding-left: 16px;
            padding-right: 16px;
            position: relative;
            text-align: left;
            text-decoration: none;
            transition: box-shadow .15s, transform .15s;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
            white-space: nowrap;
            will-change: box-shadow, transform;
            font-size: 18px;
        }

        .button-30:focus {
            box-shadow: #D6D6E7 0 0 0 1.5px inset, rgba(45, 35, 66, 0.4) 0 2px 4px, rgba(45, 35, 66, 0.3) 0 7px 13px -3px, #D6D6E7 0 -3px 0 inset;
        }

        .button-30:hover {
            box-shadow: rgba(45, 35, 66, 0.4) 0 4px 8px, rgba(45, 35, 66, 0.3) 0 7px 13px -3px, #D6D6E7 0 -3px 0 inset;
            transform: translateY(-2px);
        }

        .button-30:active {
            box-shadow: #D6D6E7 0 3px 7px inset;
            transform: translateY(2px);
        }


        /* CSS */
        .button-29 {
            align-items: center;
            appearance: none;
            background-image: radial-gradient(100% 100% at 100% 0, #5adaff 0, #5468ff 100%);
            border: 0;
            border-radius: 6px;
            box-shadow: rgba(45, 35, 66, .4) 0 2px 4px, rgba(45, 35, 66, .3) 0 7px 13px -3px, rgba(58, 65, 111, .5) 0 -3px 0 inset;
            box-sizing: border-box;
            color: #fff;
            cursor: pointer;
            display: inline-flex;
            font-family: "JetBrains Mono", monospace;
            height: 30px;
            justify-content: center;
            line-height: 1;
            list-style: none;
            overflow: hidden;
            padding-left: 16px;
            padding-right: 16px;
            position: relative;
            text-align: left;
            text-decoration: none;
            transition: box-shadow .15s, transform .15s;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
            white-space: nowrap;
            will-change: box-shadow, transform;
            font-size: 18px;
        }

        .button-29:focus {
            box-shadow: #3c4fe0 0 0 0 1.5px inset, rgba(45, 35, 66, .4) 0 2px 4px, rgba(45, 35, 66, .3) 0 7px 13px -3px, #3c4fe0 0 -3px 0 inset;
        }

        .button-29:hover {
            box-shadow: rgba(45, 35, 66, .4) 0 4px 8px, rgba(45, 35, 66, .3) 0 7px 13px -3px, #3c4fe0 0 -3px 0 inset;
            transform: translateY(-2px);
        }

        .button-29:active {
            box-shadow: #3c4fe0 0 3px 7px inset;
            transform: translateY(2px);
        }



        /* CSS */
        .button-23 {
            background-color: #FFFFFF;
            border: 1px solid #222222;
            border-radius: 8px;
            box-sizing: border-box;
            color: #222222;
            cursor: pointer;
            display: inline-block;
            font-family: Circular, -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;
            font-size: 16px;
            font-weight: 600;
            line-height: 20px;
            margin: 0;
            outline: none;
            padding: 4px 10px;
            position: relative;
            text-align: center;
            text-decoration: none;
            touch-action: manipulation;
            transition: box-shadow .2s, -ms-transform .1s, -webkit-transform .1s, transform .1s;
            user-select: none;
            -webkit-user-select: none;
            width: 160px;
        }

        .button-23:focus-visible {
            box-shadow: #222222 0 0 0 2px, rgba(255, 255, 255, 0.8) 0 0 0 4px;
            transition: box-shadow .2s;
        }

        .button-23:active {
            background-color: #F7F7F7;
            border-color: #000000;
            transform: scale(.96);
        }

        .button-23:disabled {
            border-color: #DDDDDD;
            color: #DDDDDD;
            cursor: not-allowed;
            opacity: 1;
        }

        #cookiePopup {
            background-color: #bbbbbb;
            position: fixed;
            box-shadow: 0 0 2em rgba(5, 0, 31, 1.15);
            text-align: justify;
            border-radius: 6px;
            transition: all 0.5s ease-in;
            bottom: 38px;
            right: 10px;
            z-index: 21;
        }

        @media (max-width: 537px) {
            #cookiePopup {
                left: 10px;
            }
        }

        @media (min-width: 537px) {
            #cookiePopup {
                left: unset;
            }
        }

        #cookiePopup p {
            margin-left: 15px;
        }

        #acceptCookie {
            background-color: #3520FE;
            border: none;
            color: #ffffff;
            font-size: 1.2em;
            display: block;
            position: relative;
            margin: auto;
            border-radius: 5px;
            cursor: pointer;
        }

        #closeCookie {
            background-color: #A80000;
            border: none;
            color: #ffffff;
            font-size: 1.2em;
            display: block;
            position: relative;
            margin: auto;
            border-radius: 5px;
            cursor: pointer;
        }

        #cookiePopup a {
            color: #000699;
        }

        .gdpr-container {
            display: none;
            flex-direction: column;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            min-width: 200px;
            max-width: 500px;

        }

        .ingdpr-container {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }




        #checkout2 {
            background-color: #ffffff;
            border: none;
            color: #000000;
            box-shadow: 0 0 2em rgba(5, 0, 31, 1.15);
            text-align: justify;
            border-radius: 6px;
            transition: all 0.5s ease-in;
            z-index: 21;
        }

        #close-checkout2 {
            background-color: #A80000;
            border: none;
            color: #ffffff;
            font-size: 1.2em;
            display: block;
            position: relative;
            margin: auto;
            border-radius: 5px;
            cursor: pointer;
        }

        #checkout2-Popup a {
            color: #000699;
        }

        .checkout2-container {
            flex-direction: column;
            align-items: center;
            min-width: 200px;
            max-width: 500px;
            display: flex;
            margin-top: 50px;
            width: 100%;
            margin-left: 10px;
            margin-right: 10px;
            min-height: 500px;
            max-height: 800px;
            height: min-content;
        }

        .loader {
            box-sizing: border-box;
            display: inline-block;
            width: 50px;
            height: 80px;
            border-top: 5px solid #fff;
            border-bottom: 5px solid #fff;
            position: relative;
            background: linear-gradient(#FF3D00 30px, transparent 0) no-repeat;
            background-size: 2px 40px;
            background-position: 50% 0px;
            animation: spinx 5s linear infinite;
        }

        .loader:before,
        .loader:after {
            content: "";
            width: 40px;
            left: 50%;
            height: 35px;
            position: absolute;
            top: 0;
            transform: translatex(-50%);
            background: rgba(255, 255, 255, 0.4);
            border-radius: 0 0 20px 20px;
            background-size: 100% auto;
            background-repeat: no-repeat;
            background-position: 0 0px;
            animation: lqt 5s linear infinite;
        }

        .loader:after {
            top: auto;
            bottom: 0;
            border-radius: 20px 20px 0 0;
            animation: lqb 5s linear infinite;
        }

        @keyframes lqt {

            0%,
            100% {
                background-image: linear-gradient(#FF3D00 40px, transparent 0);
                background-position: 0% 0px;
            }

            50% {
                background-image: linear-gradient(#FF3D00 40px, transparent 0);
                background-position: 0% 40px;
            }

            50.1% {
                background-image: linear-gradient(#FF3D00 40px, transparent 0);
                background-position: 0% -40px;
            }
        }

        @keyframes lqb {
            0% {
                background-image: linear-gradient(#FF3D00 40px, transparent 0);
                background-position: 0 40px;
            }

            100% {
                background-image: linear-gradient(#FF3D00 40px, transparent 0);
                background-position: 0 -40px;
            }
        }

        @keyframes spinx {

            0%,
            49% {
                transform: rotate(0deg);
                background-position: 50% 36px;
            }

            51%,
            98% {
                transform: rotate(180deg);
                background-position: 50% 4px;
            }

            100% {
                transform: rotate(360deg);
                background-position: 50% 36px;
            }
        }



        /* CSS */
        .button-42 {
            background-color: initial;
            background-image: linear-gradient(-180deg, #FF7E31, #E62C03);
            border-radius: 6px;
            box-shadow: rgba(0, 0, 0, 0.1) 0 2px 4px;
            color: #FFFFFF;
            cursor: pointer;
            display: inline-block;
            font-family: Inter, -apple-system, system-ui, Roboto, "Helvetica Neue", Arial, sans-serif;
            height: 33px;
            line-height: 33px;
            outline: 0;
            overflow: hidden;
            padding: 0 20px;
            pointer-events: auto;
            position: relative;
            text-align: center;
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
            vertical-align: top;
            white-space: nowrap;
            width: 100%;
            z-index: 9;
            border: 0;
            transition: box-shadow .2s;
        }

        .button-42:hover {
            box-shadow: rgba(253, 76, 0, 0.5) 0 3px 8px;
        }


        /* CSS */
        .button-22 {
            align-items: center;
            appearance: button;
            background-color: #0276FF;
            border-radius: 8px;
            border-style: none;
            box-shadow: rgba(255, 255, 255, 0.26) 0 1px 2px inset;
            box-sizing: border-box;
            color: #fff;
            cursor: pointer;
            display: flex;
            flex-direction: row;
            flex-shrink: 0;
            font-family: "RM Neue", sans-serif;
            font-size: 100%;
            line-height: 1.15;
            margin: 0;
            padding: 10px 21px;
            text-align: center;
            text-transform: none;
            transition: color .13s ease-in-out, background .13s ease-in-out, opacity .13s ease-in-out, box-shadow .13s ease-in-out;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }

        .button-22:active {
            background-color: #006AE8;
        }

        .button-22:hover {
            background-color: #1C84FF;
        }

        .error {
            border: 1px solid red;
        }

        .input1 {
            font-size: 1.0em;
        }

        .countdown {
            position: relative;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #121b1c;
            background-size: cover;
            background-position: center center;
            border: 3px solid grey;
            transform-origin: center bottom;
        }

        .countdown__icon {
            position: absolute;
            top: -6px;
            left: -6px;
            width: 56px;
            fill: transparent;
            stroke: #76e19e;
            stroke-width: 10px;
            stroke-linecap: round;
        }

        .countdown__icon__circle {
            stroke-dasharray: 375.787322998;
        }

        .countdown__number {
            color: #fff;
        }
    </style>
</head>

<body>
    <h1 style="padding: 20px 0 30px 0;font-size:1.4em;text-align:center"><strong>PIRI Hashes Generator,
            v1.0.3.0</strong>
    </h1>
    <main class="flex-container">
        <div id="myModal" class="modal" style="display: none;">
            <span class="close">&times;</span>
            <img class="modal-content" id="img01" alt="Screenshot" />
        </div>

        <div class="flex-item" id="videozone" style="aspect-ratio:1.768; margin-bottom: 15px;">
            <img style="cursor: pointer;aspect-ratio:1.76;" width="100%" height="auto" id="imgPlay"
                src="/images/play.jpg" onclick="startPlayer()" alt="player" />
            <video style="display:none; aspect-ratio:1.768;" id="my-video" class="video-js" controls preload="none"
                data-setup='{"fluid": true}' width="100%" height="auto">
                <source src="https://fileshares23.blob.core.windows.net/videos/videopromo.mp4" type="video/mp4" />
                <p class="vjs-no-js">
                    To view this video please enable JavaScript, and consider upgrading to a
                    web browser that
                    <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5
                        video</a>
                </p>
            </video>
        </div>
        <div class="flex-item" id="article" style="margin-bottom: 15px;">
            <p>
                The Software for generation hashes(crypto-pairs from pub/private keys) of the PiriChain
                system.<br>
                Sending, receiving, controlling transactions in the system.<br>
                Reading and writing data to the blockchain database.<br>
                <br>
                <strong>Features:</strong><br>
            <ol type="1">
                <li>Support to export PDF, CSV, XLS, DOCX, HTML, TXT</li>
                <li>Importing third party hashes, from another users</li>
                <li>QR`s codes scanning/generation</li>
                <li>Creating encrypted(BlowFish with static key), encrypted(BlowFish with custom key), not encrypted
                    hash containers</li>
                <li>Taskbar notifications of income transactions</li>
                <li>Sound notifications</li>
            </ol>
            <br>
            To randomize secret phrases, we use a [BIP39-NET, 1.0.1] library with checksum check.<br>
            The program has been tested and is guaranteed to work with the English mnemonic.<br><br>
            <strong>Windows only x32/x64, Minimum support version Windows 10 - 17763.0</strong>

            </P>
        </div>
        <div class="flex-item" id="slideshowzone"
            style="display: flex;flex-direction: column;aspect-ratio:1.264;margin-bottom: 15px;justify-content: center;">
            <div class="slideshow-container" style="width: 100%;">

                <div class="mySlides fade">
                    <img src="images/screen_1.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>

                <div class="mySlides fade">
                    <img src="images/screen_2.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_3.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_4.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_5.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_6.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_7.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_8.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_9.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_10.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_11.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_12.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_13.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_14.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_15.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_16.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_17.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_18.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <div class="mySlides fade">
                    <img src="images/screen_19.png" class="img0" loading="lazy" alt="screenshot" width="100%"
                        height="100%">
                </div>
                <a class="prev" href="#" onclick="plusSlides(event,-1)">&#10094;</a>
                <a class="next" href="#" onclick="plusSlides(event,1)">&#10095;</a>

            </div>

            <div style="text-align:center">
                <span class="dot" onclick="currentSlide(1)"></span>
                <span class="dot" onclick="currentSlide(2)"></span>
                <span class="dot" onclick="currentSlide(3)"></span>
                <span class="dot" onclick="currentSlide(4)"></span>
                <span class="dot" onclick="currentSlide(5)"></span>
                <span class="dot" onclick="currentSlide(6)"></span>
                <span class="dot" onclick="currentSlide(7)"></span>
                <span class="dot" onclick="currentSlide(8)"></span>
                <span class="dot" onclick="currentSlide(9)"></span>
                <span class="dot" onclick="currentSlide(10)"></span>
                <span class="dot" onclick="currentSlide(11)"></span>
                <span class="dot" onclick="currentSlide(12)"></span>
                <span class="dot" onclick="currentSlide(13)"></span>
                <span class="dot" onclick="currentSlide(14)"></span>
                <span class="dot" onclick="currentSlide(15)"></span>
                <span class="dot" onclick="currentSlide(16)"></span>
                <span class="dot" onclick="currentSlide(17)"></span>
                <span class="dot" onclick="currentSlide(18)"></span>
                <span class="dot" onclick="currentSlide(19)"></span>
            </div>
        </div>
        <div class="flex-item" id="checkoutzone" style="margin-bottom: 15px;">
            <hr>
            <h2>Purchase zone</h2>
            <div>
                <p>Make a purchase using cryptocurrencies: Bitcoin, Bitcoin Cash, Dogecoin, Litecoin, Tether,
                    USD
                    Coin, Matic. <br>
                    <strong>Be sure to provide the correct E-mail to receive a software.</strong> <br>
                    Delivery time depends on the load of the blockchain network, <br>
                    and can take from 10 to 60 minutes.
                </p>
                <h3>Advantages:</h3>
                <div>
                    <p style="font-size:1em">
                        <img style="margin-bottom:-0.5em" src="images/delivery.png" alt="delivery" width="32"
                            height="32" />
                        Automatic delivery<br>
                        <img style="margin-bottom:-0.5em" src="images/crypto.png" alt="crypto" width="32" height="32" />
                        Cryptocurrency friendly<br><br>
                        &#x2022; <strong>Support e-mail:</strong>&nbsp;&nbsp;mail@hashesgenerator.com<br>
                        &#x2022; <strong>Support Skype:</strong>&nbsp;&nbsp;<a
                            href="skype:live:.cid.81cfc5e2e202b002?chat">live:.cid.81cfc5e2e202b002</a>
                    </p>
                </div>
                <hr>
                <p style="font-size:1.2em;text-align: end;">
                    Price: <strong>15.00$</strong>
                </p>
                <div style="text-align: end;">
                    <a class="buy-with-crypto"
                        href="https://commerce.coinbase.com/checkout/90080b7b-cc58-44ca-9129-b8771e100950"
                        style="min-height: 30px;">
                        Buy with Crypto
                    </a>
                    <script async
                        src="https://commerce.coinbase.com/v1/checkout.js?version=201807&onload=coinbaseStarted">
                        </script>
                </div>

                <div style="text-align: end;align-items: end;display: flex;flex-direction: column;">
                    <button class="button-23" role="button"
                        style="margin-top: 8px;font-size: 15px;text-align: justify;align-items: center;display: flex;justify-content: space-between;"
                        id="btnCheckout2" type="button">Buy with PIRI <img 
                            src="images/piri.png" alt="delivery" width="32" height="32" /></button>
                </div>
            </div>

        </div>
    </main>
    <br><br>
    <div class="footer-container">
        <div class="footer-item">
            <a href="/policy">Privacy Policy</a>
        </div>
        <div class="footer-item">
            <a href="/terms">Terms and Conditions</a>
        </div>
        <div class="footer-item">
            <a href="/cookies">Cookie Policy</a>
        </div>
    </div>

    <div class="gdpr-container" id="cookiePopup">
        <h3>Our cookies policy</h3>
        <hr style="color: black;background-color: black;width: 90%;    height: 1px;">
        <div class="ingdpr-container">
            <div style="width: 75%;">
                <p>
                    Our website uses cookies and Google Analytics, to provide your browsing experience and
                    relevant information. Before continuing to use our website, you need agree and
                    accept our <a href="/cookies">Cookie Policy</a> & <a href="/policy"> Privacy Policy</a>
                </p>
            </div>
            <div style="width: 25%;">
                <img src="/images/cookie.png" alt="cookies" width="100%" height="100%" style="aspect-ratio: 1;"
                    loading="lazy" />
            </div>
        </div>
        <hr style="color: black;background-color: black;width: 90%;    height: 1px;">
        <div style="width: 80%;justify-content: center;display: flex;flex-direction: row;    margin-bottom: 11px;">
            <button type="button" style="margin: 5px;margin-right: 20px;height: 37px;width: 100px;"
                id="closeCookie">Close</button>
            <button type="button" style="margin: 5px;margin-left: 20px;height: 37px;width: 100px;"
                id="acceptCookie">Accept</button>
        </div>
    </div>



    <div id="checkout2Modal" class="checkout2Modal" style="font-size: 14px;">

        <div class="checkout2-container" id="checkout2">
            <h4 style="margin: 5px;margin-top: 14px;">PIRI Chain checkout</h4>
            <hr style="color: black;background-color: black;width: 90%;    height: 1px;">
            <div style="width: 90%;justify-content: center;align-items: center;display: none;flex-direction: column;min-height: 457px;"
                id="checkout2-wait">
                <div
                    style="width: 100%;background: darkgray;justify-content: center;align-items: center;display: flex;padding: 10px;margin-top: 100px;margin-bottom: 100px; ">
                    <span class="loader"></span>
                </div>
            </div>
            <div style="width: 90%;justify-content: center;align-items: center;display: none;flex-direction: column;min-height: 457px;"
                id="checkout2-input">
                <p style="margin-bottom: 40px;">
                    Please fill the fields
                </p>
                <label for="fname">Full name:</label>
                <input class="input1" type="text" id="fname" name="fname" required
                    style="min-width: 150px;max-width: 300px;width: 100%;"><br>
                <label for="email">E-mail:</label>
                <input class="input1" type="text" id="email" name="email" required
                    style="min-width: 150px;max-width: 300px;width: 100%;"><br><br>
                <button id="nextCheckout2" class="button-22" role="button"
                    style="margin-left: auto;width: 100px;font-size: 15px;;margin-top:20px;">Next</button>
            </div>
            <div style="width: 90%;justify-content: center;align-items: center;display: none;flex-direction: column;min-height: 457px;"
                id="checkout2-qr">
                <div class="countdown"
                    style="display: flex;justify-content: center;align-items: center;flex-direction: column;box-sizing: border-box;margin: 0px;">
                    <span class="countdown__number" id="checkOuttime">0</span>
                    <svg class="countdown__icon" version="1.1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 130 130"
                        overflow="visible" enable-background="new 0 0 130 130">
                        <path id="countdown1" class="countdown__icon__circle"
                            d="M5,64.8a59.8,59.8 0 1,0 119.6,0a59.8,59.8 0 1,0 -119.6,0" />
                    </svg>
                </div>
                <div
                    style="width: 100%;justify-content: center;align-items: center;display: flex;flex-direction: column;">
                    <p style="font-size: 14px;margin-top: 5px;margin-bottom: 4px;">
                        Please transfer the full amount to the specified PIRI address.<br>
                        You have only 60 minutes, then an address will not be valid and your payment will not be
                        confirmed
                    <h4 style="margin-bottom: 10px;margin-top:0px">QR Code</h4>
                    <div id="qrcode" style="width: 170px;height: 170px;"></div>

                    <div
                        style="display: flex; flex-direction:column;align-items:start;overflow-wrap: break-word;word-break: break-all;margin-top: 15px;font-size: 12px;">
                        <div>
                            <svg id="copy1" viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg" height="18"
                                width="18" onclick="copyTextToClipboard($('#checkout2-Address').text())"
                                style="margin-bottom: -0.3em;cursor:pointer;">
                                <path
                                    d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z" />
                            </svg>
                            <svg height="18" width="18" id="confirm1"
                                style="enable-background:new 0 0 128 128;margin-bottom: -0.3em;display:none;"
                                version="1.1" viewBox="0 0 128 128" xml:space="preserve"
                                xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                <style type="text/css">
                                    .st0 {
                                        fill: #31AF91;
                                    }

                                    .st1 {
                                        fill: #FFFFFF;
                                    }
                                </style>
                                <g>
                                    <circle class="st0" cx="64" cy="64" r="64" />
                                </g>
                                <g>
                                    <path class="st1"
                                        d="M54.3,97.2L24.8,67.7c-0.4-0.4-0.4-1,0-1.4l8.5-8.5c0.4-0.4,1-0.4,1.4,0L55,78.1l38.2-38.2   c0.4-0.4,1-0.4,1.4,0l8.5,8.5c0.4,0.4,0.4,1,0,1.4L55.7,97.2C55.3,97.6,54.7,97.6,54.3,97.2z" />
                                </g>
                            </svg>
                            <span><strong>Address:&nbsp;&nbsp;</strong></span><span id="checkout2-Address"></span>

                        </div>
                        <div>
                            <svg id="copy2" viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg" height="18"
                                width="18" onclick="copyTextToClipboard($('#checkout2-Amount').text())"
                                style="margin-bottom: -0.3em;margin-top: 5px;cursor:pointer;">
                                <path
                                    d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z" />
                            </svg>
                            <svg height="18" width="18" id="confirm2"
                                style="enable-background:new 0 0 128 128;margin-bottom: -0.3em;margin-top: 5px;display:none;"
                                version="1.1" viewBox="0 0 128 128" xml:space="preserve"
                                xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                <style type="text/css">
                                    .st0 {
                                        fill: #31AF91;
                                    }

                                    .st1 {
                                        fill: #FFFFFF;
                                    }
                                </style>
                                <g>
                                    <circle class="st0" cx="64" cy="64" r="64" />
                                </g>
                                <g>
                                    <path class="st1"
                                        d="M54.3,97.2L24.8,67.7c-0.4-0.4-0.4-1,0-1.4l8.5-8.5c0.4-0.4,1-0.4,1.4,0L55,78.1l38.2-38.2   c0.4-0.4,1-0.4,1.4,0l8.5,8.5c0.4,0.4,0.4,1,0,1.4L55.7,97.2C55.3,97.6,54.7,97.6,54.3,97.2z" />
                                </g>
                            </svg>
                            <span><strong>Amount:&nbsp;&nbsp;</strong></span><span
                                id="checkout2-Amount"></span><span>&nbsp;PIRI</span>
                        </div>
                        <div>
                            <svg id="copy3" viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg" height="18"
                                width="18" onclick="copyTextToClipboard($('#checkout2-Email').text())"
                                style="margin-bottom: -0.3em;margin-top: 5px;cursor:pointer;">
                                <path
                                    d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z" />
                            </svg>
                            <svg height="18" width="18" id="confirm3"
                                style="enable-background:new 0 0 128 128;margin-bottom: -0.3em;margin-top: 5px;display:none;"
                                version="1.1" viewBox="0 0 128 128" xml:space="preserve"
                                xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                <style type="text/css">
                                    .st0 {
                                        fill: #31AF91;
                                    }

                                    .st1 {
                                        fill: #FFFFFF;
                                    }
                                </style>
                                <g>
                                    <circle class="st0" cx="64" cy="64" r="64" />
                                </g>
                                <g>
                                    <path class="st1"
                                        d="M54.3,97.2L24.8,67.7c-0.4-0.4-0.4-1,0-1.4l8.5-8.5c0.4-0.4,1-0.4,1.4,0L55,78.1l38.2-38.2   c0.4-0.4,1-0.4,1.4,0l8.5,8.5c0.4,0.4,0.4,1,0,1.4L55.7,97.2C55.3,97.6,54.7,97.6,54.3,97.2z" />
                                </g>
                            </svg>
                            <span><strong>Email:&nbsp;&nbsp;</strong></span><span id="checkout2-Email"></span>
                        </div>
                    </div>
                    </p>
                </div>
                <button class="button-22" role="button" id="checkout2paid" style="margin-bottom: 0px; ">Click if
                    paid</button>
            </div>
            <div style="width: 100%;justify-content: center;align-items: center;display: none;flex-direction: column;min-height: 457px;"
                id="checkout2-waitconfirm">
                <div class="countdown"
                    style="display: flex;justify-content: center;align-items: center;flex-direction: column;box-sizing: border-box;margin: 0px;">
                    <span class="countdown__number" id="confirmTime"></span>
                    <svg class="countdown__icon" version="1.1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 130 130"
                        overflow="visible" enable-background="new 0 0 130 130">
                        <path id="countdown2" class="countdown__icon__circle"
                            d="M5,64.8a59.8,59.8 0 1,0 119.6,0a59.8,59.8 0 1,0 -119.6,0" />
                    </svg>
                </div>
                <p style="font-size: 16px;">
                    Please wait for confirmation<br>
                </p>
            </div>
            <div id="checkout2-confirmed"
                style="justify-content: center;align-items: center;display: none;margin: auto;min-height: 457px;">
                <svg enable-background="new 0 0 59.577 58.667" height="48" id="Layer_1" version="1.1"
                    viewBox="0 0 59.577 58.667" width="48" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink">
                    <path
                        d="M59.039,0.35c-0.636-0.532-1.583-0.447-2.112,0.189L27.766,35.419l-9.655-7.594c-0.652-0.512-1.595-0.4-2.106,0.252  c-0.512,0.651-0.399,1.594,0.252,2.106l10.8,8.494c0.089,0.07,0.189,0.109,0.287,0.156c0.051,0.024,0.096,0.063,0.148,0.08  c0.16,0.056,0.326,0.085,0.492,0.085c0.109,0,0.218-0.013,0.325-0.036c0.036-0.008,0.068-0.023,0.103-0.034  c0.07-0.021,0.141-0.04,0.208-0.071c0.042-0.02,0.08-0.048,0.121-0.072c0.055-0.032,0.111-0.062,0.162-0.101  c0.043-0.033,0.079-0.075,0.119-0.113c0.039-0.037,0.081-0.068,0.115-0.11L59.227,2.462C59.759,1.827,59.674,0.881,59.039,0.35z" />
                    <path
                        d="M52.071,13.208c-0.7,0.443-0.909,1.369-0.466,2.069c2.657,4.201,4.062,9.062,4.062,14.057  c0,14.521-11.813,26.333-26.333,26.333S3,43.854,3,29.333C3,14.813,14.813,3,29.333,3c5.963,0,11.587,1.943,16.262,5.621  c0.652,0.511,1.595,0.4,2.106-0.252c0.513-0.651,0.399-1.594-0.251-2.106C42.241,2.166,35.976,0,29.333,0  C13.159,0,0,13.159,0,29.333c0,16.174,13.159,29.333,29.333,29.333c16.174,0,29.333-13.159,29.333-29.333  c0-5.563-1.565-10.979-4.526-15.66C53.698,12.973,52.77,12.764,52.071,13.208z" />
                </svg>
                <p style="color: #000000;margin: 0px;margin-left: 10px;">Confirmed</p>
            </div>
            <div id="checkout2-error"
                style="justify-content: center;align-items: center;display: none;margin: auto;flex-direction: column;min-height: 457px;">
                <div
                    style="justify-content: center;align-items: center;display: flex;margin: auto;flex-direction: row;">
                    <svg height="48" style="overflow:visible;enable-background:new 0 0 32 32;margin-bottom: -15px;"
                        viewBox="0 0 32 32" width="48" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <g id="Error_1_">
                                <g id="Error">
                                    <circle cx="16" cy="16" id="BG" r="16" style="fill:#D72828;" />
                                    <path d="M14.5,25h3v-3h-3V25z M14.5,6v13h3V6H14.5z" id="Exclamatory_x5F_Sign"
                                        style="fill:#E6E6E6;" />
                                </g>
                            </g>
                        </g>
                    </svg>
                    <span
                        style="color: #ff1515;font-size: 22px;margin-left: 10px;margin-top: 28px;padding-bottom: 10px;">Error</span>
                </div>
                <p style="font-size: 18px;color: rgb(0, 0, 0);display: flex;margin-top: 30px;margin-bottom: 200px;"
                    id="errorMsg">Error
                    mesage</p>
            </div>
            <hr style="color: black;background-color: black;width: 90%;height: 1px;margin-top: 13px;">
            <div
                style="width: 80%;justify-content: center;display: flex;flex-direction: row;margin-top: 0px;margin-bottom: 15px;">
                <button type="button" style="margin: 5px;height: 37px;width: 100px;margin-bottom: 5px;margin-top: 10px;"
                    id="close-checkout2">Close</button>
            </div>
        </div>
    </div>

    <style>
        #toast {
            display: none;
            min-width: 200px;
            background-color: white;
            box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
            color: black;
            text-align: center;
            border-radius: 10px;
            padding: 16px;
            position: fixed;
            z-index: 1;
            bottom: 30px;
            font-size: 16px;
            margin-right: 8px;
            left: 8px;
        }

        #toast.show {
            -webkit-animation: fadein 0.5s;
            animation: fadein 0.5s;
        }

        @-webkit-keyframes fadein {
            from {
                bottom: 0;
                opacity: 0;
            }

            to {
                bottom: 30px;
                opacity: 1;
            }
        }

        @keyframes fadein {
            from {
                bottom: 0;
                opacity: 0;
            }

            to {
                bottom: 30px;
                opacity: 1;
            }
        }

        @-webkit-keyframes fadeout {
            from {
                bottom: 30px;
                opacity: 1;
            }

            to {
                bottom: 0;
                opacity: 0;
            }
        }

        @keyframes fadeout {
            from {
                bottom: 30px;
                opacity: 1;
            }

            to {
                bottom: 0;
                opacity: 0;
            }
        }

        .checkicon i {
            font-size: 40px;
            color: #47d764;
        }
    </style>


    <div id="toast">
        <div class="checkicon" style="width: 30px;">
            <svg onclick="document.getElementById('toast').style.display='none'" style="cursor:pointer;left: 10px;"
                width="30px" height="30px" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z" />
            </svg>
        </div>
        <h3 class="notification-title">Order createded successfully</h3>
        <p>Order ID: <span id="oid"></span><br>
            Wait for confirmation and delivery to your email.<br>
            Delivery time from 10 to 60 minutes, if the blockchain network is not congested.
        </p>
    </div>


    <script>
        let jq = "IWZ1bmN0aW9uIChlLCB0KSB7ICJ1c2Ugc3RyaWN0IjsgIm9iamVjdCIgPT0gdHlwZW9mIG1vZHVsZSAmJiAib2JqZWN0IiA9PSB0eXBlb2YgbW9kdWxlLmV4cG9ydHMgPyBtb2R1bGUuZXhwb3J0cyA9IGUuZG9jdW1lbnQgPyB0KGUsICEwKSA6IGZ1bmN0aW9uIChlKSB7IGlmICghZS5kb2N1bWVudCkgdGhyb3cgbmV3IEVycm9yKCJqUXVlcnkgcmVxdWlyZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50Iik7IHJldHVybiB0KGUpIH0gOiB0KGUpIH0oInVuZGVmaW5lZCIgIT0gdHlwZW9mIHdpbmRvdyA/IHdpbmRvdyA6IHRoaXMsIGZ1bmN0aW9uIChpZSwgZSkgeyAidXNlIHN0cmljdCI7IHZhciBvZSA9IFtdLCByID0gT2JqZWN0LmdldFByb3RvdHlwZU9mLCBhZSA9IG9lLnNsaWNlLCBnID0gb2UuZmxhdCA/IGZ1bmN0aW9uIChlKSB7IHJldHVybiBvZS5mbGF0LmNhbGwoZSkgfSA6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBvZS5jb25jYXQuYXBwbHkoW10sIGUpIH0sIHMgPSBvZS5wdXNoLCBzZSA9IG9lLmluZGV4T2YsIG4gPSB7fSwgaSA9IG4udG9TdHJpbmcsIHVlID0gbi5oYXNPd25Qcm9wZXJ0eSwgbyA9IHVlLnRvU3RyaW5nLCBhID0gby5jYWxsKE9iamVjdCksIGxlID0ge30sIHYgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gImZ1bmN0aW9uIiA9PSB0eXBlb2YgZSAmJiAibnVtYmVyIiAhPSB0eXBlb2YgZS5ub2RlVHlwZSAmJiAiZnVuY3Rpb24iICE9IHR5cGVvZiBlLml0ZW0gfSwgeSA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiBudWxsICE9IGUgJiYgZSA9PT0gZS53aW5kb3cgfSwgQyA9IGllLmRvY3VtZW50LCB1ID0geyB0eXBlOiAhMCwgc3JjOiAhMCwgbm9uY2U6ICEwLCBub01vZHVsZTogITAgfTsgZnVuY3Rpb24gbShlLCB0LCBuKSB7IHZhciByLCBpLCBvID0gKG4gPSBuIHx8IEMpLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpOyBpZiAoby50ZXh0ID0gZSwgdCkgZm9yIChyIGluIHUpIChpID0gdFtyXSB8fCB0LmdldEF0dHJpYnV0ZSAmJiB0LmdldEF0dHJpYnV0ZShyKSkgJiYgby5zZXRBdHRyaWJ1dGUociwgaSk7IG4uaGVhZC5hcHBlbmRDaGlsZChvKS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG8pIH0gZnVuY3Rpb24geChlKSB7IHJldHVybiBudWxsID09IGUgPyBlICsgIiIgOiAib2JqZWN0IiA9PSB0eXBlb2YgZSB8fCAiZnVuY3Rpb24iID09IHR5cGVvZiBlID8gbltpLmNhbGwoZSldIHx8ICJvYmplY3QiIDogdHlwZW9mIGUgfSB2YXIgdCA9ICIzLjcuMSIsIGwgPSAvSFRNTCQvaSwgY2UgPSBmdW5jdGlvbiAoZSwgdCkgeyByZXR1cm4gbmV3IGNlLmZuLmluaXQoZSwgdCkgfTsgZnVuY3Rpb24gYyhlKSB7IHZhciB0ID0gISFlICYmICJsZW5ndGgiIGluIGUgJiYgZS5sZW5ndGgsIG4gPSB4KGUpOyByZXR1cm4gIXYoZSkgJiYgIXkoZSkgJiYgKCJhcnJheSIgPT09IG4gfHwgMCA9PT0gdCB8fCAibnVtYmVyIiA9PSB0eXBlb2YgdCAmJiAwIDwgdCAmJiB0IC0gMSBpbiBlKSB9IGZ1bmN0aW9uIGZlKGUsIHQpIHsgcmV0dXJuIGUubm9kZU5hbWUgJiYgZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSB0LnRvTG93ZXJDYXNlKCkgfSBjZS5mbiA9IGNlLnByb3RvdHlwZSA9IHsganF1ZXJ5OiB0LCBjb25zdHJ1Y3RvcjogY2UsIGxlbmd0aDogMCwgdG9BcnJheTogZnVuY3Rpb24gKCkgeyByZXR1cm4gYWUuY2FsbCh0aGlzKSB9LCBnZXQ6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBudWxsID09IGUgPyBhZS5jYWxsKHRoaXMpIDogZSA8IDAgPyB0aGlzW2UgKyB0aGlzLmxlbmd0aF0gOiB0aGlzW2VdIH0sIHB1c2hTdGFjazogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBjZS5tZXJnZSh0aGlzLmNvbnN0cnVjdG9yKCksIGUpOyByZXR1cm4gdC5wcmV2T2JqZWN0ID0gdGhpcywgdCB9LCBlYWNoOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gY2UuZWFjaCh0aGlzLCBlKSB9LCBtYXA6IGZ1bmN0aW9uIChuKSB7IHJldHVybiB0aGlzLnB1c2hTdGFjayhjZS5tYXAodGhpcywgZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIG4uY2FsbChlLCB0LCBlKSB9KSkgfSwgc2xpY2U6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMucHVzaFN0YWNrKGFlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIH0sIGZpcnN0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmVxKDApIH0sIGxhc3Q6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuZXEoLTEpIH0sIGV2ZW46IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMucHVzaFN0YWNrKGNlLmdyZXAodGhpcywgZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuICh0ICsgMSkgJSAyIH0pKSB9LCBvZGQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMucHVzaFN0YWNrKGNlLmdyZXAodGhpcywgZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIHQgJSAyIH0pKSB9LCBlcTogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSB0aGlzLmxlbmd0aCwgbiA9ICtlICsgKGUgPCAwID8gdCA6IDApOyByZXR1cm4gdGhpcy5wdXNoU3RhY2soMCA8PSBuICYmIG4gPCB0ID8gW3RoaXNbbl1dIDogW10pIH0sIGVuZDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5wcmV2T2JqZWN0IHx8IHRoaXMuY29uc3RydWN0b3IoKSB9LCBwdXNoOiBzLCBzb3J0OiBvZS5zb3J0LCBzcGxpY2U6IG9lLnNwbGljZSB9LCBjZS5leHRlbmQgPSBjZS5mbi5leHRlbmQgPSBmdW5jdGlvbiAoKSB7IHZhciBlLCB0LCBuLCByLCBpLCBvLCBhID0gYXJndW1lbnRzWzBdIHx8IHt9LCBzID0gMSwgdSA9IGFyZ3VtZW50cy5sZW5ndGgsIGwgPSAhMTsgZm9yICgiYm9vbGVhbiIgPT0gdHlwZW9mIGEgJiYgKGwgPSBhLCBhID0gYXJndW1lbnRzW3NdIHx8IHt9LCBzKyspLCAib2JqZWN0IiA9PSB0eXBlb2YgYSB8fCB2KGEpIHx8IChhID0ge30pLCBzID09PSB1ICYmIChhID0gdGhpcywgcy0tKTsgcyA8IHU7IHMrKylpZiAobnVsbCAhPSAoZSA9IGFyZ3VtZW50c1tzXSkpIGZvciAodCBpbiBlKSByID0gZVt0XSwgIl9fcHJvdG9fXyIgIT09IHQgJiYgYSAhPT0gciAmJiAobCAmJiByICYmIChjZS5pc1BsYWluT2JqZWN0KHIpIHx8IChpID0gQXJyYXkuaXNBcnJheShyKSkpID8gKG4gPSBhW3RdLCBvID0gaSAmJiAhQXJyYXkuaXNBcnJheShuKSA/IFtdIDogaSB8fCBjZS5pc1BsYWluT2JqZWN0KG4pID8gbiA6IHt9LCBpID0gITEsIGFbdF0gPSBjZS5leHRlbmQobCwgbywgcikpIDogdm9pZCAwICE9PSByICYmIChhW3RdID0gcikpOyByZXR1cm4gYSB9LCBjZS5leHRlbmQoeyBleHBhbmRvOiAialF1ZXJ5IiArICh0ICsgTWF0aC5yYW5kb20oKSkucmVwbGFjZSgvXEQvZywgIiIpLCBpc1JlYWR5OiAhMCwgZXJyb3I6IGZ1bmN0aW9uIChlKSB7IHRocm93IG5ldyBFcnJvcihlKSB9LCBub29wOiBmdW5jdGlvbiAoKSB7IH0sIGlzUGxhaW5PYmplY3Q6IGZ1bmN0aW9uIChlKSB7IHZhciB0LCBuOyByZXR1cm4gISghZSB8fCAiW29iamVjdCBPYmplY3RdIiAhPT0gaS5jYWxsKGUpKSAmJiAoISh0ID0gcihlKSkgfHwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgKG4gPSB1ZS5jYWxsKHQsICJjb25zdHJ1Y3RvciIpICYmIHQuY29uc3RydWN0b3IpICYmIG8uY2FsbChuKSA9PT0gYSkgfSwgaXNFbXB0eU9iamVjdDogZnVuY3Rpb24gKGUpIHsgdmFyIHQ7IGZvciAodCBpbiBlKSByZXR1cm4gITE7IHJldHVybiAhMCB9LCBnbG9iYWxFdmFsOiBmdW5jdGlvbiAoZSwgdCwgbikgeyBtKGUsIHsgbm9uY2U6IHQgJiYgdC5ub25jZSB9LCBuKSB9LCBlYWNoOiBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiwgciA9IDA7IGlmIChjKGUpKSB7IGZvciAobiA9IGUubGVuZ3RoOyByIDwgbjsgcisrKWlmICghMSA9PT0gdC5jYWxsKGVbcl0sIHIsIGVbcl0pKSBicmVhayB9IGVsc2UgZm9yIChyIGluIGUpIGlmICghMSA9PT0gdC5jYWxsKGVbcl0sIHIsIGVbcl0pKSBicmVhazsgcmV0dXJuIGUgfSwgdGV4dDogZnVuY3Rpb24gKGUpIHsgdmFyIHQsIG4gPSAiIiwgciA9IDAsIGkgPSBlLm5vZGVUeXBlOyBpZiAoIWkpIHdoaWxlICh0ID0gZVtyKytdKSBuICs9IGNlLnRleHQodCk7IHJldHVybiAxID09PSBpIHx8IDExID09PSBpID8gZS50ZXh0Q29udGVudCA6IDkgPT09IGkgPyBlLmRvY3VtZW50RWxlbWVudC50ZXh0Q29udGVudCA6IDMgPT09IGkgfHwgNCA9PT0gaSA/IGUubm9kZVZhbHVlIDogbiB9LCBtYWtlQXJyYXk6IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuID0gdCB8fCBbXTsgcmV0dXJuIG51bGwgIT0gZSAmJiAoYyhPYmplY3QoZSkpID8gY2UubWVyZ2UobiwgInN0cmluZyIgPT0gdHlwZW9mIGUgPyBbZV0gOiBlKSA6IHMuY2FsbChuLCBlKSksIG4gfSwgaW5BcnJheTogZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIG51bGwgPT0gdCA/IC0xIDogc2UuY2FsbCh0LCBlLCBuKSB9LCBpc1hNTERvYzogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBlICYmIGUubmFtZXNwYWNlVVJJLCBuID0gZSAmJiAoZS5vd25lckRvY3VtZW50IHx8IGUpLmRvY3VtZW50RWxlbWVudDsgcmV0dXJuICFsLnRlc3QodCB8fCBuICYmIG4ubm9kZU5hbWUgfHwgIkhUTUwiKSB9LCBtZXJnZTogZnVuY3Rpb24gKGUsIHQpIHsgZm9yICh2YXIgbiA9ICt0Lmxlbmd0aCwgciA9IDAsIGkgPSBlLmxlbmd0aDsgciA8IG47IHIrKyllW2krK10gPSB0W3JdOyByZXR1cm4gZS5sZW5ndGggPSBpLCBlIH0sIGdyZXA6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IGZvciAodmFyIHIgPSBbXSwgaSA9IDAsIG8gPSBlLmxlbmd0aCwgYSA9ICFuOyBpIDwgbzsgaSsrKSF0KGVbaV0sIGkpICE9PSBhICYmIHIucHVzaChlW2ldKTsgcmV0dXJuIHIgfSwgbWFwOiBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciwgaSwgbyA9IDAsIGEgPSBbXTsgaWYgKGMoZSkpIGZvciAociA9IGUubGVuZ3RoOyBvIDwgcjsgbysrKW51bGwgIT0gKGkgPSB0KGVbb10sIG8sIG4pKSAmJiBhLnB1c2goaSk7IGVsc2UgZm9yIChvIGluIGUpIG51bGwgIT0gKGkgPSB0KGVbb10sIG8sIG4pKSAmJiBhLnB1c2goaSk7IHJldHVybiBnKGEpIH0sIGd1aWQ6IDEsIHN1cHBvcnQ6IGxlIH0pLCAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgKGNlLmZuW1N5bWJvbC5pdGVyYXRvcl0gPSBvZVtTeW1ib2wuaXRlcmF0b3JdKSwgY2UuZWFjaCgiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCBFcnJvciBTeW1ib2wiLnNwbGl0KCIgIiksIGZ1bmN0aW9uIChlLCB0KSB7IG5bIltvYmplY3QgIiArIHQgKyAiXSJdID0gdC50b0xvd2VyQ2FzZSgpIH0pOyB2YXIgcGUgPSBvZS5wb3AsIGRlID0gb2Uuc29ydCwgaGUgPSBvZS5zcGxpY2UsIGdlID0gIltcXHgyMFxcdFxcclxcblxcZl0iLCB2ZSA9IG5ldyBSZWdFeHAoIl4iICsgZ2UgKyAiK3woKD86XnxbXlxcXFxdKSg/OlxcXFwuKSopIiArIGdlICsgIiskIiwgImciKTsgY2UuY29udGFpbnMgPSBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiA9IHQgJiYgdC5wYXJlbnROb2RlOyByZXR1cm4gZSA9PT0gbiB8fCAhKCFuIHx8IDEgIT09IG4ubm9kZVR5cGUgfHwgIShlLmNvbnRhaW5zID8gZS5jb250YWlucyhuKSA6IGUuY29tcGFyZURvY3VtZW50UG9zaXRpb24gJiYgMTYgJiBlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKG4pKSkgfTsgdmFyIGYgPSAvKFtcMC1ceDFmXHg3Zl18Xi0/XGQpfF4tJHxbXlx4ODAtXHVGRkZGXHctXS9nOyBmdW5jdGlvbiBwKGUsIHQpIHsgcmV0dXJuIHQgPyAiXDAiID09PSBlID8gIlx1ZmZmZCIgOiBlLnNsaWNlKDAsIC0xKSArICJcXCIgKyBlLmNoYXJDb2RlQXQoZS5sZW5ndGggLSAxKS50b1N0cmluZygxNikgKyAiICIgOiAiXFwiICsgZSB9IGNlLmVzY2FwZVNlbGVjdG9yID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIChlICsgIiIpLnJlcGxhY2UoZiwgcCkgfTsgdmFyIHllID0gQywgbWUgPSBzOyAhZnVuY3Rpb24gKCkgeyB2YXIgZSwgYiwgdywgbywgYSwgVCwgciwgQywgZCwgaSwgayA9IG1lLCBTID0gY2UuZXhwYW5kbywgRSA9IDAsIG4gPSAwLCBzID0gVygpLCBjID0gVygpLCB1ID0gVygpLCBoID0gVygpLCBsID0gZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIGUgPT09IHQgJiYgKGEgPSAhMCksIDAgfSwgZiA9ICJjaGVja2VkfHNlbGVjdGVkfGFzeW5jfGF1dG9mb2N1c3xhdXRvcGxheXxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58aXNtYXB8bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZCIsIHQgPSAiKD86XFxcXFtcXGRhLWZBLUZdezEsNn0iICsgZ2UgKyAiP3xcXFxcW15cXHJcXG5cXGZdfFtcXHctXXxbXlwwLVxceDdmXSkrIiwgcCA9ICJcXFsiICsgZ2UgKyAiKigiICsgdCArICIpKD86IiArIGdlICsgIiooWypeJHwhfl0/PSkiICsgZ2UgKyAiKig/OicoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwifCgiICsgdCArICIpKXwpIiArIGdlICsgIipcXF0iLCBnID0gIjooIiArIHQgKyAiKSg/OlxcKCgoJygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCIpfCgoPzpcXFxcLnxbXlxcXFwoKVtcXF1dfCIgKyBwICsgIikqKXwuKilcXCl8KSIsIHYgPSBuZXcgUmVnRXhwKGdlICsgIisiLCAiZyIpLCB5ID0gbmV3IFJlZ0V4cCgiXiIgKyBnZSArICIqLCIgKyBnZSArICIqIiksIG0gPSBuZXcgUmVnRXhwKCJeIiArIGdlICsgIiooWz4rfl18IiArIGdlICsgIikiICsgZ2UgKyAiKiIpLCB4ID0gbmV3IFJlZ0V4cChnZSArICJ8PiIpLCBqID0gbmV3IFJlZ0V4cChnKSwgQSA9IG5ldyBSZWdFeHAoIl4iICsgdCArICIkIiksIEQgPSB7IElEOiBuZXcgUmVnRXhwKCJeIygiICsgdCArICIpIiksIENMQVNTOiBuZXcgUmVnRXhwKCJeXFwuKCIgKyB0ICsgIikiKSwgVEFHOiBuZXcgUmVnRXhwKCJeKCIgKyB0ICsgInxbKl0pIiksIEFUVFI6IG5ldyBSZWdFeHAoIl4iICsgcCksIFBTRVVETzogbmV3IFJlZ0V4cCgiXiIgKyBnKSwgQ0hJTEQ6IG5ldyBSZWdFeHAoIl46KG9ubHl8Zmlyc3R8bGFzdHxudGh8bnRoLWxhc3QpLShjaGlsZHxvZi10eXBlKSg/OlxcKCIgKyBnZSArICIqKGV2ZW58b2RkfCgoWystXXwpKFxcZCopbnwpIiArIGdlICsgIiooPzooWystXXwpIiArIGdlICsgIiooXFxkKyl8KSkiICsgZ2UgKyAiKlxcKXwpIiwgImkiKSwgYm9vbDogbmV3IFJlZ0V4cCgiXig/OiIgKyBmICsgIikkIiwgImkiKSwgbmVlZHNDb250ZXh0OiBuZXcgUmVnRXhwKCJeIiArIGdlICsgIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcKCIgKyBnZSArICIqKCg/Oi1cXGQpP1xcZCopIiArIGdlICsgIipcXCl8KSg/PVteLV18JCkiLCAiaSIpIH0sIE4gPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLCBxID0gL15oXGQkL2ksIEwgPSAvXig/OiMoW1x3LV0rKXwoXHcrKXxcLihbXHctXSspKSQvLCBIID0gL1srfl0vLCBPID0gbmV3IFJlZ0V4cCgiXFxcXFtcXGRhLWZBLUZdezEsNn0iICsgZ2UgKyAiP3xcXFxcKFteXFxyXFxuXFxmXSkiLCAiZyIpLCBQID0gZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4gPSAiMHgiICsgZS5zbGljZSgxKSAtIDY1NTM2OyByZXR1cm4gdCB8fCAobiA8IDAgPyBTdHJpbmcuZnJvbUNoYXJDb2RlKG4gKyA2NTUzNikgOiBTdHJpbmcuZnJvbUNoYXJDb2RlKG4gPj4gMTAgfCA1NTI5NiwgMTAyMyAmIG4gfCA1NjMyMCkpIH0sIE0gPSBmdW5jdGlvbiAoKSB7IFYoKSB9LCBSID0gSihmdW5jdGlvbiAoZSkgeyByZXR1cm4gITAgPT09IGUuZGlzYWJsZWQgJiYgZmUoZSwgImZpZWxkc2V0IikgfSwgeyBkaXI6ICJwYXJlbnROb2RlIiwgbmV4dDogImxlZ2VuZCIgfSk7IHRyeSB7IGsuYXBwbHkob2UgPSBhZS5jYWxsKHllLmNoaWxkTm9kZXMpLCB5ZS5jaGlsZE5vZGVzKSwgb2VbeWUuY2hpbGROb2Rlcy5sZW5ndGhdLm5vZGVUeXBlIH0gY2F0Y2ggKGUpIHsgayA9IHsgYXBwbHk6IGZ1bmN0aW9uIChlLCB0KSB7IG1lLmFwcGx5KGUsIGFlLmNhbGwodCkpIH0sIGNhbGw6IGZ1bmN0aW9uIChlKSB7IG1lLmFwcGx5KGUsIGFlLmNhbGwoYXJndW1lbnRzLCAxKSkgfSB9IH0gZnVuY3Rpb24gSSh0LCBlLCBuLCByKSB7IHZhciBpLCBvLCBhLCBzLCB1LCBsLCBjLCBmID0gZSAmJiBlLm93bmVyRG9jdW1lbnQsIHAgPSBlID8gZS5ub2RlVHlwZSA6IDk7IGlmIChuID0gbiB8fCBbXSwgInN0cmluZyIgIT0gdHlwZW9mIHQgfHwgIXQgfHwgMSAhPT0gcCAmJiA5ICE9PSBwICYmIDExICE9PSBwKSByZXR1cm4gbjsgaWYgKCFyICYmIChWKGUpLCBlID0gZSB8fCBULCBDKSkgeyBpZiAoMTEgIT09IHAgJiYgKHUgPSBMLmV4ZWModCkpKSBpZiAoaSA9IHVbMV0pIHsgaWYgKDkgPT09IHApIHsgaWYgKCEoYSA9IGUuZ2V0RWxlbWVudEJ5SWQoaSkpKSByZXR1cm4gbjsgaWYgKGEuaWQgPT09IGkpIHJldHVybiBrLmNhbGwobiwgYSksIG4gfSBlbHNlIGlmIChmICYmIChhID0gZi5nZXRFbGVtZW50QnlJZChpKSkgJiYgSS5jb250YWlucyhlLCBhKSAmJiBhLmlkID09PSBpKSByZXR1cm4gay5jYWxsKG4sIGEpLCBuIH0gZWxzZSB7IGlmICh1WzJdKSByZXR1cm4gay5hcHBseShuLCBlLmdldEVsZW1lbnRzQnlUYWdOYW1lKHQpKSwgbjsgaWYgKChpID0gdVszXSkgJiYgZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKSByZXR1cm4gay5hcHBseShuLCBlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoaSkpLCBuIH0gaWYgKCEoaFt0ICsgIiAiXSB8fCBkICYmIGQudGVzdCh0KSkpIHsgaWYgKGMgPSB0LCBmID0gZSwgMSA9PT0gcCAmJiAoeC50ZXN0KHQpIHx8IG0udGVzdCh0KSkpIHsgKGYgPSBILnRlc3QodCkgJiYgVShlLnBhcmVudE5vZGUpIHx8IGUpID09IGUgJiYgbGUuc2NvcGUgfHwgKChzID0gZS5nZXRBdHRyaWJ1dGUoImlkIikpID8gcyA9IGNlLmVzY2FwZVNlbGVjdG9yKHMpIDogZS5zZXRBdHRyaWJ1dGUoImlkIiwgcyA9IFMpKSwgbyA9IChsID0gWSh0KSkubGVuZ3RoOyB3aGlsZSAoby0tKSBsW29dID0gKHMgPyAiIyIgKyBzIDogIjpzY29wZSIpICsgIiAiICsgUShsW29dKTsgYyA9IGwuam9pbigiLCIpIH0gdHJ5IHsgcmV0dXJuIGsuYXBwbHkobiwgZi5xdWVyeVNlbGVjdG9yQWxsKGMpKSwgbiB9IGNhdGNoIChlKSB7IGgodCwgITApIH0gZmluYWxseSB7IHMgPT09IFMgJiYgZS5yZW1vdmVBdHRyaWJ1dGUoImlkIikgfSB9IH0gcmV0dXJuIHJlKHQucmVwbGFjZSh2ZSwgIiQxIiksIGUsIG4sIHIpIH0gZnVuY3Rpb24gVygpIHsgdmFyIHIgPSBbXTsgcmV0dXJuIGZ1bmN0aW9uIGUodCwgbikgeyByZXR1cm4gci5wdXNoKHQgKyAiICIpID4gYi5jYWNoZUxlbmd0aCAmJiBkZWxldGUgZVtyLnNoaWZ0KCldLCBlW3QgKyAiICJdID0gbiB9IH0gZnVuY3Rpb24gRihlKSB7IHJldHVybiBlW1NdID0gITAsIGUgfSBmdW5jdGlvbiAkKGUpIHsgdmFyIHQgPSBULmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0Iik7IHRyeSB7IHJldHVybiAhIWUodCkgfSBjYXRjaCAoZSkgeyByZXR1cm4gITEgfSBmaW5hbGx5IHsgdC5wYXJlbnROb2RlICYmIHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KSwgdCA9IG51bGwgfSB9IGZ1bmN0aW9uIEIodCkgeyByZXR1cm4gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGZlKGUsICJpbnB1dCIpICYmIGUudHlwZSA9PT0gdCB9IH0gZnVuY3Rpb24gXyh0KSB7IHJldHVybiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gKGZlKGUsICJpbnB1dCIpIHx8IGZlKGUsICJidXR0b24iKSkgJiYgZS50eXBlID09PSB0IH0gfSBmdW5jdGlvbiB6KHQpIHsgcmV0dXJuIGZ1bmN0aW9uIChlKSB7IHJldHVybiAiZm9ybSIgaW4gZSA/IGUucGFyZW50Tm9kZSAmJiAhMSA9PT0gZS5kaXNhYmxlZCA/ICJsYWJlbCIgaW4gZSA/ICJsYWJlbCIgaW4gZS5wYXJlbnROb2RlID8gZS5wYXJlbnROb2RlLmRpc2FibGVkID09PSB0IDogZS5kaXNhYmxlZCA9PT0gdCA6IGUuaXNEaXNhYmxlZCA9PT0gdCB8fCBlLmlzRGlzYWJsZWQgIT09ICF0ICYmIFIoZSkgPT09IHQgOiBlLmRpc2FibGVkID09PSB0IDogImxhYmVsIiBpbiBlICYmIGUuZGlzYWJsZWQgPT09IHQgfSB9IGZ1bmN0aW9uIFgoYSkgeyByZXR1cm4gRihmdW5jdGlvbiAobykgeyByZXR1cm4gbyA9ICtvLCBGKGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuLCByID0gYShbXSwgZS5sZW5ndGgsIG8pLCBpID0gci5sZW5ndGg7IHdoaWxlIChpLS0pIGVbbiA9IHJbaV1dICYmIChlW25dID0gISh0W25dID0gZVtuXSkpIH0pIH0pIH0gZnVuY3Rpb24gVShlKSB7IHJldHVybiBlICYmICJ1bmRlZmluZWQiICE9IHR5cGVvZiBlLmdldEVsZW1lbnRzQnlUYWdOYW1lICYmIGUgfSBmdW5jdGlvbiBWKGUpIHsgdmFyIHQsIG4gPSBlID8gZS5vd25lckRvY3VtZW50IHx8IGUgOiB5ZTsgcmV0dXJuIG4gIT0gVCAmJiA5ID09PSBuLm5vZGVUeXBlICYmIG4uZG9jdW1lbnRFbGVtZW50ICYmIChyID0gKFQgPSBuKS5kb2N1bWVudEVsZW1lbnQsIEMgPSAhY2UuaXNYTUxEb2MoVCksIGkgPSByLm1hdGNoZXMgfHwgci53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHwgci5tc01hdGNoZXNTZWxlY3Rvciwgci5tc01hdGNoZXNTZWxlY3RvciAmJiB5ZSAhPSBUICYmICh0ID0gVC5kZWZhdWx0VmlldykgJiYgdC50b3AgIT09IHQgJiYgdC5hZGRFdmVudExpc3RlbmVyKCJ1bmxvYWQiLCBNKSwgbGUuZ2V0QnlJZCA9ICQoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHIuYXBwZW5kQ2hpbGQoZSkuaWQgPSBjZS5leHBhbmRvLCAhVC5nZXRFbGVtZW50c0J5TmFtZSB8fCAhVC5nZXRFbGVtZW50c0J5TmFtZShjZS5leHBhbmRvKS5sZW5ndGggfSksIGxlLmRpc2Nvbm5lY3RlZE1hdGNoID0gJChmdW5jdGlvbiAoZSkgeyByZXR1cm4gaS5jYWxsKGUsICIqIikgfSksIGxlLnNjb3BlID0gJChmdW5jdGlvbiAoKSB7IHJldHVybiBULnF1ZXJ5U2VsZWN0b3JBbGwoIjpzY29wZSIpIH0pLCBsZS5jc3NIYXMgPSAkKGZ1bmN0aW9uICgpIHsgdHJ5IHsgcmV0dXJuIFQucXVlcnlTZWxlY3RvcigiOmhhcygqLDpqcWZha2UpIiksICExIH0gY2F0Y2ggKGUpIHsgcmV0dXJuICEwIH0gfSksIGxlLmdldEJ5SWQgPyAoYi5maWx0ZXIuSUQgPSBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IGUucmVwbGFjZShPLCBQKTsgcmV0dXJuIGZ1bmN0aW9uIChlKSB7IHJldHVybiBlLmdldEF0dHJpYnV0ZSgiaWQiKSA9PT0gdCB9IH0sIGIuZmluZC5JRCA9IGZ1bmN0aW9uIChlLCB0KSB7IGlmICgidW5kZWZpbmVkIiAhPSB0eXBlb2YgdC5nZXRFbGVtZW50QnlJZCAmJiBDKSB7IHZhciBuID0gdC5nZXRFbGVtZW50QnlJZChlKTsgcmV0dXJuIG4gPyBbbl0gOiBbXSB9IH0pIDogKGIuZmlsdGVyLklEID0gZnVuY3Rpb24gKGUpIHsgdmFyIG4gPSBlLnJlcGxhY2UoTywgUCk7IHJldHVybiBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBlLmdldEF0dHJpYnV0ZU5vZGUgJiYgZS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpOyByZXR1cm4gdCAmJiB0LnZhbHVlID09PSBuIH0gfSwgYi5maW5kLklEID0gZnVuY3Rpb24gKGUsIHQpIHsgaWYgKCJ1bmRlZmluZWQiICE9IHR5cGVvZiB0LmdldEVsZW1lbnRCeUlkICYmIEMpIHsgdmFyIG4sIHIsIGksIG8gPSB0LmdldEVsZW1lbnRCeUlkKGUpOyBpZiAobykgeyBpZiAoKG4gPSBvLmdldEF0dHJpYnV0ZU5vZGUoImlkIikpICYmIG4udmFsdWUgPT09IGUpIHJldHVybiBbb107IGkgPSB0LmdldEVsZW1lbnRzQnlOYW1lKGUpLCByID0gMDsgd2hpbGUgKG8gPSBpW3IrK10pIGlmICgobiA9IG8uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKSkgJiYgbi52YWx1ZSA9PT0gZSkgcmV0dXJuIFtvXSB9IHJldHVybiBbXSB9IH0pLCBiLmZpbmQuVEFHID0gZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuICJ1bmRlZmluZWQiICE9IHR5cGVvZiB0LmdldEVsZW1lbnRzQnlUYWdOYW1lID8gdC5nZXRFbGVtZW50c0J5VGFnTmFtZShlKSA6IHQucXVlcnlTZWxlY3RvckFsbChlKSB9LCBiLmZpbmQuQ0xBU1MgPSBmdW5jdGlvbiAoZSwgdCkgeyBpZiAoInVuZGVmaW5lZCIgIT0gdHlwZW9mIHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSAmJiBDKSByZXR1cm4gdC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGUpIH0sIGQgPSBbXSwgJChmdW5jdGlvbiAoZSkgeyB2YXIgdDsgci5hcHBlbmRDaGlsZChlKS5pbm5lckhUTUwgPSAiPGEgaWQ9JyIgKyBTICsgIicgaHJlZj0nJyBkaXNhYmxlZD0nZGlzYWJsZWQnPjwvYT48c2VsZWN0IGlkPSciICsgUyArICItXHJcXCcgZGlzYWJsZWQ9J2Rpc2FibGVkJz48b3B0aW9uIHNlbGVjdGVkPScnPjwvb3B0aW9uPjwvc2VsZWN0PiIsIGUucXVlcnlTZWxlY3RvckFsbCgiW3NlbGVjdGVkXSIpLmxlbmd0aCB8fCBkLnB1c2goIlxcWyIgKyBnZSArICIqKD86dmFsdWV8IiArIGYgKyAiKSIpLCBlLnF1ZXJ5U2VsZWN0b3JBbGwoIltpZH49IiArIFMgKyAiLV0iKS5sZW5ndGggfHwgZC5wdXNoKCJ+PSIpLCBlLnF1ZXJ5U2VsZWN0b3JBbGwoImEjIiArIFMgKyAiKyoiKS5sZW5ndGggfHwgZC5wdXNoKCIuIy4rWyt+XSIpLCBlLnF1ZXJ5U2VsZWN0b3JBbGwoIjpjaGVja2VkIikubGVuZ3RoIHx8IGQucHVzaCgiOmNoZWNrZWQiKSwgKHQgPSBULmNyZWF0ZUVsZW1lbnQoImlucHV0IikpLnNldEF0dHJpYnV0ZSgidHlwZSIsICJoaWRkZW4iKSwgZS5hcHBlbmRDaGlsZCh0KS5zZXRBdHRyaWJ1dGUoIm5hbWUiLCAiRCIpLCByLmFwcGVuZENoaWxkKGUpLmRpc2FibGVkID0gITAsIDIgIT09IGUucXVlcnlTZWxlY3RvckFsbCgiOmRpc2FibGVkIikubGVuZ3RoICYmIGQucHVzaCgiOmVuYWJsZWQiLCAiOmRpc2FibGVkIiksICh0ID0gVC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpKS5zZXRBdHRyaWJ1dGUoIm5hbWUiLCAiIiksIGUuYXBwZW5kQ2hpbGQodCksIGUucXVlcnlTZWxlY3RvckFsbCgiW25hbWU9JyddIikubGVuZ3RoIHx8IGQucHVzaCgiXFxbIiArIGdlICsgIipuYW1lIiArIGdlICsgIio9IiArIGdlICsgIiooPzonJ3xcIlwiKSIpIH0pLCBsZS5jc3NIYXMgfHwgZC5wdXNoKCI6aGFzIiksIGQgPSBkLmxlbmd0aCAmJiBuZXcgUmVnRXhwKGQuam9pbigifCIpKSwgbCA9IGZ1bmN0aW9uIChlLCB0KSB7IGlmIChlID09PSB0KSByZXR1cm4gYSA9ICEwLCAwOyB2YXIgbiA9ICFlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uIC0gIXQuY29tcGFyZURvY3VtZW50UG9zaXRpb247IHJldHVybiBuIHx8ICgxICYgKG4gPSAoZS5vd25lckRvY3VtZW50IHx8IGUpID09ICh0Lm93bmVyRG9jdW1lbnQgfHwgdCkgPyBlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKHQpIDogMSkgfHwgIWxlLnNvcnREZXRhY2hlZCAmJiB0LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGUpID09PSBuID8gZSA9PT0gVCB8fCBlLm93bmVyRG9jdW1lbnQgPT0geWUgJiYgSS5jb250YWlucyh5ZSwgZSkgPyAtMSA6IHQgPT09IFQgfHwgdC5vd25lckRvY3VtZW50ID09IHllICYmIEkuY29udGFpbnMoeWUsIHQpID8gMSA6IG8gPyBzZS5jYWxsKG8sIGUpIC0gc2UuY2FsbChvLCB0KSA6IDAgOiA0ICYgbiA/IC0xIDogMSkgfSksIFQgfSBmb3IgKGUgaW4gSS5tYXRjaGVzID0gZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIEkoZSwgbnVsbCwgbnVsbCwgdCkgfSwgSS5tYXRjaGVzU2VsZWN0b3IgPSBmdW5jdGlvbiAoZSwgdCkgeyBpZiAoVihlKSwgQyAmJiAhaFt0ICsgIiAiXSAmJiAoIWQgfHwgIWQudGVzdCh0KSkpIHRyeSB7IHZhciBuID0gaS5jYWxsKGUsIHQpOyBpZiAobiB8fCBsZS5kaXNjb25uZWN0ZWRNYXRjaCB8fCBlLmRvY3VtZW50ICYmIDExICE9PSBlLmRvY3VtZW50Lm5vZGVUeXBlKSByZXR1cm4gbiB9IGNhdGNoIChlKSB7IGgodCwgITApIH0gcmV0dXJuIDAgPCBJKHQsIFQsIG51bGwsIFtlXSkubGVuZ3RoIH0sIEkuY29udGFpbnMgPSBmdW5jdGlvbiAoZSwgdCkgeyByZXR1cm4gKGUub3duZXJEb2N1bWVudCB8fCBlKSAhPSBUICYmIFYoZSksIGNlLmNvbnRhaW5zKGUsIHQpIH0sIEkuYXR0ciA9IGZ1bmN0aW9uIChlLCB0KSB7IChlLm93bmVyRG9jdW1lbnQgfHwgZSkgIT0gVCAmJiBWKGUpOyB2YXIgbiA9IGIuYXR0ckhhbmRsZVt0LnRvTG93ZXJDYXNlKCldLCByID0gbiAmJiB1ZS5jYWxsKGIuYXR0ckhhbmRsZSwgdC50b0xvd2VyQ2FzZSgpKSA/IG4oZSwgdCwgIUMpIDogdm9pZCAwOyByZXR1cm4gdm9pZCAwICE9PSByID8gciA6IGUuZ2V0QXR0cmlidXRlKHQpIH0sIEkuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aHJvdyBuZXcgRXJyb3IoIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIgKyBlKSB9LCBjZS51bmlxdWVTb3J0ID0gZnVuY3Rpb24gKGUpIHsgdmFyIHQsIG4gPSBbXSwgciA9IDAsIGkgPSAwOyBpZiAoYSA9ICFsZS5zb3J0U3RhYmxlLCBvID0gIWxlLnNvcnRTdGFibGUgJiYgYWUuY2FsbChlLCAwKSwgZGUuY2FsbChlLCBsKSwgYSkgeyB3aGlsZSAodCA9IGVbaSsrXSkgdCA9PT0gZVtpXSAmJiAociA9IG4ucHVzaChpKSk7IHdoaWxlIChyLS0pIGhlLmNhbGwoZSwgbltyXSwgMSkgfSByZXR1cm4gbyA9IG51bGwsIGUgfSwgY2UuZm4udW5pcXVlU29ydCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMucHVzaFN0YWNrKGNlLnVuaXF1ZVNvcnQoYWUuYXBwbHkodGhpcykpKSB9LCAoYiA9IGNlLmV4cHIgPSB7IGNhY2hlTGVuZ3RoOiA1MCwgY3JlYXRlUHNldWRvOiBGLCBtYXRjaDogRCwgYXR0ckhhbmRsZToge30sIGZpbmQ6IHt9LCByZWxhdGl2ZTogeyAiPiI6IHsgZGlyOiAicGFyZW50Tm9kZSIsIGZpcnN0OiAhMCB9LCAiICI6IHsgZGlyOiAicGFyZW50Tm9kZSIgfSwgIisiOiB7IGRpcjogInByZXZpb3VzU2libGluZyIsIGZpcnN0OiAhMCB9LCAifiI6IHsgZGlyOiAicHJldmlvdXNTaWJsaW5nIiB9IH0sIHByZUZpbHRlcjogeyBBVFRSOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZVsxXSA9IGVbMV0ucmVwbGFjZShPLCBQKSwgZVszXSA9IChlWzNdIHx8IGVbNF0gfHwgZVs1XSB8fCAiIikucmVwbGFjZShPLCBQKSwgIn49IiA9PT0gZVsyXSAmJiAoZVszXSA9ICIgIiArIGVbM10gKyAiICIpLCBlLnNsaWNlKDAsIDQpIH0sIENISUxEOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZVsxXSA9IGVbMV0udG9Mb3dlckNhc2UoKSwgIm50aCIgPT09IGVbMV0uc2xpY2UoMCwgMykgPyAoZVszXSB8fCBJLmVycm9yKGVbMF0pLCBlWzRdID0gKyhlWzRdID8gZVs1XSArIChlWzZdIHx8IDEpIDogMiAqICgiZXZlbiIgPT09IGVbM10gfHwgIm9kZCIgPT09IGVbM10pKSwgZVs1XSA9ICsoZVs3XSArIGVbOF0gfHwgIm9kZCIgPT09IGVbM10pKSA6IGVbM10gJiYgSS5lcnJvcihlWzBdKSwgZSB9LCBQU0VVRE86IGZ1bmN0aW9uIChlKSB7IHZhciB0LCBuID0gIWVbNl0gJiYgZVsyXTsgcmV0dXJuIEQuQ0hJTEQudGVzdChlWzBdKSA/IG51bGwgOiAoZVszXSA/IGVbMl0gPSBlWzRdIHx8IGVbNV0gfHwgIiIgOiBuICYmIGoudGVzdChuKSAmJiAodCA9IFkobiwgITApKSAmJiAodCA9IG4uaW5kZXhPZigiKSIsIG4ubGVuZ3RoIC0gdCkgLSBuLmxlbmd0aCkgJiYgKGVbMF0gPSBlWzBdLnNsaWNlKDAsIHQpLCBlWzJdID0gbi5zbGljZSgwLCB0KSksIGUuc2xpY2UoMCwgMykpIH0gfSwgZmlsdGVyOiB7IFRBRzogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBlLnJlcGxhY2UoTywgUCkudG9Mb3dlckNhc2UoKTsgcmV0dXJuICIqIiA9PT0gZSA/IGZ1bmN0aW9uICgpIHsgcmV0dXJuICEwIH0gOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZmUoZSwgdCkgfSB9LCBDTEFTUzogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBzW2UgKyAiICJdOyByZXR1cm4gdCB8fCAodCA9IG5ldyBSZWdFeHAoIihefCIgKyBnZSArICIpIiArIGUgKyAiKCIgKyBnZSArICJ8JCkiKSkgJiYgcyhlLCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gdC50ZXN0KCJzdHJpbmciID09IHR5cGVvZiBlLmNsYXNzTmFtZSAmJiBlLmNsYXNzTmFtZSB8fCAidW5kZWZpbmVkIiAhPSB0eXBlb2YgZS5nZXRBdHRyaWJ1dGUgJiYgZS5nZXRBdHRyaWJ1dGUoImNsYXNzIikgfHwgIiIpIH0pIH0sIEFUVFI6IGZ1bmN0aW9uIChuLCByLCBpKSB7IHJldHVybiBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IEkuYXR0cihlLCBuKTsgcmV0dXJuIG51bGwgPT0gdCA/ICIhPSIgPT09IHIgOiAhciB8fCAodCArPSAiIiwgIj0iID09PSByID8gdCA9PT0gaSA6ICIhPSIgPT09IHIgPyB0ICE9PSBpIDogIl49IiA9PT0gciA/IGkgJiYgMCA9PT0gdC5pbmRleE9mKGkpIDogIio9IiA9PT0gciA/IGkgJiYgLTEgPCB0LmluZGV4T2YoaSkgOiAiJD0iID09PSByID8gaSAmJiB0LnNsaWNlKC1pLmxlbmd0aCkgPT09IGkgOiAifj0iID09PSByID8gLTEgPCAoIiAiICsgdC5yZXBsYWNlKHYsICIgIikgKyAiICIpLmluZGV4T2YoaSkgOiAifD0iID09PSByICYmICh0ID09PSBpIHx8IHQuc2xpY2UoMCwgaS5sZW5ndGggKyAxKSA9PT0gaSArICItIikpIH0gfSwgQ0hJTEQ6IGZ1bmN0aW9uIChkLCBlLCB0LCBoLCBnKSB7IHZhciB2ID0gIm50aCIgIT09IGQuc2xpY2UoMCwgMyksIHkgPSAibGFzdCIgIT09IGQuc2xpY2UoLTQpLCBtID0gIm9mLXR5cGUiID09PSBlOyByZXR1cm4gMSA9PT0gaCAmJiAwID09PSBnID8gZnVuY3Rpb24gKGUpIHsgcmV0dXJuICEhZS5wYXJlbnROb2RlIH0gOiBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciwgaSwgbywgYSwgcywgdSA9IHYgIT09IHkgPyAibmV4dFNpYmxpbmciIDogInByZXZpb3VzU2libGluZyIsIGwgPSBlLnBhcmVudE5vZGUsIGMgPSBtICYmIGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSwgZiA9ICFuICYmICFtLCBwID0gITE7IGlmIChsKSB7IGlmICh2KSB7IHdoaWxlICh1KSB7IG8gPSBlOyB3aGlsZSAobyA9IG9bdV0pIGlmIChtID8gZmUobywgYykgOiAxID09PSBvLm5vZGVUeXBlKSByZXR1cm4gITE7IHMgPSB1ID0gIm9ubHkiID09PSBkICYmICFzICYmICJuZXh0U2libGluZyIgfSByZXR1cm4gITAgfSBpZiAocyA9IFt5ID8gbC5maXJzdENoaWxkIDogbC5sYXN0Q2hpbGRdLCB5ICYmIGYpIHsgcCA9IChhID0gKHIgPSAoaSA9IGxbU10gfHwgKGxbU10gPSB7fSkpW2RdIHx8IFtdKVswXSA9PT0gRSAmJiByWzFdKSAmJiByWzJdLCBvID0gYSAmJiBsLmNoaWxkTm9kZXNbYV07IHdoaWxlIChvID0gKythICYmIG8gJiYgb1t1XSB8fCAocCA9IGEgPSAwKSB8fCBzLnBvcCgpKSBpZiAoMSA9PT0gby5ub2RlVHlwZSAmJiArK3AgJiYgbyA9PT0gZSkgeyBpW2RdID0gW0UsIGEsIHBdOyBicmVhayB9IH0gZWxzZSBpZiAoZiAmJiAocCA9IGEgPSAociA9IChpID0gZVtTXSB8fCAoZVtTXSA9IHt9KSlbZF0gfHwgW10pWzBdID09PSBFICYmIHJbMV0pLCAhMSA9PT0gcCkgd2hpbGUgKG8gPSArK2EgJiYgbyAmJiBvW3VdIHx8IChwID0gYSA9IDApIHx8IHMucG9wKCkpIGlmICgobSA/IGZlKG8sIGMpIDogMSA9PT0gby5ub2RlVHlwZSkgJiYgKytwICYmIChmICYmICgoaSA9IG9bU10gfHwgKG9bU10gPSB7fSkpW2RdID0gW0UsIHBdKSwgbyA9PT0gZSkpIGJyZWFrOyByZXR1cm4gKHAgLT0gZykgPT09IGggfHwgcCAlIGggPT0gMCAmJiAwIDw9IHAgLyBoIH0gfSB9LCBQU0VVRE86IGZ1bmN0aW9uIChlLCBvKSB7IHZhciB0LCBhID0gYi5wc2V1ZG9zW2VdIHx8IGIuc2V0RmlsdGVyc1tlLnRvTG93ZXJDYXNlKCldIHx8IEkuZXJyb3IoInVuc3VwcG9ydGVkIHBzZXVkbzogIiArIGUpOyByZXR1cm4gYVtTXSA/IGEobykgOiAxIDwgYS5sZW5ndGggPyAodCA9IFtlLCBlLCAiIiwgb10sIGIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eShlLnRvTG93ZXJDYXNlKCkpID8gRihmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiwgciA9IGEoZSwgbyksIGkgPSByLmxlbmd0aDsgd2hpbGUgKGktLSkgZVtuID0gc2UuY2FsbChlLCByW2ldKV0gPSAhKHRbbl0gPSByW2ldKSB9KSA6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBhKGUsIDAsIHQpIH0pIDogYSB9IH0sIHBzZXVkb3M6IHsgbm90OiBGKGZ1bmN0aW9uIChlKSB7IHZhciByID0gW10sIGkgPSBbXSwgcyA9IG5lKGUucmVwbGFjZSh2ZSwgIiQxIikpOyByZXR1cm4gc1tTXSA/IEYoZnVuY3Rpb24gKGUsIHQsIG4sIHIpIHsgdmFyIGksIG8gPSBzKGUsIG51bGwsIHIsIFtdKSwgYSA9IGUubGVuZ3RoOyB3aGlsZSAoYS0tKSAoaSA9IG9bYV0pICYmIChlW2FdID0gISh0W2FdID0gaSkpIH0pIDogZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIHJbMF0gPSBlLCBzKHIsIG51bGwsIG4sIGkpLCByWzBdID0gbnVsbCwgIWkucG9wKCkgfSB9KSwgaGFzOiBGKGZ1bmN0aW9uICh0KSB7IHJldHVybiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gMCA8IEkodCwgZSkubGVuZ3RoIH0gfSksIGNvbnRhaW5zOiBGKGZ1bmN0aW9uICh0KSB7IHJldHVybiB0ID0gdC5yZXBsYWNlKE8sIFApLCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gLTEgPCAoZS50ZXh0Q29udGVudCB8fCBjZS50ZXh0KGUpKS5pbmRleE9mKHQpIH0gfSksIGxhbmc6IEYoZnVuY3Rpb24gKG4pIHsgcmV0dXJuIEEudGVzdChuIHx8ICIiKSB8fCBJLmVycm9yKCJ1bnN1cHBvcnRlZCBsYW5nOiAiICsgbiksIG4gPSBuLnJlcGxhY2UoTywgUCkudG9Mb3dlckNhc2UoKSwgZnVuY3Rpb24gKGUpIHsgdmFyIHQ7IGRvIHsgaWYgKHQgPSBDID8gZS5sYW5nIDogZS5nZXRBdHRyaWJ1dGUoInhtbDpsYW5nIikgfHwgZS5nZXRBdHRyaWJ1dGUoImxhbmciKSkgcmV0dXJuICh0ID0gdC50b0xvd2VyQ2FzZSgpKSA9PT0gbiB8fCAwID09PSB0LmluZGV4T2YobiArICItIikgfSB3aGlsZSAoKGUgPSBlLnBhcmVudE5vZGUpICYmIDEgPT09IGUubm9kZVR5cGUpOyByZXR1cm4gITEgfSB9KSwgdGFyZ2V0OiBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IGllLmxvY2F0aW9uICYmIGllLmxvY2F0aW9uLmhhc2g7IHJldHVybiB0ICYmIHQuc2xpY2UoMSkgPT09IGUuaWQgfSwgcm9vdDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUgPT09IHIgfSwgZm9jdXM6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBlID09PSBmdW5jdGlvbiAoKSB7IHRyeSB7IHJldHVybiBULmFjdGl2ZUVsZW1lbnQgfSBjYXRjaCAoZSkgeyB9IH0oKSAmJiBULmhhc0ZvY3VzKCkgJiYgISEoZS50eXBlIHx8IGUuaHJlZiB8fCB+ZS50YWJJbmRleCkgfSwgZW5hYmxlZDogeighMSksIGRpc2FibGVkOiB6KCEwKSwgY2hlY2tlZDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGZlKGUsICJpbnB1dCIpICYmICEhZS5jaGVja2VkIHx8IGZlKGUsICJvcHRpb24iKSAmJiAhIWUuc2VsZWN0ZWQgfSwgc2VsZWN0ZWQ6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBlLnBhcmVudE5vZGUgJiYgZS5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsICEwID09PSBlLnNlbGVjdGVkIH0sIGVtcHR5OiBmdW5jdGlvbiAoZSkgeyBmb3IgKGUgPSBlLmZpcnN0Q2hpbGQ7IGU7IGUgPSBlLm5leHRTaWJsaW5nKWlmIChlLm5vZGVUeXBlIDwgNikgcmV0dXJuICExOyByZXR1cm4gITAgfSwgcGFyZW50OiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gIWIucHNldWRvcy5lbXB0eShlKSB9LCBoZWFkZXI6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBxLnRlc3QoZS5ub2RlTmFtZSkgfSwgaW5wdXQ6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBOLnRlc3QoZS5ub2RlTmFtZSkgfSwgYnV0dG9uOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZmUoZSwgImlucHV0IikgJiYgImJ1dHRvbiIgPT09IGUudHlwZSB8fCBmZShlLCAiYnV0dG9uIikgfSwgdGV4dDogZnVuY3Rpb24gKGUpIHsgdmFyIHQ7IHJldHVybiBmZShlLCAiaW5wdXQiKSAmJiAidGV4dCIgPT09IGUudHlwZSAmJiAobnVsbCA9PSAodCA9IGUuZ2V0QXR0cmlidXRlKCJ0eXBlIikpIHx8ICJ0ZXh0IiA9PT0gdC50b0xvd2VyQ2FzZSgpKSB9LCBmaXJzdDogWChmdW5jdGlvbiAoKSB7IHJldHVybiBbMF0gfSksIGxhc3Q6IFgoZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIFt0IC0gMV0gfSksIGVxOiBYKGZ1bmN0aW9uIChlLCB0LCBuKSB7IHJldHVybiBbbiA8IDAgPyBuICsgdCA6IG5dIH0pLCBldmVuOiBYKGZ1bmN0aW9uIChlLCB0KSB7IGZvciAodmFyIG4gPSAwOyBuIDwgdDsgbiArPSAyKWUucHVzaChuKTsgcmV0dXJuIGUgfSksIG9kZDogWChmdW5jdGlvbiAoZSwgdCkgeyBmb3IgKHZhciBuID0gMTsgbiA8IHQ7IG4gKz0gMillLnB1c2gobik7IHJldHVybiBlIH0pLCBsdDogWChmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgcjsgZm9yIChyID0gbiA8IDAgPyBuICsgdCA6IHQgPCBuID8gdCA6IG47IDAgPD0gLS1yOyllLnB1c2gocik7IHJldHVybiBlIH0pLCBndDogWChmdW5jdGlvbiAoZSwgdCwgbikgeyBmb3IgKHZhciByID0gbiA8IDAgPyBuICsgdCA6IG47ICsrciA8IHQ7KWUucHVzaChyKTsgcmV0dXJuIGUgfSkgfSB9KS5wc2V1ZG9zLm50aCA9IGIucHNldWRvcy5lcSwgeyByYWRpbzogITAsIGNoZWNrYm94OiAhMCwgZmlsZTogITAsIHBhc3N3b3JkOiAhMCwgaW1hZ2U6ICEwIH0pIGIucHNldWRvc1tlXSA9IEIoZSk7IGZvciAoZSBpbiB7IHN1Ym1pdDogITAsIHJlc2V0OiAhMCB9KSBiLnBzZXVkb3NbZV0gPSBfKGUpOyBmdW5jdGlvbiBHKCkgeyB9IGZ1bmN0aW9uIFkoZSwgdCkgeyB2YXIgbiwgciwgaSwgbywgYSwgcywgdSwgbCA9IGNbZSArICIgIl07IGlmIChsKSByZXR1cm4gdCA/IDAgOiBsLnNsaWNlKDApOyBhID0gZSwgcyA9IFtdLCB1ID0gYi5wcmVGaWx0ZXI7IHdoaWxlIChhKSB7IGZvciAobyBpbiBuICYmICEociA9IHkuZXhlYyhhKSkgfHwgKHIgJiYgKGEgPSBhLnNsaWNlKHJbMF0ubGVuZ3RoKSB8fCBhKSwgcy5wdXNoKGkgPSBbXSkpLCBuID0gITEsIChyID0gbS5leGVjKGEpKSAmJiAobiA9IHIuc2hpZnQoKSwgaS5wdXNoKHsgdmFsdWU6IG4sIHR5cGU6IHJbMF0ucmVwbGFjZSh2ZSwgIiAiKSB9KSwgYSA9IGEuc2xpY2Uobi5sZW5ndGgpKSwgYi5maWx0ZXIpICEociA9IERbb10uZXhlYyhhKSkgfHwgdVtvXSAmJiAhKHIgPSB1W29dKHIpKSB8fCAobiA9IHIuc2hpZnQoKSwgaS5wdXNoKHsgdmFsdWU6IG4sIHR5cGU6IG8sIG1hdGNoZXM6IHIgfSksIGEgPSBhLnNsaWNlKG4ubGVuZ3RoKSk7IGlmICghbikgYnJlYWsgfSByZXR1cm4gdCA/IGEubGVuZ3RoIDogYSA/IEkuZXJyb3IoZSkgOiBjKGUsIHMpLnNsaWNlKDApIH0gZnVuY3Rpb24gUShlKSB7IGZvciAodmFyIHQgPSAwLCBuID0gZS5sZW5ndGgsIHIgPSAiIjsgdCA8IG47IHQrKylyICs9IGVbdF0udmFsdWU7IHJldHVybiByIH0gZnVuY3Rpb24gSihhLCBlLCB0KSB7IHZhciBzID0gZS5kaXIsIHUgPSBlLm5leHQsIGwgPSB1IHx8IHMsIGMgPSB0ICYmICJwYXJlbnROb2RlIiA9PT0gbCwgZiA9IG4rKzsgcmV0dXJuIGUuZmlyc3QgPyBmdW5jdGlvbiAoZSwgdCwgbikgeyB3aGlsZSAoZSA9IGVbc10pIGlmICgxID09PSBlLm5vZGVUeXBlIHx8IGMpIHJldHVybiBhKGUsIHQsIG4pOyByZXR1cm4gITEgfSA6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHZhciByLCBpLCBvID0gW0UsIGZdOyBpZiAobikgeyB3aGlsZSAoZSA9IGVbc10pIGlmICgoMSA9PT0gZS5ub2RlVHlwZSB8fCBjKSAmJiBhKGUsIHQsIG4pKSByZXR1cm4gITAgfSBlbHNlIHdoaWxlIChlID0gZVtzXSkgaWYgKDEgPT09IGUubm9kZVR5cGUgfHwgYykgaWYgKGkgPSBlW1NdIHx8IChlW1NdID0ge30pLCB1ICYmIGZlKGUsIHUpKSBlID0gZVtzXSB8fCBlOyBlbHNlIHsgaWYgKChyID0gaVtsXSkgJiYgclswXSA9PT0gRSAmJiByWzFdID09PSBmKSByZXR1cm4gb1syXSA9IHJbMl07IGlmICgoaVtsXSA9IG8pWzJdID0gYShlLCB0LCBuKSkgcmV0dXJuICEwIH0gcmV0dXJuICExIH0gfSBmdW5jdGlvbiBLKGkpIHsgcmV0dXJuIDEgPCBpLmxlbmd0aCA/IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHZhciByID0gaS5sZW5ndGg7IHdoaWxlIChyLS0pIGlmICghaVtyXShlLCB0LCBuKSkgcmV0dXJuICExOyByZXR1cm4gITAgfSA6IGlbMF0gfSBmdW5jdGlvbiBaKGUsIHQsIG4sIHIsIGkpIHsgZm9yICh2YXIgbywgYSA9IFtdLCBzID0gMCwgdSA9IGUubGVuZ3RoLCBsID0gbnVsbCAhPSB0OyBzIDwgdTsgcysrKShvID0gZVtzXSkgJiYgKG4gJiYgIW4obywgciwgaSkgfHwgKGEucHVzaChvKSwgbCAmJiB0LnB1c2gocykpKTsgcmV0dXJuIGEgfSBmdW5jdGlvbiBlZShkLCBoLCBnLCB2LCB5LCBlKSB7IHJldHVybiB2ICYmICF2W1NdICYmICh2ID0gZWUodikpLCB5ICYmICF5W1NdICYmICh5ID0gZWUoeSwgZSkpLCBGKGZ1bmN0aW9uIChlLCB0LCBuLCByKSB7IHZhciBpLCBvLCBhLCBzLCB1ID0gW10sIGwgPSBbXSwgYyA9IHQubGVuZ3RoLCBmID0gZSB8fCBmdW5jdGlvbiAoZSwgdCwgbikgeyBmb3IgKHZhciByID0gMCwgaSA9IHQubGVuZ3RoOyByIDwgaTsgcisrKUkoZSwgdFtyXSwgbik7IHJldHVybiBuIH0oaCB8fCAiKiIsIG4ubm9kZVR5cGUgPyBbbl0gOiBuLCBbXSksIHAgPSAhZCB8fCAhZSAmJiBoID8gZiA6IFooZiwgdSwgZCwgbiwgcik7IGlmIChnID8gZyhwLCBzID0geSB8fCAoZSA/IGQgOiBjIHx8IHYpID8gW10gOiB0LCBuLCByKSA6IHMgPSBwLCB2KSB7IGkgPSBaKHMsIGwpLCB2KGksIFtdLCBuLCByKSwgbyA9IGkubGVuZ3RoOyB3aGlsZSAoby0tKSAoYSA9IGlbb10pICYmIChzW2xbb11dID0gIShwW2xbb11dID0gYSkpIH0gaWYgKGUpIHsgaWYgKHkgfHwgZCkgeyBpZiAoeSkgeyBpID0gW10sIG8gPSBzLmxlbmd0aDsgd2hpbGUgKG8tLSkgKGEgPSBzW29dKSAmJiBpLnB1c2gocFtvXSA9IGEpOyB5KG51bGwsIHMgPSBbXSwgaSwgcikgfSBvID0gcy5sZW5ndGg7IHdoaWxlIChvLS0pIChhID0gc1tvXSkgJiYgLTEgPCAoaSA9IHkgPyBzZS5jYWxsKGUsIGEpIDogdVtvXSkgJiYgKGVbaV0gPSAhKHRbaV0gPSBhKSkgfSB9IGVsc2UgcyA9IFoocyA9PT0gdCA/IHMuc3BsaWNlKGMsIHMubGVuZ3RoKSA6IHMpLCB5ID8geShudWxsLCB0LCBzLCByKSA6IGsuYXBwbHkodCwgcykgfSkgfSBmdW5jdGlvbiB0ZShlKSB7IGZvciAodmFyIGksIHQsIG4sIHIgPSBlLmxlbmd0aCwgbyA9IGIucmVsYXRpdmVbZVswXS50eXBlXSwgYSA9IG8gfHwgYi5yZWxhdGl2ZVsiICJdLCBzID0gbyA/IDEgOiAwLCB1ID0gSihmdW5jdGlvbiAoZSkgeyByZXR1cm4gZSA9PT0gaSB9LCBhLCAhMCksIGwgPSBKKGZ1bmN0aW9uIChlKSB7IHJldHVybiAtMSA8IHNlLmNhbGwoaSwgZSkgfSwgYSwgITApLCBjID0gW2Z1bmN0aW9uIChlLCB0LCBuKSB7IHZhciByID0gIW8gJiYgKG4gfHwgdCAhPSB3KSB8fCAoKGkgPSB0KS5ub2RlVHlwZSA/IHUoZSwgdCwgbikgOiBsKGUsIHQsIG4pKTsgcmV0dXJuIGkgPSBudWxsLCByIH1dOyBzIDwgcjsgcysrKWlmICh0ID0gYi5yZWxhdGl2ZVtlW3NdLnR5cGVdKSBjID0gW0ooSyhjKSwgdCldOyBlbHNlIHsgaWYgKCh0ID0gYi5maWx0ZXJbZVtzXS50eXBlXS5hcHBseShudWxsLCBlW3NdLm1hdGNoZXMpKVtTXSkgeyBmb3IgKG4gPSArK3M7IG4gPCByOyBuKyspaWYgKGIucmVsYXRpdmVbZVtuXS50eXBlXSkgYnJlYWs7IHJldHVybiBlZSgxIDwgcyAmJiBLKGMpLCAxIDwgcyAmJiBRKGUuc2xpY2UoMCwgcyAtIDEpLmNvbmNhdCh7IHZhbHVlOiAiICIgPT09IGVbcyAtIDJdLnR5cGUgPyAiKiIgOiAiIiB9KSkucmVwbGFjZSh2ZSwgIiQxIiksIHQsIHMgPCBuICYmIHRlKGUuc2xpY2UocywgbikpLCBuIDwgciAmJiB0ZShlID0gZS5zbGljZShuKSksIG4gPCByICYmIFEoZSkpIH0gYy5wdXNoKHQpIH0gcmV0dXJuIEsoYykgfSBmdW5jdGlvbiBuZShlLCB0KSB7IHZhciBuLCB2LCB5LCBtLCB4LCByLCBpID0gW10sIG8gPSBbXSwgYSA9IHVbZSArICIgIl07IGlmICghYSkgeyB0IHx8ICh0ID0gWShlKSksIG4gPSB0Lmxlbmd0aDsgd2hpbGUgKG4tLSkgKGEgPSB0ZSh0W25dKSlbU10gPyBpLnB1c2goYSkgOiBvLnB1c2goYSk7IChhID0gdShlLCAodiA9IG8sIG0gPSAwIDwgKHkgPSBpKS5sZW5ndGgsIHggPSAwIDwgdi5sZW5ndGgsIHIgPSBmdW5jdGlvbiAoZSwgdCwgbiwgciwgaSkgeyB2YXIgbywgYSwgcywgdSA9IDAsIGwgPSAiMCIsIGMgPSBlICYmIFtdLCBmID0gW10sIHAgPSB3LCBkID0gZSB8fCB4ICYmIGIuZmluZC5UQUcoIioiLCBpKSwgaCA9IEUgKz0gbnVsbCA9PSBwID8gMSA6IE1hdGgucmFuZG9tKCkgfHwgLjEsIGcgPSBkLmxlbmd0aDsgZm9yIChpICYmICh3ID0gdCA9PSBUIHx8IHQgfHwgaSk7IGwgIT09IGcgJiYgbnVsbCAhPSAobyA9IGRbbF0pOyBsKyspIHsgaWYgKHggJiYgbykgeyBhID0gMCwgdCB8fCBvLm93bmVyRG9jdW1lbnQgPT0gVCB8fCAoVihvKSwgbiA9ICFDKTsgd2hpbGUgKHMgPSB2W2ErK10pIGlmIChzKG8sIHQgfHwgVCwgbikpIHsgay5jYWxsKHIsIG8pOyBicmVhayB9IGkgJiYgKEUgPSBoKSB9IG0gJiYgKChvID0gIXMgJiYgbykgJiYgdS0tLCBlICYmIGMucHVzaChvKSkgfSBpZiAodSArPSBsLCBtICYmIGwgIT09IHUpIHsgYSA9IDA7IHdoaWxlIChzID0geVthKytdKSBzKGMsIGYsIHQsIG4pOyBpZiAoZSkgeyBpZiAoMCA8IHUpIHdoaWxlIChsLS0pIGNbbF0gfHwgZltsXSB8fCAoZltsXSA9IHBlLmNhbGwocikpOyBmID0gWihmKSB9IGsuYXBwbHkociwgZiksIGkgJiYgIWUgJiYgMCA8IGYubGVuZ3RoICYmIDEgPCB1ICsgeS5sZW5ndGggJiYgY2UudW5pcXVlU29ydChyKSB9IHJldHVybiBpICYmIChFID0gaCwgdyA9IHApLCBjIH0sIG0gPyBGKHIpIDogcikpKS5zZWxlY3RvciA9IGUgfSByZXR1cm4gYSB9IGZ1bmN0aW9uIHJlKGUsIHQsIG4sIHIpIHsgdmFyIGksIG8sIGEsIHMsIHUsIGwgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBlICYmIGUsIGMgPSAhciAmJiBZKGUgPSBsLnNlbGVjdG9yIHx8IGUpOyBpZiAobiA9IG4gfHwgW10sIDEgPT09IGMubGVuZ3RoKSB7IGlmICgyIDwgKG8gPSBjWzBdID0gY1swXS5zbGljZSgwKSkubGVuZ3RoICYmICJJRCIgPT09IChhID0gb1swXSkudHlwZSAmJiA5ID09PSB0Lm5vZGVUeXBlICYmIEMgJiYgYi5yZWxhdGl2ZVtvWzFdLnR5cGVdKSB7IGlmICghKHQgPSAoYi5maW5kLklEKGEubWF0Y2hlc1swXS5yZXBsYWNlKE8sIFApLCB0KSB8fCBbXSlbMF0pKSByZXR1cm4gbjsgbCAmJiAodCA9IHQucGFyZW50Tm9kZSksIGUgPSBlLnNsaWNlKG8uc2hpZnQoKS52YWx1ZS5sZW5ndGgpIH0gaSA9IEQubmVlZHNDb250ZXh0LnRlc3QoZSkgPyAwIDogby5sZW5ndGg7IHdoaWxlIChpLS0pIHsgaWYgKGEgPSBvW2ldLCBiLnJlbGF0aXZlW3MgPSBhLnR5cGVdKSBicmVhazsgaWYgKCh1ID0gYi5maW5kW3NdKSAmJiAociA9IHUoYS5tYXRjaGVzWzBdLnJlcGxhY2UoTywgUCksIEgudGVzdChvWzBdLnR5cGUpICYmIFUodC5wYXJlbnROb2RlKSB8fCB0KSkpIHsgaWYgKG8uc3BsaWNlKGksIDEpLCAhKGUgPSByLmxlbmd0aCAmJiBRKG8pKSkgcmV0dXJuIGsuYXBwbHkobiwgciksIG47IGJyZWFrIH0gfSB9IHJldHVybiAobCB8fCBuZShlLCBjKSkociwgdCwgIUMsIG4sICF0IHx8IEgudGVzdChlKSAmJiBVKHQucGFyZW50Tm9kZSkgfHwgdCksIG4gfSBHLnByb3RvdHlwZSA9IGIuZmlsdGVycyA9IGIucHNldWRvcywgYi5zZXRGaWx0ZXJzID0gbmV3IEcsIGxlLnNvcnRTdGFibGUgPSBTLnNwbGl0KCIiKS5zb3J0KGwpLmpvaW4oIiIpID09PSBTLCBWKCksIGxlLnNvcnREZXRhY2hlZCA9ICQoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIDEgJiBlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKFQuY3JlYXRlRWxlbWVudCgiZmllbGRzZXQiKSkgfSksIGNlLmZpbmQgPSBJLCBjZS5leHByWyI6Il0gPSBjZS5leHByLnBzZXVkb3MsIGNlLnVuaXF1ZSA9IGNlLnVuaXF1ZVNvcnQsIEkuY29tcGlsZSA9IG5lLCBJLnNlbGVjdCA9IHJlLCBJLnNldERvY3VtZW50ID0gViwgSS50b2tlbml6ZSA9IFksIEkuZXNjYXBlID0gY2UuZXNjYXBlU2VsZWN0b3IsIEkuZ2V0VGV4dCA9IGNlLnRleHQsIEkuaXNYTUwgPSBjZS5pc1hNTERvYywgSS5zZWxlY3RvcnMgPSBjZS5leHByLCBJLnN1cHBvcnQgPSBjZS5zdXBwb3J0LCBJLnVuaXF1ZVNvcnQgPSBjZS51bmlxdWVTb3J0IH0oKTsgdmFyIGQgPSBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciA9IFtdLCBpID0gdm9pZCAwICE9PSBuOyB3aGlsZSAoKGUgPSBlW3RdKSAmJiA5ICE9PSBlLm5vZGVUeXBlKSBpZiAoMSA9PT0gZS5ub2RlVHlwZSkgeyBpZiAoaSAmJiBjZShlKS5pcyhuKSkgYnJlYWs7IHIucHVzaChlKSB9IHJldHVybiByIH0sIGggPSBmdW5jdGlvbiAoZSwgdCkgeyBmb3IgKHZhciBuID0gW107IGU7IGUgPSBlLm5leHRTaWJsaW5nKTEgPT09IGUubm9kZVR5cGUgJiYgZSAhPT0gdCAmJiBuLnB1c2goZSk7IHJldHVybiBuIH0sIGIgPSBjZS5leHByLm1hdGNoLm5lZWRzQ29udGV4dCwgdyA9IC9ePChbYS16XVteXC9cMD46XHgyMFx0XHJcblxmXSopW1x4MjBcdFxyXG5cZl0qXC8/Pig/OjxcL1wxPnwpJC9pOyBmdW5jdGlvbiBUKGUsIG4sIHIpIHsgcmV0dXJuIHYobikgPyBjZS5ncmVwKGUsIGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiAhIW4uY2FsbChlLCB0LCBlKSAhPT0gciB9KSA6IG4ubm9kZVR5cGUgPyBjZS5ncmVwKGUsIGZ1bmN0aW9uIChlKSB7IHJldHVybiBlID09PSBuICE9PSByIH0pIDogInN0cmluZyIgIT0gdHlwZW9mIG4gPyBjZS5ncmVwKGUsIGZ1bmN0aW9uIChlKSB7IHJldHVybiAtMSA8IHNlLmNhbGwobiwgZSkgIT09IHIgfSkgOiBjZS5maWx0ZXIobiwgZSwgcikgfSBjZS5maWx0ZXIgPSBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciA9IHRbMF07IHJldHVybiBuICYmIChlID0gIjpub3QoIiArIGUgKyAiKSIpLCAxID09PSB0Lmxlbmd0aCAmJiAxID09PSByLm5vZGVUeXBlID8gY2UuZmluZC5tYXRjaGVzU2VsZWN0b3IociwgZSkgPyBbcl0gOiBbXSA6IGNlLmZpbmQubWF0Y2hlcyhlLCBjZS5ncmVwKHQsIGZ1bmN0aW9uIChlKSB7IHJldHVybiAxID09PSBlLm5vZGVUeXBlIH0pKSB9LCBjZS5mbi5leHRlbmQoeyBmaW5kOiBmdW5jdGlvbiAoZSkgeyB2YXIgdCwgbiwgciA9IHRoaXMubGVuZ3RoLCBpID0gdGhpczsgaWYgKCJzdHJpbmciICE9IHR5cGVvZiBlKSByZXR1cm4gdGhpcy5wdXNoU3RhY2soY2UoZSkuZmlsdGVyKGZ1bmN0aW9uICgpIHsgZm9yICh0ID0gMDsgdCA8IHI7IHQrKylpZiAoY2UuY29udGFpbnMoaVt0XSwgdGhpcykpIHJldHVybiAhMCB9KSk7IGZvciAobiA9IHRoaXMucHVzaFN0YWNrKFtdKSwgdCA9IDA7IHQgPCByOyB0KyspY2UuZmluZChlLCBpW3RdLCBuKTsgcmV0dXJuIDEgPCByID8gY2UudW5pcXVlU29ydChuKSA6IG4gfSwgZmlsdGVyOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gdGhpcy5wdXNoU3RhY2soVCh0aGlzLCBlIHx8IFtdLCAhMSkpIH0sIG5vdDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHRoaXMucHVzaFN0YWNrKFQodGhpcywgZSB8fCBbXSwgITApKSB9LCBpczogZnVuY3Rpb24gKGUpIHsgcmV0dXJuICEhVCh0aGlzLCAic3RyaW5nIiA9PSB0eXBlb2YgZSAmJiBiLnRlc3QoZSkgPyBjZShlKSA6IGUgfHwgW10sICExKS5sZW5ndGggfSB9KTsgdmFyIGssIFMgPSAvXig/OlxzKig8W1x3XFddKz4pW14+XSp8IyhbXHctXSspKSQvOyAoY2UuZm4uaW5pdCA9IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHZhciByLCBpOyBpZiAoIWUpIHJldHVybiB0aGlzOyBpZiAobiA9IG4gfHwgaywgInN0cmluZyIgPT0gdHlwZW9mIGUpIHsgaWYgKCEociA9ICI8IiA9PT0gZVswXSAmJiAiPiIgPT09IGVbZS5sZW5ndGggLSAxXSAmJiAzIDw9IGUubGVuZ3RoID8gW251bGwsIGUsIG51bGxdIDogUy5leGVjKGUpKSB8fCAhclsxXSAmJiB0KSByZXR1cm4gIXQgfHwgdC5qcXVlcnkgPyAodCB8fCBuKS5maW5kKGUpIDogdGhpcy5jb25zdHJ1Y3Rvcih0KS5maW5kKGUpOyBpZiAoclsxXSkgeyBpZiAodCA9IHQgaW5zdGFuY2VvZiBjZSA/IHRbMF0gOiB0LCBjZS5tZXJnZSh0aGlzLCBjZS5wYXJzZUhUTUwoclsxXSwgdCAmJiB0Lm5vZGVUeXBlID8gdC5vd25lckRvY3VtZW50IHx8IHQgOiBDLCAhMCkpLCB3LnRlc3QoclsxXSkgJiYgY2UuaXNQbGFpbk9iamVjdCh0KSkgZm9yIChyIGluIHQpIHYodGhpc1tyXSkgPyB0aGlzW3JdKHRbcl0pIDogdGhpcy5hdHRyKHIsIHRbcl0pOyByZXR1cm4gdGhpcyB9IHJldHVybiAoaSA9IEMuZ2V0RWxlbWVudEJ5SWQoclsyXSkpICYmICh0aGlzWzBdID0gaSwgdGhpcy5sZW5ndGggPSAxKSwgdGhpcyB9IHJldHVybiBlLm5vZGVUeXBlID8gKHRoaXNbMF0gPSBlLCB0aGlzLmxlbmd0aCA9IDEsIHRoaXMpIDogdihlKSA/IHZvaWQgMCAhPT0gbi5yZWFkeSA/IG4ucmVhZHkoZSkgOiBlKGNlKSA6IGNlLm1ha2VBcnJheShlLCB0aGlzKSB9KS5wcm90b3R5cGUgPSBjZS5mbiwgayA9IGNlKEMpOyB2YXIgRSA9IC9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLCBqID0geyBjaGlsZHJlbjogITAsIGNvbnRlbnRzOiAhMCwgbmV4dDogITAsIHByZXY6ICEwIH07IGZ1bmN0aW9uIEEoZSwgdCkgeyB3aGlsZSAoKGUgPSBlW3RdKSAmJiAxICE9PSBlLm5vZGVUeXBlKTsgcmV0dXJuIGUgfSBjZS5mbi5leHRlbmQoeyBoYXM6IGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gY2UoZSwgdGhpcyksIG4gPSB0Lmxlbmd0aDsgcmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uICgpIHsgZm9yICh2YXIgZSA9IDA7IGUgPCBuOyBlKyspaWYgKGNlLmNvbnRhaW5zKHRoaXMsIHRbZV0pKSByZXR1cm4gITAgfSkgfSwgY2xvc2VzdDogZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4sIHIgPSAwLCBpID0gdGhpcy5sZW5ndGgsIG8gPSBbXSwgYSA9ICJzdHJpbmciICE9IHR5cGVvZiBlICYmIGNlKGUpOyBpZiAoIWIudGVzdChlKSkgZm9yICg7IHIgPCBpOyByKyspZm9yIChuID0gdGhpc1tyXTsgbiAmJiBuICE9PSB0OyBuID0gbi5wYXJlbnROb2RlKWlmIChuLm5vZGVUeXBlIDwgMTEgJiYgKGEgPyAtMSA8IGEuaW5kZXgobikgOiAxID09PSBuLm5vZGVUeXBlICYmIGNlLmZpbmQubWF0Y2hlc1NlbGVjdG9yKG4sIGUpKSkgeyBvLnB1c2gobik7IGJyZWFrIH0gcmV0dXJuIHRoaXMucHVzaFN0YWNrKDEgPCBvLmxlbmd0aCA/IGNlLnVuaXF1ZVNvcnQobykgOiBvKSB9LCBpbmRleDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUgPyAic3RyaW5nIiA9PSB0eXBlb2YgZSA/IHNlLmNhbGwoY2UoZSksIHRoaXNbMF0pIDogc2UuY2FsbCh0aGlzLCBlLmpxdWVyeSA/IGVbMF0gOiBlKSA6IHRoaXNbMF0gJiYgdGhpc1swXS5wYXJlbnROb2RlID8gdGhpcy5maXJzdCgpLnByZXZBbGwoKS5sZW5ndGggOiAtMSB9LCBhZGQ6IGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiB0aGlzLnB1c2hTdGFjayhjZS51bmlxdWVTb3J0KGNlLm1lcmdlKHRoaXMuZ2V0KCksIGNlKGUsIHQpKSkpIH0sIGFkZEJhY2s6IGZ1bmN0aW9uIChlKSB7IHJldHVybiB0aGlzLmFkZChudWxsID09IGUgPyB0aGlzLnByZXZPYmplY3QgOiB0aGlzLnByZXZPYmplY3QuZmlsdGVyKGUpKSB9IH0pLCBjZS5lYWNoKHsgcGFyZW50OiBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IGUucGFyZW50Tm9kZTsgcmV0dXJuIHQgJiYgMTEgIT09IHQubm9kZVR5cGUgPyB0IDogbnVsbCB9LCBwYXJlbnRzOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZChlLCAicGFyZW50Tm9kZSIpIH0sIHBhcmVudHNVbnRpbDogZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIGQoZSwgInBhcmVudE5vZGUiLCBuKSB9LCBuZXh0OiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gQShlLCAibmV4dFNpYmxpbmciKSB9LCBwcmV2OiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gQShlLCAicHJldmlvdXNTaWJsaW5nIikgfSwgbmV4dEFsbDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGQoZSwgIm5leHRTaWJsaW5nIikgfSwgcHJldkFsbDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGQoZSwgInByZXZpb3VzU2libGluZyIpIH0sIG5leHRVbnRpbDogZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIGQoZSwgIm5leHRTaWJsaW5nIiwgbikgfSwgcHJldlVudGlsOiBmdW5jdGlvbiAoZSwgdCwgbikgeyByZXR1cm4gZChlLCAicHJldmlvdXNTaWJsaW5nIiwgbikgfSwgc2libGluZ3M6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBoKChlLnBhcmVudE5vZGUgfHwge30pLmZpcnN0Q2hpbGQsIGUpIH0sIGNoaWxkcmVuOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gaChlLmZpcnN0Q2hpbGQpIH0sIGNvbnRlbnRzOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gbnVsbCAhPSBlLmNvbnRlbnREb2N1bWVudCAmJiByKGUuY29udGVudERvY3VtZW50KSA/IGUuY29udGVudERvY3VtZW50IDogKGZlKGUsICJ0ZW1wbGF0ZSIpICYmIChlID0gZS5jb250ZW50IHx8IGUpLCBjZS5tZXJnZShbXSwgZS5jaGlsZE5vZGVzKSkgfSB9LCBmdW5jdGlvbiAociwgaSkgeyBjZS5mbltyXSA9IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuID0gY2UubWFwKHRoaXMsIGksIGUpOyByZXR1cm4gIlVudGlsIiAhPT0gci5zbGljZSgtNSkgJiYgKHQgPSBlKSwgdCAmJiAic3RyaW5nIiA9PSB0eXBlb2YgdCAmJiAobiA9IGNlLmZpbHRlcih0LCBuKSksIDEgPCB0aGlzLmxlbmd0aCAmJiAoaltyXSB8fCBjZS51bmlxdWVTb3J0KG4pLCBFLnRlc3QocikgJiYgbi5yZXZlcnNlKCkpLCB0aGlzLnB1c2hTdGFjayhuKSB9IH0pOyB2YXIgRCA9IC9bXlx4MjBcdFxyXG5cZl0rL2c7IGZ1bmN0aW9uIE4oZSkgeyByZXR1cm4gZSB9IGZ1bmN0aW9uIHEoZSkgeyB0aHJvdyBlIH0gZnVuY3Rpb24gTChlLCB0LCBuLCByKSB7IHZhciBpOyB0cnkgeyBlICYmIHYoaSA9IGUucHJvbWlzZSkgPyBpLmNhbGwoZSkuZG9uZSh0KS5mYWlsKG4pIDogZSAmJiB2KGkgPSBlLnRoZW4pID8gaS5jYWxsKGUsIHQsIG4pIDogdC5hcHBseSh2b2lkIDAsIFtlXS5zbGljZShyKSkgfSBjYXRjaCAoZSkgeyBuLmFwcGx5KHZvaWQgMCwgW2VdKSB9IH0gY2UuQ2FsbGJhY2tzID0gZnVuY3Rpb24gKHIpIHsgdmFyIGUsIG47IHIgPSAic3RyaW5nIiA9PSB0eXBlb2YgciA/IChlID0gciwgbiA9IHt9LCBjZS5lYWNoKGUubWF0Y2goRCkgfHwgW10sIGZ1bmN0aW9uIChlLCB0KSB7IG5bdF0gPSAhMCB9KSwgbikgOiBjZS5leHRlbmQoe30sIHIpOyB2YXIgaSwgdCwgbywgYSwgcyA9IFtdLCB1ID0gW10sIGwgPSAtMSwgYyA9IGZ1bmN0aW9uICgpIHsgZm9yIChhID0gYSB8fCByLm9uY2UsIG8gPSBpID0gITA7IHUubGVuZ3RoOyBsID0gLTEpIHsgdCA9IHUuc2hpZnQoKTsgd2hpbGUgKCsrbCA8IHMubGVuZ3RoKSAhMSA9PT0gc1tsXS5hcHBseSh0WzBdLCB0WzFdKSAmJiByLnN0b3BPbkZhbHNlICYmIChsID0gcy5sZW5ndGgsIHQgPSAhMSkgfSByLm1lbW9yeSB8fCAodCA9ICExKSwgaSA9ICExLCBhICYmIChzID0gdCA/IFtdIDogIiIpIH0sIGYgPSB7IGFkZDogZnVuY3Rpb24gKCkgeyByZXR1cm4gcyAmJiAodCAmJiAhaSAmJiAobCA9IHMubGVuZ3RoIC0gMSwgdS5wdXNoKHQpKSwgZnVuY3Rpb24gbihlKSB7IGNlLmVhY2goZSwgZnVuY3Rpb24gKGUsIHQpIHsgdih0KSA/IHIudW5pcXVlICYmIGYuaGFzKHQpIHx8IHMucHVzaCh0KSA6IHQgJiYgdC5sZW5ndGggJiYgInN0cmluZyIgIT09IHgodCkgJiYgbih0KSB9KSB9KGFyZ3VtZW50cyksIHQgJiYgIWkgJiYgYygpKSwgdGhpcyB9LCByZW1vdmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNlLmVhY2goYXJndW1lbnRzLCBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbjsgd2hpbGUgKC0xIDwgKG4gPSBjZS5pbkFycmF5KHQsIHMsIG4pKSkgcy5zcGxpY2UobiwgMSksIG4gPD0gbCAmJiBsLS0gfSksIHRoaXMgfSwgaGFzOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZSA/IC0xIDwgY2UuaW5BcnJheShlLCBzKSA6IDAgPCBzLmxlbmd0aCB9LCBlbXB0eTogZnVuY3Rpb24gKCkgeyByZXR1cm4gcyAmJiAocyA9IFtdKSwgdGhpcyB9LCBkaXNhYmxlOiBmdW5jdGlvbiAoKSB7IHJldHVybiBhID0gdSA9IFtdLCBzID0gdCA9ICIiLCB0aGlzIH0sIGRpc2FibGVkOiBmdW5jdGlvbiAoKSB7IHJldHVybiAhcyB9LCBsb2NrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBhID0gdSA9IFtdLCB0IHx8IGkgfHwgKHMgPSB0ID0gIiIpLCB0aGlzIH0sIGxvY2tlZDogZnVuY3Rpb24gKCkgeyByZXR1cm4gISFhIH0sIGZpcmVXaXRoOiBmdW5jdGlvbiAoZSwgdCkgeyByZXR1cm4gYSB8fCAodCA9IFtlLCAodCA9IHQgfHwgW10pLnNsaWNlID8gdC5zbGljZSgpIDogdF0sIHUucHVzaCh0KSwgaSB8fCBjKCkpLCB0aGlzIH0sIGZpcmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGYuZmlyZVdpdGgodGhpcywgYXJndW1lbnRzKSwgdGhpcyB9LCBmaXJlZDogZnVuY3Rpb24gKCkgeyByZXR1cm4gISFvIH0gfTsgcmV0dXJuIGYgfSwgY2UuZXh0ZW5kKHsgRGVmZXJyZWQ6IGZ1bmN0aW9uIChlKSB7IHZhciBvID0gW1sibm90aWZ5IiwgInByb2dyZXNzIiwgY2UuQ2FsbGJhY2tzKCJtZW1vcnkiKSwgY2UuQ2FsbGJhY2tzKCJtZW1vcnkiKSwgMl0sIFsicmVzb2x2ZSIsICJkb25lIiwgY2UuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLCBjZS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksIDAsICJyZXNvbHZlZCJdLCBbInJlamVjdCIsICJmYWlsIiwgY2UuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLCBjZS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksIDEsICJyZWplY3RlZCJdXSwgaSA9ICJwZW5kaW5nIiwgYSA9IHsgc3RhdGU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGkgfSwgYWx3YXlzOiBmdW5jdGlvbiAoKSB7IHJldHVybiBzLmRvbmUoYXJndW1lbnRzKS5mYWlsKGFyZ3VtZW50cyksIHRoaXMgfSwgImNhdGNoIjogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGEudGhlbihudWxsLCBlKSB9LCBwaXBlOiBmdW5jdGlvbiAoKSB7IHZhciBpID0gYXJndW1lbnRzOyByZXR1cm4gY2UuRGVmZXJyZWQoZnVuY3Rpb24gKHIpIHsgY2UuZWFjaChvLCBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiA9IHYoaVt0WzRdXSkgJiYgaVt0WzRdXTsgc1t0WzFdXShmdW5jdGlvbiAoKSB7IHZhciBlID0gbiAmJiBuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IGUgJiYgdihlLnByb21pc2UpID8gZS5wcm9taXNlKCkucHJvZ3Jlc3Moci5ub3RpZnkpLmRvbmUoci5yZXNvbHZlKS5mYWlsKHIucmVqZWN0KSA6IHJbdFswXSArICJXaXRoIl0odGhpcywgbiA/IFtlXSA6IGFyZ3VtZW50cykgfSkgfSksIGkgPSBudWxsIH0pLnByb21pc2UoKSB9LCB0aGVuOiBmdW5jdGlvbiAodCwgbiwgcikgeyB2YXIgdSA9IDA7IGZ1bmN0aW9uIGwoaSwgbywgYSwgcykgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgbiA9IHRoaXMsIHIgPSBhcmd1bWVudHMsIGUgPSBmdW5jdGlvbiAoKSB7IHZhciBlLCB0OyBpZiAoIShpIDwgdSkpIHsgaWYgKChlID0gYS5hcHBseShuLCByKSkgPT09IG8ucHJvbWlzZSgpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJUaGVuYWJsZSBzZWxmLXJlc29sdXRpb24iKTsgdCA9IGUgJiYgKCJvYmplY3QiID09IHR5cGVvZiBlIHx8ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGUpICYmIGUudGhlbiwgdih0KSA/IHMgPyB0LmNhbGwoZSwgbCh1LCBvLCBOLCBzKSwgbCh1LCBvLCBxLCBzKSkgOiAodSsrLCB0LmNhbGwoZSwgbCh1LCBvLCBOLCBzKSwgbCh1LCBvLCBxLCBzKSwgbCh1LCBvLCBOLCBvLm5vdGlmeVdpdGgpKSkgOiAoYSAhPT0gTiAmJiAobiA9IHZvaWQgMCwgciA9IFtlXSksIChzIHx8IG8ucmVzb2x2ZVdpdGgpKG4sIHIpKSB9IH0sIHQgPSBzID8gZSA6IGZ1bmN0aW9uICgpIHsgdHJ5IHsgZSgpIH0gY2F0Y2ggKGUpIHsgY2UuRGVmZXJyZWQuZXhjZXB0aW9uSG9vayAmJiBjZS5EZWZlcnJlZC5leGNlcHRpb25Ib29rKGUsIHQuZXJyb3IpLCB1IDw9IGkgKyAxICYmIChhICE9PSBxICYmIChuID0gdm9pZCAwLCByID0gW2VdKSwgby5yZWplY3RXaXRoKG4sIHIpKSB9IH07IGkgPyB0KCkgOiAoY2UuRGVmZXJyZWQuZ2V0RXJyb3JIb29rID8gdC5lcnJvciA9IGNlLkRlZmVycmVkLmdldEVycm9ySG9vaygpIDogY2UuRGVmZXJyZWQuZ2V0U3RhY2tIb29rICYmICh0LmVycm9yID0gY2UuRGVmZXJyZWQuZ2V0U3RhY2tIb29rKCkpLCBpZS5zZXRUaW1lb3V0KHQpKSB9IH0gcmV0dXJuIGNlLkRlZmVycmVkKGZ1bmN0aW9uIChlKSB7IG9bMF1bM10uYWRkKGwoMCwgZSwgdihyKSA/IHIgOiBOLCBlLm5vdGlmeVdpdGgpKSwgb1sxXVszXS5hZGQobCgwLCBlLCB2KHQpID8gdCA6IE4pKSwgb1syXVszXS5hZGQobCgwLCBlLCB2KG4pID8gbiA6IHEpKSB9KS5wcm9taXNlKCkgfSwgcHJvbWlzZTogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIG51bGwgIT0gZSA/IGNlLmV4dGVuZChlLCBhKSA6IGEgfSB9LCBzID0ge307IHJldHVybiBjZS5lYWNoKG8sIGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuID0gdFsyXSwgciA9IHRbNV07IGFbdFsxXV0gPSBuLmFkZCwgciAmJiBuLmFkZChmdW5jdGlvbiAoKSB7IGkgPSByIH0sIG9bMyAtIGVdWzJdLmRpc2FibGUsIG9bMyAtIGVdWzNdLmRpc2FibGUsIG9bMF1bMl0ubG9jaywgb1swXVszXS5sb2NrKSwgbi5hZGQodFszXS5maXJlKSwgc1t0WzBdXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNbdFswXSArICJXaXRoIl0odGhpcyA9PT0gcyA/IHZvaWQgMCA6IHRoaXMsIGFyZ3VtZW50cyksIHRoaXMgfSwgc1t0WzBdICsgIldpdGgiXSA9IG4uZmlyZVdpdGggfSksIGEucHJvbWlzZShzKSwgZSAmJiBlLmNhbGwocywgcyksIHMgfSwgd2hlbjogZnVuY3Rpb24gKGUpIHsgdmFyIG4gPSBhcmd1bWVudHMubGVuZ3RoLCB0ID0gbiwgciA9IEFycmF5KHQpLCBpID0gYWUuY2FsbChhcmd1bWVudHMpLCBvID0gY2UuRGVmZXJyZWQoKSwgYSA9IGZ1bmN0aW9uICh0KSB7IHJldHVybiBmdW5jdGlvbiAoZSkgeyByW3RdID0gdGhpcywgaVt0XSA9IDEgPCBhcmd1bWVudHMubGVuZ3RoID8gYWUuY2FsbChhcmd1bWVudHMpIDogZSwgLS1uIHx8IG8ucmVzb2x2ZVdpdGgociwgaSkgfSB9OyBpZiAobiA8PSAxICYmIChMKGUsIG8uZG9uZShhKHQpKS5yZXNvbHZlLCBvLnJlamVjdCwgIW4pLCAicGVuZGluZyIgPT09IG8uc3RhdGUoKSB8fCB2KGlbdF0gJiYgaVt0XS50aGVuKSkpIHJldHVybiBvLnRoZW4oKTsgd2hpbGUgKHQtLSkgTChpW3RdLCBhKHQpLCBvLnJlamVjdCk7IHJldHVybiBvLnByb21pc2UoKSB9IH0pOyB2YXIgSCA9IC9eKEV2YWx8SW50ZXJuYWx8UmFuZ2V8UmVmZXJlbmNlfFN5bnRheHxUeXBlfFVSSSlFcnJvciQvOyBjZS5EZWZlcnJlZC5leGNlcHRpb25Ib29rID0gZnVuY3Rpb24gKGUsIHQpIHsgaWUuY29uc29sZSAmJiBpZS5jb25zb2xlLndhcm4gJiYgZSAmJiBILnRlc3QoZS5uYW1lKSAmJiBpZS5jb25zb2xlLndhcm4oImpRdWVyeS5EZWZlcnJlZCBleGNlcHRpb246ICIgKyBlLm1lc3NhZ2UsIGUuc3RhY2ssIHQpIH0sIGNlLnJlYWR5RXhjZXB0aW9uID0gZnVuY3Rpb24gKGUpIHsgaWUuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHRocm93IGUgfSkgfTsgdmFyIE8gPSBjZS5EZWZlcnJlZCgpOyBmdW5jdGlvbiBQKCkgeyBDLnJlbW92ZUV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCBQKSwgaWUucmVtb3ZlRXZlbnRMaXN0ZW5lcigibG9hZCIsIFApLCBjZS5yZWFkeSgpIH0gY2UuZm4ucmVhZHkgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gTy50aGVuKGUpWyJjYXRjaCJdKGZ1bmN0aW9uIChlKSB7IGNlLnJlYWR5RXhjZXB0aW9uKGUpIH0pLCB0aGlzIH0sIGNlLmV4dGVuZCh7IGlzUmVhZHk6ICExLCByZWFkeVdhaXQ6IDEsIHJlYWR5OiBmdW5jdGlvbiAoZSkgeyAoITAgPT09IGUgPyAtLWNlLnJlYWR5V2FpdCA6IGNlLmlzUmVhZHkpIHx8IChjZS5pc1JlYWR5ID0gITApICE9PSBlICYmIDAgPCAtLWNlLnJlYWR5V2FpdCB8fCBPLnJlc29sdmVXaXRoKEMsIFtjZV0pIH0gfSksIGNlLnJlYWR5LnRoZW4gPSBPLnRoZW4sICJjb21wbGV0ZSIgPT09IEMucmVhZHlTdGF0ZSB8fCAibG9hZGluZyIgIT09IEMucmVhZHlTdGF0ZSAmJiAhQy5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGwgPyBpZS5zZXRUaW1lb3V0KGNlLnJlYWR5KSA6IChDLmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCBQKSwgaWUuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsIFApKTsgdmFyIE0gPSBmdW5jdGlvbiAoZSwgdCwgbiwgciwgaSwgbywgYSkgeyB2YXIgcyA9IDAsIHUgPSBlLmxlbmd0aCwgbCA9IG51bGwgPT0gbjsgaWYgKCJvYmplY3QiID09PSB4KG4pKSBmb3IgKHMgaW4gaSA9ICEwLCBuKSBNKGUsIHQsIHMsIG5bc10sICEwLCBvLCBhKTsgZWxzZSBpZiAodm9pZCAwICE9PSByICYmIChpID0gITAsIHYocikgfHwgKGEgPSAhMCksIGwgJiYgKGEgPyAodC5jYWxsKGUsIHIpLCB0ID0gbnVsbCkgOiAobCA9IHQsIHQgPSBmdW5jdGlvbiAoZSwgdCwgbikgeyByZXR1cm4gbC5jYWxsKGNlKGUpLCBuKSB9KSksIHQpKSBmb3IgKDsgcyA8IHU7IHMrKyl0KGVbc10sIG4sIGEgPyByIDogci5jYWxsKGVbc10sIHMsIHQoZVtzXSwgbikpKTsgcmV0dXJuIGkgPyBlIDogbCA/IHQuY2FsbChlKSA6IHUgPyB0KGVbMF0sIG4pIDogbyB9LCBSID0gL14tbXMtLywgSSA9IC8tKFthLXpdKS9nOyBmdW5jdGlvbiBXKGUsIHQpIHsgcmV0dXJuIHQudG9VcHBlckNhc2UoKSB9IGZ1bmN0aW9uIEYoZSkgeyByZXR1cm4gZS5yZXBsYWNlKFIsICJtcy0iKS5yZXBsYWNlKEksIFcpIH0gdmFyICQgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gMSA9PT0gZS5ub2RlVHlwZSB8fCA5ID09PSBlLm5vZGVUeXBlIHx8ICErZS5ub2RlVHlwZSB9OyBmdW5jdGlvbiBCKCkgeyB0aGlzLmV4cGFuZG8gPSBjZS5leHBhbmRvICsgQi51aWQrKyB9IEIudWlkID0gMSwgQi5wcm90b3R5cGUgPSB7IGNhY2hlOiBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IGVbdGhpcy5leHBhbmRvXTsgcmV0dXJuIHQgfHwgKHQgPSB7fSwgJChlKSAmJiAoZS5ub2RlVHlwZSA/IGVbdGhpcy5leHBhbmRvXSA9IHQgOiBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgdGhpcy5leHBhbmRvLCB7IHZhbHVlOiB0LCBjb25maWd1cmFibGU6ICEwIH0pKSksIHQgfSwgc2V0OiBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciwgaSA9IHRoaXMuY2FjaGUoZSk7IGlmICgic3RyaW5nIiA9PSB0eXBlb2YgdCkgaVtGKHQpXSA9IG47IGVsc2UgZm9yIChyIGluIHQpIGlbRihyKV0gPSB0W3JdOyByZXR1cm4gaSB9LCBnZXQ6IGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiB2b2lkIDAgPT09IHQgPyB0aGlzLmNhY2hlKGUpIDogZVt0aGlzLmV4cGFuZG9dICYmIGVbdGhpcy5leHBhbmRvXVtGKHQpXSB9LCBhY2Nlc3M6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHJldHVybiB2b2lkIDAgPT09IHQgfHwgdCAmJiAic3RyaW5nIiA9PSB0eXBlb2YgdCAmJiB2b2lkIDAgPT09IG4gPyB0aGlzLmdldChlLCB0KSA6ICh0aGlzLnNldChlLCB0LCBuKSwgdm9pZCAwICE9PSBuID8gbiA6IHQpIH0sIHJlbW92ZTogZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4sIHIgPSBlW3RoaXMuZXhwYW5kb107IGlmICh2b2lkIDAgIT09IHIpIHsgaWYgKHZvaWQgMCAhPT0gdCkgeyBuID0gKHQgPSBBcnJheS5pc0FycmF5KHQpID8gdC5tYXAoRikgOiAodCA9IEYodCkpIGluIHIgPyBbdF0gOiB0Lm1hdGNoKEQpIHx8IFtdKS5sZW5ndGg7IHdoaWxlIChuLS0pIGRlbGV0ZSByW3Rbbl1dIH0gKHZvaWQgMCA9PT0gdCB8fCBjZS5pc0VtcHR5T2JqZWN0KHIpKSAmJiAoZS5ub2RlVHlwZSA/IGVbdGhpcy5leHBhbmRvXSA9IHZvaWQgMCA6IGRlbGV0ZSBlW3RoaXMuZXhwYW5kb10pIH0gfSwgaGFzRGF0YTogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBlW3RoaXMuZXhwYW5kb107IHJldHVybiB2b2lkIDAgIT09IHQgJiYgIWNlLmlzRW1wdHlPYmplY3QodCkgfSB9OyB2YXIgXyA9IG5ldyBCLCB6ID0gbmV3IEIsIFggPSAvXig/Olx7W1x3XFddKlx9fFxbW1x3XFddKlxdKSQvLCBVID0gL1tBLVpdL2c7IGZ1bmN0aW9uIFYoZSwgdCwgbikgeyB2YXIgciwgaTsgaWYgKHZvaWQgMCA9PT0gbiAmJiAxID09PSBlLm5vZGVUeXBlKSBpZiAociA9ICJkYXRhLSIgKyB0LnJlcGxhY2UoVSwgIi0kJiIpLnRvTG93ZXJDYXNlKCksICJzdHJpbmciID09IHR5cGVvZiAobiA9IGUuZ2V0QXR0cmlidXRlKHIpKSkgeyB0cnkgeyBuID0gInRydWUiID09PSAoaSA9IG4pIHx8ICJmYWxzZSIgIT09IGkgJiYgKCJudWxsIiA9PT0gaSA/IG51bGwgOiBpID09PSAraSArICIiID8gK2kgOiBYLnRlc3QoaSkgPyBKU09OLnBhcnNlKGkpIDogaSkgfSBjYXRjaCAoZSkgeyB9IHouc2V0KGUsIHQsIG4pIH0gZWxzZSBuID0gdm9pZCAwOyByZXR1cm4gbiB9IGNlLmV4dGVuZCh7IGhhc0RhdGE6IGZ1bmN0aW9uIChlKSB7IHJldHVybiB6Lmhhc0RhdGEoZSkgfHwgXy5oYXNEYXRhKGUpIH0sIGRhdGE6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHJldHVybiB6LmFjY2VzcyhlLCB0LCBuKSB9LCByZW1vdmVEYXRhOiBmdW5jdGlvbiAoZSwgdCkgeyB6LnJlbW92ZShlLCB0KSB9LCBfZGF0YTogZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIF8uYWNjZXNzKGUsIHQsIG4pIH0sIF9yZW1vdmVEYXRhOiBmdW5jdGlvbiAoZSwgdCkgeyBfLnJlbW92ZShlLCB0KSB9IH0pLCBjZS5mbi5leHRlbmQoeyBkYXRhOiBmdW5jdGlvbiAobiwgZSkgeyB2YXIgdCwgciwgaSwgbyA9IHRoaXNbMF0sIGEgPSBvICYmIG8uYXR0cmlidXRlczsgaWYgKHZvaWQgMCA9PT0gbikgeyBpZiAodGhpcy5sZW5ndGggJiYgKGkgPSB6LmdldChvKSwgMSA9PT0gby5ub2RlVHlwZSAmJiAhXy5nZXQobywgImhhc0RhdGFBdHRycyIpKSkgeyB0ID0gYS5sZW5ndGg7IHdoaWxlICh0LS0pIGFbdF0gJiYgMCA9PT0gKHIgPSBhW3RdLm5hbWUpLmluZGV4T2YoImRhdGEtIikgJiYgKHIgPSBGKHIuc2xpY2UoNSkpLCBWKG8sIHIsIGlbcl0pKTsgXy5zZXQobywgImhhc0RhdGFBdHRycyIsICEwKSB9IHJldHVybiBpIH0gcmV0dXJuICJvYmplY3QiID09IHR5cGVvZiBuID8gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgei5zZXQodGhpcywgbikgfSkgOiBNKHRoaXMsIGZ1bmN0aW9uIChlKSB7IHZhciB0OyBpZiAobyAmJiB2b2lkIDAgPT09IGUpIHJldHVybiB2b2lkIDAgIT09ICh0ID0gei5nZXQobywgbikpID8gdCA6IHZvaWQgMCAhPT0gKHQgPSBWKG8sIG4pKSA/IHQgOiB2b2lkIDA7IHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IHouc2V0KHRoaXMsIG4sIGUpIH0pIH0sIG51bGwsIGUsIDEgPCBhcmd1bWVudHMubGVuZ3RoLCBudWxsLCAhMCkgfSwgcmVtb3ZlRGF0YTogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IHoucmVtb3ZlKHRoaXMsIGUpIH0pIH0gfSksIGNlLmV4dGVuZCh7IHF1ZXVlOiBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgcjsgaWYgKGUpIHJldHVybiB0ID0gKHQgfHwgImZ4IikgKyAicXVldWUiLCByID0gXy5nZXQoZSwgdCksIG4gJiYgKCFyIHx8IEFycmF5LmlzQXJyYXkobikgPyByID0gXy5hY2Nlc3MoZSwgdCwgY2UubWFrZUFycmF5KG4pKSA6IHIucHVzaChuKSksIHIgfHwgW10gfSwgZGVxdWV1ZTogZnVuY3Rpb24gKGUsIHQpIHsgdCA9IHQgfHwgImZ4IjsgdmFyIG4gPSBjZS5xdWV1ZShlLCB0KSwgciA9IG4ubGVuZ3RoLCBpID0gbi5zaGlmdCgpLCBvID0gY2UuX3F1ZXVlSG9va3MoZSwgdCk7ICJpbnByb2dyZXNzIiA9PT0gaSAmJiAoaSA9IG4uc2hpZnQoKSwgci0tKSwgaSAmJiAoImZ4IiA9PT0gdCAmJiBuLnVuc2hpZnQoImlucHJvZ3Jlc3MiKSwgZGVsZXRlIG8uc3RvcCwgaS5jYWxsKGUsIGZ1bmN0aW9uICgpIHsgY2UuZGVxdWV1ZShlLCB0KSB9LCBvKSksICFyICYmIG8gJiYgby5lbXB0eS5maXJlKCkgfSwgX3F1ZXVlSG9va3M6IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuID0gdCArICJxdWV1ZUhvb2tzIjsgcmV0dXJuIF8uZ2V0KGUsIG4pIHx8IF8uYWNjZXNzKGUsIG4sIHsgZW1wdHk6IGNlLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKS5hZGQoZnVuY3Rpb24gKCkgeyBfLnJlbW92ZShlLCBbdCArICJxdWV1ZSIsIG5dKSB9KSB9KSB9IH0pLCBjZS5mbi5leHRlbmQoeyBxdWV1ZTogZnVuY3Rpb24gKHQsIG4pIHsgdmFyIGUgPSAyOyByZXR1cm4gInN0cmluZyIgIT0gdHlwZW9mIHQgJiYgKG4gPSB0LCB0ID0gImZ4IiwgZS0tKSwgYXJndW1lbnRzLmxlbmd0aCA8IGUgPyBjZS5xdWV1ZSh0aGlzWzBdLCB0KSA6IHZvaWQgMCA9PT0gbiA/IHRoaXMgOiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyB2YXIgZSA9IGNlLnF1ZXVlKHRoaXMsIHQsIG4pOyBjZS5fcXVldWVIb29rcyh0aGlzLCB0KSwgImZ4IiA9PT0gdCAmJiAiaW5wcm9ncmVzcyIgIT09IGVbMF0gJiYgY2UuZGVxdWV1ZSh0aGlzLCB0KSB9KSB9LCBkZXF1ZXVlOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgY2UuZGVxdWV1ZSh0aGlzLCBlKSB9KSB9LCBjbGVhclF1ZXVlOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gdGhpcy5xdWV1ZShlIHx8ICJmeCIsIFtdKSB9LCBwcm9taXNlOiBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiwgciA9IDEsIGkgPSBjZS5EZWZlcnJlZCgpLCBvID0gdGhpcywgYSA9IHRoaXMubGVuZ3RoLCBzID0gZnVuY3Rpb24gKCkgeyAtLXIgfHwgaS5yZXNvbHZlV2l0aChvLCBbb10pIH07ICJzdHJpbmciICE9IHR5cGVvZiBlICYmICh0ID0gZSwgZSA9IHZvaWQgMCksIGUgPSBlIHx8ICJmeCI7IHdoaWxlIChhLS0pIChuID0gXy5nZXQob1thXSwgZSArICJxdWV1ZUhvb2tzIikpICYmIG4uZW1wdHkgJiYgKHIrKywgbi5lbXB0eS5hZGQocykpOyByZXR1cm4gcygpLCBpLnByb21pc2UodCkgfSB9KTsgdmFyIEcgPSAvWystXT8oPzpcZCpcLnwpXGQrKD86W2VFXVsrLV0/XGQrfCkvLnNvdXJjZSwgWSA9IG5ldyBSZWdFeHAoIl4oPzooWystXSk9fCkoIiArIEcgKyAiKShbYS16JV0qKSQiLCAiaSIpLCBRID0gWyJUb3AiLCAiUmlnaHQiLCAiQm90dG9tIiwgIkxlZnQiXSwgSiA9IEMuZG9jdW1lbnRFbGVtZW50LCBLID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGNlLmNvbnRhaW5zKGUub3duZXJEb2N1bWVudCwgZSkgfSwgWiA9IHsgY29tcG9zZWQ6ICEwIH07IEouZ2V0Um9vdE5vZGUgJiYgKEsgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gY2UuY29udGFpbnMoZS5vd25lckRvY3VtZW50LCBlKSB8fCBlLmdldFJvb3ROb2RlKFopID09PSBlLm93bmVyRG9jdW1lbnQgfSk7IHZhciBlZSA9IGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiAibm9uZSIgPT09IChlID0gdCB8fCBlKS5zdHlsZS5kaXNwbGF5IHx8ICIiID09PSBlLnN0eWxlLmRpc3BsYXkgJiYgSyhlKSAmJiAibm9uZSIgPT09IGNlLmNzcyhlLCAiZGlzcGxheSIpIH07IGZ1bmN0aW9uIHRlKGUsIHQsIG4sIHIpIHsgdmFyIGksIG8sIGEgPSAyMCwgcyA9IHIgPyBmdW5jdGlvbiAoKSB7IHJldHVybiByLmN1cigpIH0gOiBmdW5jdGlvbiAoKSB7IHJldHVybiBjZS5jc3MoZSwgdCwgIiIpIH0sIHUgPSBzKCksIGwgPSBuICYmIG5bM10gfHwgKGNlLmNzc051bWJlclt0XSA/ICIiIDogInB4IiksIGMgPSBlLm5vZGVUeXBlICYmIChjZS5jc3NOdW1iZXJbdF0gfHwgInB4IiAhPT0gbCAmJiArdSkgJiYgWS5leGVjKGNlLmNzcyhlLCB0KSk7IGlmIChjICYmIGNbM10gIT09IGwpIHsgdSAvPSAyLCBsID0gbCB8fCBjWzNdLCBjID0gK3UgfHwgMTsgd2hpbGUgKGEtLSkgY2Uuc3R5bGUoZSwgdCwgYyArIGwpLCAoMSAtIG8pICogKDEgLSAobyA9IHMoKSAvIHUgfHwgLjUpKSA8PSAwICYmIChhID0gMCksIGMgLz0gbzsgYyAqPSAyLCBjZS5zdHlsZShlLCB0LCBjICsgbCksIG4gPSBuIHx8IFtdIH0gcmV0dXJuIG4gJiYgKGMgPSArYyB8fCArdSB8fCAwLCBpID0gblsxXSA/IGMgKyAoblsxXSArIDEpICogblsyXSA6ICtuWzJdLCByICYmIChyLnVuaXQgPSBsLCByLnN0YXJ0ID0gYywgci5lbmQgPSBpKSksIGkgfSB2YXIgbmUgPSB7fTsgZnVuY3Rpb24gcmUoZSwgdCkgeyBmb3IgKHZhciBuLCByLCBpLCBvLCBhLCBzLCB1LCBsID0gW10sIGMgPSAwLCBmID0gZS5sZW5ndGg7IGMgPCBmOyBjKyspKHIgPSBlW2NdKS5zdHlsZSAmJiAobiA9IHIuc3R5bGUuZGlzcGxheSwgdCA/ICgibm9uZSIgPT09IG4gJiYgKGxbY10gPSBfLmdldChyLCAiZGlzcGxheSIpIHx8IG51bGwsIGxbY10gfHwgKHIuc3R5bGUuZGlzcGxheSA9ICIiKSksICIiID09PSByLnN0eWxlLmRpc3BsYXkgJiYgZWUocikgJiYgKGxbY10gPSAodSA9IGEgPSBvID0gdm9pZCAwLCBhID0gKGkgPSByKS5vd25lckRvY3VtZW50LCBzID0gaS5ub2RlTmFtZSwgKHUgPSBuZVtzXSkgfHwgKG8gPSBhLmJvZHkuYXBwZW5kQ2hpbGQoYS5jcmVhdGVFbGVtZW50KHMpKSwgdSA9IGNlLmNzcyhvLCAiZGlzcGxheSIpLCBvLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobyksICJub25lIiA9PT0gdSAmJiAodSA9ICJibG9jayIpLCBuZVtzXSA9IHUpKSkpIDogIm5vbmUiICE9PSBuICYmIChsW2NdID0gIm5vbmUiLCBfLnNldChyLCAiZGlzcGxheSIsIG4pKSk7IGZvciAoYyA9IDA7IGMgPCBmOyBjKyspbnVsbCAhPSBsW2NdICYmIChlW2NdLnN0eWxlLmRpc3BsYXkgPSBsW2NdKTsgcmV0dXJuIGUgfSBjZS5mbi5leHRlbmQoeyBzaG93OiBmdW5jdGlvbiAoKSB7IHJldHVybiByZSh0aGlzLCAhMCkgfSwgaGlkZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gcmUodGhpcykgfSwgdG9nZ2xlOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gImJvb2xlYW4iID09IHR5cGVvZiBlID8gZSA/IHRoaXMuc2hvdygpIDogdGhpcy5oaWRlKCkgOiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyBlZSh0aGlzKSA/IGNlKHRoaXMpLnNob3coKSA6IGNlKHRoaXMpLmhpZGUoKSB9KSB9IH0pOyB2YXIgeGUsIGJlLCB3ZSA9IC9eKD86Y2hlY2tib3h8cmFkaW8pJC9pLCBUZSA9IC88KFthLXpdW15cL1wwPlx4MjBcdFxyXG5cZl0qKS9pLCBDZSA9IC9eJHxebW9kdWxlJHxcLyg/OmphdmF8ZWNtYSlzY3JpcHQvaTsgeGUgPSBDLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKS5hcHBlbmRDaGlsZChDLmNyZWF0ZUVsZW1lbnQoImRpdiIpKSwgKGJlID0gQy5jcmVhdGVFbGVtZW50KCJpbnB1dCIpKS5zZXRBdHRyaWJ1dGUoInR5cGUiLCAicmFkaW8iKSwgYmUuc2V0QXR0cmlidXRlKCJjaGVja2VkIiwgImNoZWNrZWQiKSwgYmUuc2V0QXR0cmlidXRlKCJuYW1lIiwgInQiKSwgeGUuYXBwZW5kQ2hpbGQoYmUpLCBsZS5jaGVja0Nsb25lID0geGUuY2xvbmVOb2RlKCEwKS5jbG9uZU5vZGUoITApLmxhc3RDaGlsZC5jaGVja2VkLCB4ZS5pbm5lckhUTUwgPSAiPHRleHRhcmVhPng8L3RleHRhcmVhPiIsIGxlLm5vQ2xvbmVDaGVja2VkID0gISF4ZS5jbG9uZU5vZGUoITApLmxhc3RDaGlsZC5kZWZhdWx0VmFsdWUsIHhlLmlubmVySFRNTCA9ICI8b3B0aW9uPjwvb3B0aW9uPiIsIGxlLm9wdGlvbiA9ICEheGUubGFzdENoaWxkOyB2YXIga2UgPSB7IHRoZWFkOiBbMSwgIjx0YWJsZT4iLCAiPC90YWJsZT4iXSwgY29sOiBbMiwgIjx0YWJsZT48Y29sZ3JvdXA+IiwgIjwvY29sZ3JvdXA+PC90YWJsZT4iXSwgdHI6IFsyLCAiPHRhYmxlPjx0Ym9keT4iLCAiPC90Ym9keT48L3RhYmxlPiJdLCB0ZDogWzMsICI8dGFibGU+PHRib2R5Pjx0cj4iLCAiPC90cj48L3Rib2R5PjwvdGFibGU+Il0sIF9kZWZhdWx0OiBbMCwgIiIsICIiXSB9OyBmdW5jdGlvbiBTZShlLCB0KSB7IHZhciBuOyByZXR1cm4gbiA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBlLmdldEVsZW1lbnRzQnlUYWdOYW1lID8gZS5nZXRFbGVtZW50c0J5VGFnTmFtZSh0IHx8ICIqIikgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgZS5xdWVyeVNlbGVjdG9yQWxsID8gZS5xdWVyeVNlbGVjdG9yQWxsKHQgfHwgIioiKSA6IFtdLCB2b2lkIDAgPT09IHQgfHwgdCAmJiBmZShlLCB0KSA/IGNlLm1lcmdlKFtlXSwgbikgOiBuIH0gZnVuY3Rpb24gRWUoZSwgdCkgeyBmb3IgKHZhciBuID0gMCwgciA9IGUubGVuZ3RoOyBuIDwgcjsgbisrKV8uc2V0KGVbbl0sICJnbG9iYWxFdmFsIiwgIXQgfHwgXy5nZXQodFtuXSwgImdsb2JhbEV2YWwiKSkgfSBrZS50Ym9keSA9IGtlLnRmb290ID0ga2UuY29sZ3JvdXAgPSBrZS5jYXB0aW9uID0ga2UudGhlYWQsIGtlLnRoID0ga2UudGQsIGxlLm9wdGlvbiB8fCAoa2Uub3B0Z3JvdXAgPSBrZS5vcHRpb24gPSBbMSwgIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz4iLCAiPC9zZWxlY3Q+Il0pOyB2YXIgamUgPSAvPHwmIz9cdys7LzsgZnVuY3Rpb24gQWUoZSwgdCwgbiwgciwgaSkgeyBmb3IgKHZhciBvLCBhLCBzLCB1LCBsLCBjLCBmID0gdC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksIHAgPSBbXSwgZCA9IDAsIGggPSBlLmxlbmd0aDsgZCA8IGg7IGQrKylpZiAoKG8gPSBlW2RdKSB8fCAwID09PSBvKSBpZiAoIm9iamVjdCIgPT09IHgobykpIGNlLm1lcmdlKHAsIG8ubm9kZVR5cGUgPyBbb10gOiBvKTsgZWxzZSBpZiAoamUudGVzdChvKSkgeyBhID0gYSB8fCBmLmFwcGVuZENoaWxkKHQuY3JlYXRlRWxlbWVudCgiZGl2IikpLCBzID0gKFRlLmV4ZWMobykgfHwgWyIiLCAiIl0pWzFdLnRvTG93ZXJDYXNlKCksIHUgPSBrZVtzXSB8fCBrZS5fZGVmYXVsdCwgYS5pbm5lckhUTUwgPSB1WzFdICsgY2UuaHRtbFByZWZpbHRlcihvKSArIHVbMl0sIGMgPSB1WzBdOyB3aGlsZSAoYy0tKSBhID0gYS5sYXN0Q2hpbGQ7IGNlLm1lcmdlKHAsIGEuY2hpbGROb2RlcyksIChhID0gZi5maXJzdENoaWxkKS50ZXh0Q29udGVudCA9ICIiIH0gZWxzZSBwLnB1c2godC5jcmVhdGVUZXh0Tm9kZShvKSk7IGYudGV4dENvbnRlbnQgPSAiIiwgZCA9IDA7IHdoaWxlIChvID0gcFtkKytdKSBpZiAociAmJiAtMSA8IGNlLmluQXJyYXkobywgcikpIGkgJiYgaS5wdXNoKG8pOyBlbHNlIGlmIChsID0gSyhvKSwgYSA9IFNlKGYuYXBwZW5kQ2hpbGQobyksICJzY3JpcHQiKSwgbCAmJiBFZShhKSwgbikgeyBjID0gMDsgd2hpbGUgKG8gPSBhW2MrK10pIENlLnRlc3Qoby50eXBlIHx8ICIiKSAmJiBuLnB1c2gobykgfSByZXR1cm4gZiB9IHZhciBEZSA9IC9eKFteLl0qKSg/OlwuKC4rKXwpLzsgZnVuY3Rpb24gTmUoKSB7IHJldHVybiAhMCB9IGZ1bmN0aW9uIHFlKCkgeyByZXR1cm4gITEgfSBmdW5jdGlvbiBMZShlLCB0LCBuLCByLCBpLCBvKSB7IHZhciBhLCBzOyBpZiAoIm9iamVjdCIgPT0gdHlwZW9mIHQpIHsgZm9yIChzIGluICJzdHJpbmciICE9IHR5cGVvZiBuICYmIChyID0gciB8fCBuLCBuID0gdm9pZCAwKSwgdCkgTGUoZSwgcywgbiwgciwgdFtzXSwgbyk7IHJldHVybiBlIH0gaWYgKG51bGwgPT0gciAmJiBudWxsID09IGkgPyAoaSA9IG4sIHIgPSBuID0gdm9pZCAwKSA6IG51bGwgPT0gaSAmJiAoInN0cmluZyIgPT0gdHlwZW9mIG4gPyAoaSA9IHIsIHIgPSB2b2lkIDApIDogKGkgPSByLCByID0gbiwgbiA9IHZvaWQgMCkpLCAhMSA9PT0gaSkgaSA9IHFlOyBlbHNlIGlmICghaSkgcmV0dXJuIGU7IHJldHVybiAxID09PSBvICYmIChhID0gaSwgKGkgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gY2UoKS5vZmYoZSksIGEuYXBwbHkodGhpcywgYXJndW1lbnRzKSB9KS5ndWlkID0gYS5ndWlkIHx8IChhLmd1aWQgPSBjZS5ndWlkKyspKSwgZS5lYWNoKGZ1bmN0aW9uICgpIHsgY2UuZXZlbnQuYWRkKHRoaXMsIHQsIGksIHIsIG4pIH0pIH0gZnVuY3Rpb24gSGUoZSwgciwgdCkgeyB0ID8gKF8uc2V0KGUsIHIsICExKSwgY2UuZXZlbnQuYWRkKGUsIHIsIHsgbmFtZXNwYWNlOiAhMSwgaGFuZGxlcjogZnVuY3Rpb24gKGUpIHsgdmFyIHQsIG4gPSBfLmdldCh0aGlzLCByKTsgaWYgKDEgJiBlLmlzVHJpZ2dlciAmJiB0aGlzW3JdKSB7IGlmIChuKSAoY2UuZXZlbnQuc3BlY2lhbFtyXSB8fCB7fSkuZGVsZWdhdGVUeXBlICYmIGUuc3RvcFByb3BhZ2F0aW9uKCk7IGVsc2UgaWYgKG4gPSBhZS5jYWxsKGFyZ3VtZW50cyksIF8uc2V0KHRoaXMsIHIsIG4pLCB0aGlzW3JdKCksIHQgPSBfLmdldCh0aGlzLCByKSwgXy5zZXQodGhpcywgciwgITEpLCBuICE9PSB0KSByZXR1cm4gZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSwgZS5wcmV2ZW50RGVmYXVsdCgpLCB0IH0gZWxzZSBuICYmIChfLnNldCh0aGlzLCByLCBjZS5ldmVudC50cmlnZ2VyKG5bMF0sIG4uc2xpY2UoMSksIHRoaXMpKSwgZS5zdG9wUHJvcGFnYXRpb24oKSwgZS5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9IE5lKSB9IH0pKSA6IHZvaWQgMCA9PT0gXy5nZXQoZSwgcikgJiYgY2UuZXZlbnQuYWRkKGUsIHIsIE5lKSB9IGNlLmV2ZW50ID0geyBnbG9iYWw6IHt9LCBhZGQ6IGZ1bmN0aW9uICh0LCBlLCBuLCByLCBpKSB7IHZhciBvLCBhLCBzLCB1LCBsLCBjLCBmLCBwLCBkLCBoLCBnLCB2ID0gXy5nZXQodCk7IGlmICgkKHQpKSB7IG4uaGFuZGxlciAmJiAobiA9IChvID0gbikuaGFuZGxlciwgaSA9IG8uc2VsZWN0b3IpLCBpICYmIGNlLmZpbmQubWF0Y2hlc1NlbGVjdG9yKEosIGkpLCBuLmd1aWQgfHwgKG4uZ3VpZCA9IGNlLmd1aWQrKyksICh1ID0gdi5ldmVudHMpIHx8ICh1ID0gdi5ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpKSwgKGEgPSB2LmhhbmRsZSkgfHwgKGEgPSB2LmhhbmRsZSA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgY2UgJiYgY2UuZXZlbnQudHJpZ2dlcmVkICE9PSBlLnR5cGUgPyBjZS5ldmVudC5kaXNwYXRjaC5hcHBseSh0LCBhcmd1bWVudHMpIDogdm9pZCAwIH0pLCBsID0gKGUgPSAoZSB8fCAiIikubWF0Y2goRCkgfHwgWyIiXSkubGVuZ3RoOyB3aGlsZSAobC0tKSBkID0gZyA9IChzID0gRGUuZXhlYyhlW2xdKSB8fCBbXSlbMV0sIGggPSAoc1syXSB8fCAiIikuc3BsaXQoIi4iKS5zb3J0KCksIGQgJiYgKGYgPSBjZS5ldmVudC5zcGVjaWFsW2RdIHx8IHt9LCBkID0gKGkgPyBmLmRlbGVnYXRlVHlwZSA6IGYuYmluZFR5cGUpIHx8IGQsIGYgPSBjZS5ldmVudC5zcGVjaWFsW2RdIHx8IHt9LCBjID0gY2UuZXh0ZW5kKHsgdHlwZTogZCwgb3JpZ1R5cGU6IGcsIGRhdGE6IHIsIGhhbmRsZXI6IG4sIGd1aWQ6IG4uZ3VpZCwgc2VsZWN0b3I6IGksIG5lZWRzQ29udGV4dDogaSAmJiBjZS5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KGkpLCBuYW1lc3BhY2U6IGguam9pbigiLiIpIH0sIG8pLCAocCA9IHVbZF0pIHx8ICgocCA9IHVbZF0gPSBbXSkuZGVsZWdhdGVDb3VudCA9IDAsIGYuc2V0dXAgJiYgITEgIT09IGYuc2V0dXAuY2FsbCh0LCByLCBoLCBhKSB8fCB0LmFkZEV2ZW50TGlzdGVuZXIgJiYgdC5hZGRFdmVudExpc3RlbmVyKGQsIGEpKSwgZi5hZGQgJiYgKGYuYWRkLmNhbGwodCwgYyksIGMuaGFuZGxlci5ndWlkIHx8IChjLmhhbmRsZXIuZ3VpZCA9IG4uZ3VpZCkpLCBpID8gcC5zcGxpY2UocC5kZWxlZ2F0ZUNvdW50KyssIDAsIGMpIDogcC5wdXNoKGMpLCBjZS5ldmVudC5nbG9iYWxbZF0gPSAhMCkgfSB9LCByZW1vdmU6IGZ1bmN0aW9uIChlLCB0LCBuLCByLCBpKSB7IHZhciBvLCBhLCBzLCB1LCBsLCBjLCBmLCBwLCBkLCBoLCBnLCB2ID0gXy5oYXNEYXRhKGUpICYmIF8uZ2V0KGUpOyBpZiAodiAmJiAodSA9IHYuZXZlbnRzKSkgeyBsID0gKHQgPSAodCB8fCAiIikubWF0Y2goRCkgfHwgWyIiXSkubGVuZ3RoOyB3aGlsZSAobC0tKSBpZiAoZCA9IGcgPSAocyA9IERlLmV4ZWModFtsXSkgfHwgW10pWzFdLCBoID0gKHNbMl0gfHwgIiIpLnNwbGl0KCIuIikuc29ydCgpLCBkKSB7IGYgPSBjZS5ldmVudC5zcGVjaWFsW2RdIHx8IHt9LCBwID0gdVtkID0gKHIgPyBmLmRlbGVnYXRlVHlwZSA6IGYuYmluZFR5cGUpIHx8IGRdIHx8IFtdLCBzID0gc1syXSAmJiBuZXcgUmVnRXhwKCIoXnxcXC4pIiArIGguam9pbigiXFwuKD86LipcXC58KSIpICsgIihcXC58JCkiKSwgYSA9IG8gPSBwLmxlbmd0aDsgd2hpbGUgKG8tLSkgYyA9IHBbb10sICFpICYmIGcgIT09IGMub3JpZ1R5cGUgfHwgbiAmJiBuLmd1aWQgIT09IGMuZ3VpZCB8fCBzICYmICFzLnRlc3QoYy5uYW1lc3BhY2UpIHx8IHIgJiYgciAhPT0gYy5zZWxlY3RvciAmJiAoIioqIiAhPT0gciB8fCAhYy5zZWxlY3RvcikgfHwgKHAuc3BsaWNlKG8sIDEpLCBjLnNlbGVjdG9yICYmIHAuZGVsZWdhdGVDb3VudC0tLCBmLnJlbW92ZSAmJiBmLnJlbW92ZS5jYWxsKGUsIGMpKTsgYSAmJiAhcC5sZW5ndGggJiYgKGYudGVhcmRvd24gJiYgITEgIT09IGYudGVhcmRvd24uY2FsbChlLCBoLCB2LmhhbmRsZSkgfHwgY2UucmVtb3ZlRXZlbnQoZSwgZCwgdi5oYW5kbGUpLCBkZWxldGUgdVtkXSkgfSBlbHNlIGZvciAoZCBpbiB1KSBjZS5ldmVudC5yZW1vdmUoZSwgZCArIHRbbF0sIG4sIHIsICEwKTsgY2UuaXNFbXB0eU9iamVjdCh1KSAmJiBfLnJlbW92ZShlLCAiaGFuZGxlIGV2ZW50cyIpIH0gfSwgZGlzcGF0Y2g6IGZ1bmN0aW9uIChlKSB7IHZhciB0LCBuLCByLCBpLCBvLCBhLCBzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpLCB1ID0gY2UuZXZlbnQuZml4KGUpLCBsID0gKF8uZ2V0KHRoaXMsICJldmVudHMiKSB8fCBPYmplY3QuY3JlYXRlKG51bGwpKVt1LnR5cGVdIHx8IFtdLCBjID0gY2UuZXZlbnQuc3BlY2lhbFt1LnR5cGVdIHx8IHt9OyBmb3IgKHNbMF0gPSB1LCB0ID0gMTsgdCA8IGFyZ3VtZW50cy5sZW5ndGg7IHQrKylzW3RdID0gYXJndW1lbnRzW3RdOyBpZiAodS5kZWxlZ2F0ZVRhcmdldCA9IHRoaXMsICFjLnByZURpc3BhdGNoIHx8ICExICE9PSBjLnByZURpc3BhdGNoLmNhbGwodGhpcywgdSkpIHsgYSA9IGNlLmV2ZW50LmhhbmRsZXJzLmNhbGwodGhpcywgdSwgbCksIHQgPSAwOyB3aGlsZSAoKGkgPSBhW3QrK10pICYmICF1LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpIHsgdS5jdXJyZW50VGFyZ2V0ID0gaS5lbGVtLCBuID0gMDsgd2hpbGUgKChvID0gaS5oYW5kbGVyc1tuKytdKSAmJiAhdS5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpKSB1LnJuYW1lc3BhY2UgJiYgITEgIT09IG8ubmFtZXNwYWNlICYmICF1LnJuYW1lc3BhY2UudGVzdChvLm5hbWVzcGFjZSkgfHwgKHUuaGFuZGxlT2JqID0gbywgdS5kYXRhID0gby5kYXRhLCB2b2lkIDAgIT09IChyID0gKChjZS5ldmVudC5zcGVjaWFsW28ub3JpZ1R5cGVdIHx8IHt9KS5oYW5kbGUgfHwgby5oYW5kbGVyKS5hcHBseShpLmVsZW0sIHMpKSAmJiAhMSA9PT0gKHUucmVzdWx0ID0gcikgJiYgKHUucHJldmVudERlZmF1bHQoKSwgdS5zdG9wUHJvcGFnYXRpb24oKSkpIH0gcmV0dXJuIGMucG9zdERpc3BhdGNoICYmIGMucG9zdERpc3BhdGNoLmNhbGwodGhpcywgdSksIHUucmVzdWx0IH0gfSwgaGFuZGxlcnM6IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuLCByLCBpLCBvLCBhLCBzID0gW10sIHUgPSB0LmRlbGVnYXRlQ291bnQsIGwgPSBlLnRhcmdldDsgaWYgKHUgJiYgbC5ub2RlVHlwZSAmJiAhKCJjbGljayIgPT09IGUudHlwZSAmJiAxIDw9IGUuYnV0dG9uKSkgZm9yICg7IGwgIT09IHRoaXM7IGwgPSBsLnBhcmVudE5vZGUgfHwgdGhpcylpZiAoMSA9PT0gbC5ub2RlVHlwZSAmJiAoImNsaWNrIiAhPT0gZS50eXBlIHx8ICEwICE9PSBsLmRpc2FibGVkKSkgeyBmb3IgKG8gPSBbXSwgYSA9IHt9LCBuID0gMDsgbiA8IHU7IG4rKyl2b2lkIDAgPT09IGFbaSA9IChyID0gdFtuXSkuc2VsZWN0b3IgKyAiICJdICYmIChhW2ldID0gci5uZWVkc0NvbnRleHQgPyAtMSA8IGNlKGksIHRoaXMpLmluZGV4KGwpIDogY2UuZmluZChpLCB0aGlzLCBudWxsLCBbbF0pLmxlbmd0aCksIGFbaV0gJiYgby5wdXNoKHIpOyBvLmxlbmd0aCAmJiBzLnB1c2goeyBlbGVtOiBsLCBoYW5kbGVyczogbyB9KSB9IHJldHVybiBsID0gdGhpcywgdSA8IHQubGVuZ3RoICYmIHMucHVzaCh7IGVsZW06IGwsIGhhbmRsZXJzOiB0LnNsaWNlKHUpIH0pLCBzIH0sIGFkZFByb3A6IGZ1bmN0aW9uICh0LCBlKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjZS5FdmVudC5wcm90b3R5cGUsIHQsIHsgZW51bWVyYWJsZTogITAsIGNvbmZpZ3VyYWJsZTogITAsIGdldDogdihlKSA/IGZ1bmN0aW9uICgpIHsgaWYgKHRoaXMub3JpZ2luYWxFdmVudCkgcmV0dXJuIGUodGhpcy5vcmlnaW5hbEV2ZW50KSB9IDogZnVuY3Rpb24gKCkgeyBpZiAodGhpcy5vcmlnaW5hbEV2ZW50KSByZXR1cm4gdGhpcy5vcmlnaW5hbEV2ZW50W3RdIH0sIHNldDogZnVuY3Rpb24gKGUpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIHQsIHsgZW51bWVyYWJsZTogITAsIGNvbmZpZ3VyYWJsZTogITAsIHdyaXRhYmxlOiAhMCwgdmFsdWU6IGUgfSkgfSB9KSB9LCBmaXg6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBlW2NlLmV4cGFuZG9dID8gZSA6IG5ldyBjZS5FdmVudChlKSB9LCBzcGVjaWFsOiB7IGxvYWQ6IHsgbm9CdWJibGU6ICEwIH0sIGNsaWNrOiB7IHNldHVwOiBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IHRoaXMgfHwgZTsgcmV0dXJuIHdlLnRlc3QodC50eXBlKSAmJiB0LmNsaWNrICYmIGZlKHQsICJpbnB1dCIpICYmIEhlKHQsICJjbGljayIsICEwKSwgITEgfSwgdHJpZ2dlcjogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSB0aGlzIHx8IGU7IHJldHVybiB3ZS50ZXN0KHQudHlwZSkgJiYgdC5jbGljayAmJiBmZSh0LCAiaW5wdXQiKSAmJiBIZSh0LCAiY2xpY2siKSwgITAgfSwgX2RlZmF1bHQ6IGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gZS50YXJnZXQ7IHJldHVybiB3ZS50ZXN0KHQudHlwZSkgJiYgdC5jbGljayAmJiBmZSh0LCAiaW5wdXQiKSAmJiBfLmdldCh0LCAiY2xpY2siKSB8fCBmZSh0LCAiYSIpIH0gfSwgYmVmb3JldW5sb2FkOiB7IHBvc3REaXNwYXRjaDogZnVuY3Rpb24gKGUpIHsgdm9pZCAwICE9PSBlLnJlc3VsdCAmJiBlLm9yaWdpbmFsRXZlbnQgJiYgKGUub3JpZ2luYWxFdmVudC5yZXR1cm5WYWx1ZSA9IGUucmVzdWx0KSB9IH0gfSB9LCBjZS5yZW1vdmVFdmVudCA9IGZ1bmN0aW9uIChlLCB0LCBuKSB7IGUucmVtb3ZlRXZlbnRMaXN0ZW5lciAmJiBlLnJlbW92ZUV2ZW50TGlzdGVuZXIodCwgbikgfSwgY2UuRXZlbnQgPSBmdW5jdGlvbiAoZSwgdCkgeyBpZiAoISh0aGlzIGluc3RhbmNlb2YgY2UuRXZlbnQpKSByZXR1cm4gbmV3IGNlLkV2ZW50KGUsIHQpOyBlICYmIGUudHlwZSA/ICh0aGlzLm9yaWdpbmFsRXZlbnQgPSBlLCB0aGlzLnR5cGUgPSBlLnR5cGUsIHRoaXMuaXNEZWZhdWx0UHJldmVudGVkID0gZS5kZWZhdWx0UHJldmVudGVkIHx8IHZvaWQgMCA9PT0gZS5kZWZhdWx0UHJldmVudGVkICYmICExID09PSBlLnJldHVyblZhbHVlID8gTmUgOiBxZSwgdGhpcy50YXJnZXQgPSBlLnRhcmdldCAmJiAzID09PSBlLnRhcmdldC5ub2RlVHlwZSA/IGUudGFyZ2V0LnBhcmVudE5vZGUgOiBlLnRhcmdldCwgdGhpcy5jdXJyZW50VGFyZ2V0ID0gZS5jdXJyZW50VGFyZ2V0LCB0aGlzLnJlbGF0ZWRUYXJnZXQgPSBlLnJlbGF0ZWRUYXJnZXQpIDogdGhpcy50eXBlID0gZSwgdCAmJiBjZS5leHRlbmQodGhpcywgdCksIHRoaXMudGltZVN0YW1wID0gZSAmJiBlLnRpbWVTdGFtcCB8fCBEYXRlLm5vdygpLCB0aGlzW2NlLmV4cGFuZG9dID0gITAgfSwgY2UuRXZlbnQucHJvdG90eXBlID0geyBjb25zdHJ1Y3RvcjogY2UuRXZlbnQsIGlzRGVmYXVsdFByZXZlbnRlZDogcWUsIGlzUHJvcGFnYXRpb25TdG9wcGVkOiBxZSwgaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6IHFlLCBpc1NpbXVsYXRlZDogITEsIHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbiAoKSB7IHZhciBlID0gdGhpcy5vcmlnaW5hbEV2ZW50OyB0aGlzLmlzRGVmYXVsdFByZXZlbnRlZCA9IE5lLCBlICYmICF0aGlzLmlzU2ltdWxhdGVkICYmIGUucHJldmVudERlZmF1bHQoKSB9LCBzdG9wUHJvcGFnYXRpb246IGZ1bmN0aW9uICgpIHsgdmFyIGUgPSB0aGlzLm9yaWdpbmFsRXZlbnQ7IHRoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQgPSBOZSwgZSAmJiAhdGhpcy5pc1NpbXVsYXRlZCAmJiBlLnN0b3BQcm9wYWdhdGlvbigpIH0sIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjogZnVuY3Rpb24gKCkgeyB2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsgdGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9IE5lLCBlICYmICF0aGlzLmlzU2ltdWxhdGVkICYmIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksIHRoaXMuc3RvcFByb3BhZ2F0aW9uKCkgfSB9LCBjZS5lYWNoKHsgYWx0S2V5OiAhMCwgYnViYmxlczogITAsIGNhbmNlbGFibGU6ICEwLCBjaGFuZ2VkVG91Y2hlczogITAsIGN0cmxLZXk6ICEwLCBkZXRhaWw6ICEwLCBldmVudFBoYXNlOiAhMCwgbWV0YUtleTogITAsIHBhZ2VYOiAhMCwgcGFnZVk6ICEwLCBzaGlmdEtleTogITAsIHZpZXc6ICEwLCAiY2hhciI6ICEwLCBjb2RlOiAhMCwgY2hhckNvZGU6ICEwLCBrZXk6ICEwLCBrZXlDb2RlOiAhMCwgYnV0dG9uOiAhMCwgYnV0dG9uczogITAsIGNsaWVudFg6ICEwLCBjbGllbnRZOiAhMCwgb2Zmc2V0WDogITAsIG9mZnNldFk6ICEwLCBwb2ludGVySWQ6ICEwLCBwb2ludGVyVHlwZTogITAsIHNjcmVlblg6ICEwLCBzY3JlZW5ZOiAhMCwgdGFyZ2V0VG91Y2hlczogITAsIHRvRWxlbWVudDogITAsIHRvdWNoZXM6ICEwLCB3aGljaDogITAgfSwgY2UuZXZlbnQuYWRkUHJvcCksIGNlLmVhY2goeyBmb2N1czogImZvY3VzaW4iLCBibHVyOiAiZm9jdXNvdXQiIH0sIGZ1bmN0aW9uIChyLCBpKSB7IGZ1bmN0aW9uIG8oZSkgeyBpZiAoQy5kb2N1bWVudE1vZGUpIHsgdmFyIHQgPSBfLmdldCh0aGlzLCAiaGFuZGxlIiksIG4gPSBjZS5ldmVudC5maXgoZSk7IG4udHlwZSA9ICJmb2N1c2luIiA9PT0gZS50eXBlID8gImZvY3VzIiA6ICJibHVyIiwgbi5pc1NpbXVsYXRlZCA9ICEwLCB0KGUpLCBuLnRhcmdldCA9PT0gbi5jdXJyZW50VGFyZ2V0ICYmIHQobikgfSBlbHNlIGNlLmV2ZW50LnNpbXVsYXRlKGksIGUudGFyZ2V0LCBjZS5ldmVudC5maXgoZSkpIH0gY2UuZXZlbnQuc3BlY2lhbFtyXSA9IHsgc2V0dXA6IGZ1bmN0aW9uICgpIHsgdmFyIGU7IGlmIChIZSh0aGlzLCByLCAhMCksICFDLmRvY3VtZW50TW9kZSkgcmV0dXJuICExOyAoZSA9IF8uZ2V0KHRoaXMsIGkpKSB8fCB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoaSwgbyksIF8uc2V0KHRoaXMsIGksIChlIHx8IDApICsgMSkgfSwgdHJpZ2dlcjogZnVuY3Rpb24gKCkgeyByZXR1cm4gSGUodGhpcywgciksICEwIH0sIHRlYXJkb3duOiBmdW5jdGlvbiAoKSB7IHZhciBlOyBpZiAoIUMuZG9jdW1lbnRNb2RlKSByZXR1cm4gITE7IChlID0gXy5nZXQodGhpcywgaSkgLSAxKSA/IF8uc2V0KHRoaXMsIGksIGUpIDogKHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihpLCBvKSwgXy5yZW1vdmUodGhpcywgaSkpIH0sIF9kZWZhdWx0OiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gXy5nZXQoZS50YXJnZXQsIHIpIH0sIGRlbGVnYXRlVHlwZTogaSB9LCBjZS5ldmVudC5zcGVjaWFsW2ldID0geyBzZXR1cDogZnVuY3Rpb24gKCkgeyB2YXIgZSA9IHRoaXMub3duZXJEb2N1bWVudCB8fCB0aGlzLmRvY3VtZW50IHx8IHRoaXMsIHQgPSBDLmRvY3VtZW50TW9kZSA/IHRoaXMgOiBlLCBuID0gXy5nZXQodCwgaSk7IG4gfHwgKEMuZG9jdW1lbnRNb2RlID8gdGhpcy5hZGRFdmVudExpc3RlbmVyKGksIG8pIDogZS5hZGRFdmVudExpc3RlbmVyKHIsIG8sICEwKSksIF8uc2V0KHQsIGksIChuIHx8IDApICsgMSkgfSwgdGVhcmRvd246IGZ1bmN0aW9uICgpIHsgdmFyIGUgPSB0aGlzLm93bmVyRG9jdW1lbnQgfHwgdGhpcy5kb2N1bWVudCB8fCB0aGlzLCB0ID0gQy5kb2N1bWVudE1vZGUgPyB0aGlzIDogZSwgbiA9IF8uZ2V0KHQsIGkpIC0gMTsgbiA/IF8uc2V0KHQsIGksIG4pIDogKEMuZG9jdW1lbnRNb2RlID8gdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKGksIG8pIDogZS5yZW1vdmVFdmVudExpc3RlbmVyKHIsIG8sICEwKSwgXy5yZW1vdmUodCwgaSkpIH0gfSB9KSwgY2UuZWFjaCh7IG1vdXNlZW50ZXI6ICJtb3VzZW92ZXIiLCBtb3VzZWxlYXZlOiAibW91c2VvdXQiLCBwb2ludGVyZW50ZXI6ICJwb2ludGVyb3ZlciIsIHBvaW50ZXJsZWF2ZTogInBvaW50ZXJvdXQiIH0sIGZ1bmN0aW9uIChlLCBpKSB7IGNlLmV2ZW50LnNwZWNpYWxbZV0gPSB7IGRlbGVnYXRlVHlwZTogaSwgYmluZFR5cGU6IGksIGhhbmRsZTogZnVuY3Rpb24gKGUpIHsgdmFyIHQsIG4gPSBlLnJlbGF0ZWRUYXJnZXQsIHIgPSBlLmhhbmRsZU9iajsgcmV0dXJuIG4gJiYgKG4gPT09IHRoaXMgfHwgY2UuY29udGFpbnModGhpcywgbikpIHx8IChlLnR5cGUgPSByLm9yaWdUeXBlLCB0ID0gci5oYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIGUudHlwZSA9IGkpLCB0IH0gfSB9KSwgY2UuZm4uZXh0ZW5kKHsgb246IGZ1bmN0aW9uIChlLCB0LCBuLCByKSB7IHJldHVybiBMZSh0aGlzLCBlLCB0LCBuLCByKSB9LCBvbmU6IGZ1bmN0aW9uIChlLCB0LCBuLCByKSB7IHJldHVybiBMZSh0aGlzLCBlLCB0LCBuLCByLCAxKSB9LCBvZmY6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHZhciByLCBpOyBpZiAoZSAmJiBlLnByZXZlbnREZWZhdWx0ICYmIGUuaGFuZGxlT2JqKSByZXR1cm4gciA9IGUuaGFuZGxlT2JqLCBjZShlLmRlbGVnYXRlVGFyZ2V0KS5vZmYoci5uYW1lc3BhY2UgPyByLm9yaWdUeXBlICsgIi4iICsgci5uYW1lc3BhY2UgOiByLm9yaWdUeXBlLCByLnNlbGVjdG9yLCByLmhhbmRsZXIpLCB0aGlzOyBpZiAoIm9iamVjdCIgPT0gdHlwZW9mIGUpIHsgZm9yIChpIGluIGUpIHRoaXMub2ZmKGksIHQsIGVbaV0pOyByZXR1cm4gdGhpcyB9IHJldHVybiAhMSAhPT0gdCAmJiAiZnVuY3Rpb24iICE9IHR5cGVvZiB0IHx8IChuID0gdCwgdCA9IHZvaWQgMCksICExID09PSBuICYmIChuID0gcWUpLCB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyBjZS5ldmVudC5yZW1vdmUodGhpcywgZSwgbiwgdCkgfSkgfSB9KTsgdmFyIE9lID0gLzxzY3JpcHR8PHN0eWxlfDxsaW5rL2ksIFBlID0gL2NoZWNrZWRccyooPzpbXj1dfD1ccyouY2hlY2tlZC4pL2ksIE1lID0gL15ccyo8IVxbQ0RBVEFcW3xcXVxdPlxzKiQvZzsgZnVuY3Rpb24gUmUoZSwgdCkgeyByZXR1cm4gZmUoZSwgInRhYmxlIikgJiYgZmUoMTEgIT09IHQubm9kZVR5cGUgPyB0IDogdC5maXJzdENoaWxkLCAidHIiKSAmJiBjZShlKS5jaGlsZHJlbigidGJvZHkiKVswXSB8fCBlIH0gZnVuY3Rpb24gSWUoZSkgeyByZXR1cm4gZS50eXBlID0gKG51bGwgIT09IGUuZ2V0QXR0cmlidXRlKCJ0eXBlIikpICsgIi8iICsgZS50eXBlLCBlIH0gZnVuY3Rpb24gV2UoZSkgeyByZXR1cm4gInRydWUvIiA9PT0gKGUudHlwZSB8fCAiIikuc2xpY2UoMCwgNSkgPyBlLnR5cGUgPSBlLnR5cGUuc2xpY2UoNSkgOiBlLnJlbW92ZUF0dHJpYnV0ZSgidHlwZSIpLCBlIH0gZnVuY3Rpb24gRmUoZSwgdCkgeyB2YXIgbiwgciwgaSwgbywgYSwgczsgaWYgKDEgPT09IHQubm9kZVR5cGUpIHsgaWYgKF8uaGFzRGF0YShlKSAmJiAocyA9IF8uZ2V0KGUpLmV2ZW50cykpIGZvciAoaSBpbiBfLnJlbW92ZSh0LCAiaGFuZGxlIGV2ZW50cyIpLCBzKSBmb3IgKG4gPSAwLCByID0gc1tpXS5sZW5ndGg7IG4gPCByOyBuKyspY2UuZXZlbnQuYWRkKHQsIGksIHNbaV1bbl0pOyB6Lmhhc0RhdGEoZSkgJiYgKG8gPSB6LmFjY2VzcyhlKSwgYSA9IGNlLmV4dGVuZCh7fSwgbyksIHouc2V0KHQsIGEpKSB9IH0gZnVuY3Rpb24gJGUobiwgciwgaSwgbykgeyByID0gZyhyKTsgdmFyIGUsIHQsIGEsIHMsIHUsIGwsIGMgPSAwLCBmID0gbi5sZW5ndGgsIHAgPSBmIC0gMSwgZCA9IHJbMF0sIGggPSB2KGQpOyBpZiAoaCB8fCAxIDwgZiAmJiAic3RyaW5nIiA9PSB0eXBlb2YgZCAmJiAhbGUuY2hlY2tDbG9uZSAmJiBQZS50ZXN0KGQpKSByZXR1cm4gbi5lYWNoKGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gbi5lcShlKTsgaCAmJiAoclswXSA9IGQuY2FsbCh0aGlzLCBlLCB0Lmh0bWwoKSkpLCAkZSh0LCByLCBpLCBvKSB9KTsgaWYgKGYgJiYgKHQgPSAoZSA9IEFlKHIsIG5bMF0ub3duZXJEb2N1bWVudCwgITEsIG4sIG8pKS5maXJzdENoaWxkLCAxID09PSBlLmNoaWxkTm9kZXMubGVuZ3RoICYmIChlID0gdCksIHQgfHwgbykpIHsgZm9yIChzID0gKGEgPSBjZS5tYXAoU2UoZSwgInNjcmlwdCIpLCBJZSkpLmxlbmd0aDsgYyA8IGY7IGMrKyl1ID0gZSwgYyAhPT0gcCAmJiAodSA9IGNlLmNsb25lKHUsICEwLCAhMCksIHMgJiYgY2UubWVyZ2UoYSwgU2UodSwgInNjcmlwdCIpKSksIGkuY2FsbChuW2NdLCB1LCBjKTsgaWYgKHMpIGZvciAobCA9IGFbYS5sZW5ndGggLSAxXS5vd25lckRvY3VtZW50LCBjZS5tYXAoYSwgV2UpLCBjID0gMDsgYyA8IHM7IGMrKyl1ID0gYVtjXSwgQ2UudGVzdCh1LnR5cGUgfHwgIiIpICYmICFfLmFjY2Vzcyh1LCAiZ2xvYmFsRXZhbCIpICYmIGNlLmNvbnRhaW5zKGwsIHUpICYmICh1LnNyYyAmJiAibW9kdWxlIiAhPT0gKHUudHlwZSB8fCAiIikudG9Mb3dlckNhc2UoKSA/IGNlLl9ldmFsVXJsICYmICF1Lm5vTW9kdWxlICYmIGNlLl9ldmFsVXJsKHUuc3JjLCB7IG5vbmNlOiB1Lm5vbmNlIHx8IHUuZ2V0QXR0cmlidXRlKCJub25jZSIpIH0sIGwpIDogbSh1LnRleHRDb250ZW50LnJlcGxhY2UoTWUsICIiKSwgdSwgbCkpIH0gcmV0dXJuIG4gfSBmdW5jdGlvbiBCZShlLCB0LCBuKSB7IGZvciAodmFyIHIsIGkgPSB0ID8gY2UuZmlsdGVyKHQsIGUpIDogZSwgbyA9IDA7IG51bGwgIT0gKHIgPSBpW29dKTsgbysrKW4gfHwgMSAhPT0gci5ub2RlVHlwZSB8fCBjZS5jbGVhbkRhdGEoU2UocikpLCByLnBhcmVudE5vZGUgJiYgKG4gJiYgSyhyKSAmJiBFZShTZShyLCAic2NyaXB0IikpLCByLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocikpOyByZXR1cm4gZSB9IGNlLmV4dGVuZCh7IGh0bWxQcmVmaWx0ZXI6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBlIH0sIGNsb25lOiBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciwgaSwgbywgYSwgcywgdSwgbCwgYyA9IGUuY2xvbmVOb2RlKCEwKSwgZiA9IEsoZSk7IGlmICghKGxlLm5vQ2xvbmVDaGVja2VkIHx8IDEgIT09IGUubm9kZVR5cGUgJiYgMTEgIT09IGUubm9kZVR5cGUgfHwgY2UuaXNYTUxEb2MoZSkpKSBmb3IgKGEgPSBTZShjKSwgciA9IDAsIGkgPSAobyA9IFNlKGUpKS5sZW5ndGg7IHIgPCBpOyByKyspcyA9IG9bcl0sIHUgPSBhW3JdLCB2b2lkIDAsICJpbnB1dCIgPT09IChsID0gdS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKSAmJiB3ZS50ZXN0KHMudHlwZSkgPyB1LmNoZWNrZWQgPSBzLmNoZWNrZWQgOiAiaW5wdXQiICE9PSBsICYmICJ0ZXh0YXJlYSIgIT09IGwgfHwgKHUuZGVmYXVsdFZhbHVlID0gcy5kZWZhdWx0VmFsdWUpOyBpZiAodCkgaWYgKG4pIGZvciAobyA9IG8gfHwgU2UoZSksIGEgPSBhIHx8IFNlKGMpLCByID0gMCwgaSA9IG8ubGVuZ3RoOyByIDwgaTsgcisrKUZlKG9bcl0sIGFbcl0pOyBlbHNlIEZlKGUsIGMpOyByZXR1cm4gMCA8IChhID0gU2UoYywgInNjcmlwdCIpKS5sZW5ndGggJiYgRWUoYSwgIWYgJiYgU2UoZSwgInNjcmlwdCIpKSwgYyB9LCBjbGVhbkRhdGE6IGZ1bmN0aW9uIChlKSB7IGZvciAodmFyIHQsIG4sIHIsIGkgPSBjZS5ldmVudC5zcGVjaWFsLCBvID0gMDsgdm9pZCAwICE9PSAobiA9IGVbb10pOyBvKyspaWYgKCQobikpIHsgaWYgKHQgPSBuW18uZXhwYW5kb10pIHsgaWYgKHQuZXZlbnRzKSBmb3IgKHIgaW4gdC5ldmVudHMpIGlbcl0gPyBjZS5ldmVudC5yZW1vdmUobiwgcikgOiBjZS5yZW1vdmVFdmVudChuLCByLCB0LmhhbmRsZSk7IG5bXy5leHBhbmRvXSA9IHZvaWQgMCB9IG5bei5leHBhbmRvXSAmJiAoblt6LmV4cGFuZG9dID0gdm9pZCAwKSB9IH0gfSksIGNlLmZuLmV4dGVuZCh7IGRldGFjaDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIEJlKHRoaXMsIGUsICEwKSB9LCByZW1vdmU6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBCZSh0aGlzLCBlKSB9LCB0ZXh0OiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gTSh0aGlzLCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gdm9pZCAwID09PSBlID8gY2UudGV4dCh0aGlzKSA6IHRoaXMuZW1wdHkoKS5lYWNoKGZ1bmN0aW9uICgpIHsgMSAhPT0gdGhpcy5ub2RlVHlwZSAmJiAxMSAhPT0gdGhpcy5ub2RlVHlwZSAmJiA5ICE9PSB0aGlzLm5vZGVUeXBlIHx8ICh0aGlzLnRleHRDb250ZW50ID0gZSkgfSkgfSwgbnVsbCwgZSwgYXJndW1lbnRzLmxlbmd0aCkgfSwgYXBwZW5kOiBmdW5jdGlvbiAoKSB7IHJldHVybiAkZSh0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uIChlKSB7IDEgIT09IHRoaXMubm9kZVR5cGUgJiYgMTEgIT09IHRoaXMubm9kZVR5cGUgJiYgOSAhPT0gdGhpcy5ub2RlVHlwZSB8fCBSZSh0aGlzLCBlKS5hcHBlbmRDaGlsZChlKSB9KSB9LCBwcmVwZW5kOiBmdW5jdGlvbiAoKSB7IHJldHVybiAkZSh0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uIChlKSB7IGlmICgxID09PSB0aGlzLm5vZGVUeXBlIHx8IDExID09PSB0aGlzLm5vZGVUeXBlIHx8IDkgPT09IHRoaXMubm9kZVR5cGUpIHsgdmFyIHQgPSBSZSh0aGlzLCBlKTsgdC5pbnNlcnRCZWZvcmUoZSwgdC5maXJzdENoaWxkKSB9IH0pIH0sIGJlZm9yZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gJGUodGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiAoZSkgeyB0aGlzLnBhcmVudE5vZGUgJiYgdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLCB0aGlzKSB9KSB9LCBhZnRlcjogZnVuY3Rpb24gKCkgeyByZXR1cm4gJGUodGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiAoZSkgeyB0aGlzLnBhcmVudE5vZGUgJiYgdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLCB0aGlzLm5leHRTaWJsaW5nKSB9KSB9LCBlbXB0eTogZnVuY3Rpb24gKCkgeyBmb3IgKHZhciBlLCB0ID0gMDsgbnVsbCAhPSAoZSA9IHRoaXNbdF0pOyB0KyspMSA9PT0gZS5ub2RlVHlwZSAmJiAoY2UuY2xlYW5EYXRhKFNlKGUsICExKSksIGUudGV4dENvbnRlbnQgPSAiIik7IHJldHVybiB0aGlzIH0sIGNsb25lOiBmdW5jdGlvbiAoZSwgdCkgeyByZXR1cm4gZSA9IG51bGwgIT0gZSAmJiBlLCB0ID0gbnVsbCA9PSB0ID8gZSA6IHQsIHRoaXMubWFwKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNlLmNsb25lKHRoaXMsIGUsIHQpIH0pIH0sIGh0bWw6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBNKHRoaXMsIGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gdGhpc1swXSB8fCB7fSwgbiA9IDAsIHIgPSB0aGlzLmxlbmd0aDsgaWYgKHZvaWQgMCA9PT0gZSAmJiAxID09PSB0Lm5vZGVUeXBlKSByZXR1cm4gdC5pbm5lckhUTUw7IGlmICgic3RyaW5nIiA9PSB0eXBlb2YgZSAmJiAhT2UudGVzdChlKSAmJiAha2VbKFRlLmV4ZWMoZSkgfHwgWyIiLCAiIl0pWzFdLnRvTG93ZXJDYXNlKCldKSB7IGUgPSBjZS5odG1sUHJlZmlsdGVyKGUpOyB0cnkgeyBmb3IgKDsgbiA8IHI7IG4rKykxID09PSAodCA9IHRoaXNbbl0gfHwge30pLm5vZGVUeXBlICYmIChjZS5jbGVhbkRhdGEoU2UodCwgITEpKSwgdC5pbm5lckhUTUwgPSBlKTsgdCA9IDAgfSBjYXRjaCAoZSkgeyB9IH0gdCAmJiB0aGlzLmVtcHR5KCkuYXBwZW5kKGUpIH0sIG51bGwsIGUsIGFyZ3VtZW50cy5sZW5ndGgpIH0sIHJlcGxhY2VXaXRoOiBmdW5jdGlvbiAoKSB7IHZhciBuID0gW107IHJldHVybiAkZSh0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gdGhpcy5wYXJlbnROb2RlOyBjZS5pbkFycmF5KHRoaXMsIG4pIDwgMCAmJiAoY2UuY2xlYW5EYXRhKFNlKHRoaXMpKSwgdCAmJiB0LnJlcGxhY2VDaGlsZChlLCB0aGlzKSkgfSwgbikgfSB9KSwgY2UuZWFjaCh7IGFwcGVuZFRvOiAiYXBwZW5kIiwgcHJlcGVuZFRvOiAicHJlcGVuZCIsIGluc2VydEJlZm9yZTogImJlZm9yZSIsIGluc2VydEFmdGVyOiAiYWZ0ZXIiLCByZXBsYWNlQWxsOiAicmVwbGFjZVdpdGgiIH0sIGZ1bmN0aW9uIChlLCBhKSB7IGNlLmZuW2VdID0gZnVuY3Rpb24gKGUpIHsgZm9yICh2YXIgdCwgbiA9IFtdLCByID0gY2UoZSksIGkgPSByLmxlbmd0aCAtIDEsIG8gPSAwOyBvIDw9IGk7IG8rKyl0ID0gbyA9PT0gaSA/IHRoaXMgOiB0aGlzLmNsb25lKCEwKSwgY2UocltvXSlbYV0odCksIHMuYXBwbHkobiwgdC5nZXQoKSk7IHJldHVybiB0aGlzLnB1c2hTdGFjayhuKSB9IH0pOyB2YXIgX2UgPSBuZXcgUmVnRXhwKCJeKCIgKyBHICsgIikoPyFweClbYS16JV0rJCIsICJpIiksIHplID0gL14tLS8sIFhlID0gZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBlLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc7IHJldHVybiB0ICYmIHQub3BlbmVyIHx8ICh0ID0gaWUpLCB0LmdldENvbXB1dGVkU3R5bGUoZSkgfSwgVWUgPSBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciwgaSwgbyA9IHt9OyBmb3IgKGkgaW4gdCkgb1tpXSA9IGUuc3R5bGVbaV0sIGUuc3R5bGVbaV0gPSB0W2ldOyBmb3IgKGkgaW4gciA9IG4uY2FsbChlKSwgdCkgZS5zdHlsZVtpXSA9IG9baV07IHJldHVybiByIH0sIFZlID0gbmV3IFJlZ0V4cChRLmpvaW4oInwiKSwgImkiKTsgZnVuY3Rpb24gR2UoZSwgdCwgbikgeyB2YXIgciwgaSwgbywgYSwgcyA9IHplLnRlc3QodCksIHUgPSBlLnN0eWxlOyByZXR1cm4gKG4gPSBuIHx8IFhlKGUpKSAmJiAoYSA9IG4uZ2V0UHJvcGVydHlWYWx1ZSh0KSB8fCBuW3RdLCBzICYmIGEgJiYgKGEgPSBhLnJlcGxhY2UodmUsICIkMSIpIHx8IHZvaWQgMCksICIiICE9PSBhIHx8IEsoZSkgfHwgKGEgPSBjZS5zdHlsZShlLCB0KSksICFsZS5waXhlbEJveFN0eWxlcygpICYmIF9lLnRlc3QoYSkgJiYgVmUudGVzdCh0KSAmJiAociA9IHUud2lkdGgsIGkgPSB1Lm1pbldpZHRoLCBvID0gdS5tYXhXaWR0aCwgdS5taW5XaWR0aCA9IHUubWF4V2lkdGggPSB1LndpZHRoID0gYSwgYSA9IG4ud2lkdGgsIHUud2lkdGggPSByLCB1Lm1pbldpZHRoID0gaSwgdS5tYXhXaWR0aCA9IG8pKSwgdm9pZCAwICE9PSBhID8gYSArICIiIDogYSB9IGZ1bmN0aW9uIFllKGUsIHQpIHsgcmV0dXJuIHsgZ2V0OiBmdW5jdGlvbiAoKSB7IGlmICghZSgpKSByZXR1cm4gKHRoaXMuZ2V0ID0gdCkuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgZGVsZXRlIHRoaXMuZ2V0IH0gfSB9ICFmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGUoKSB7IGlmIChsKSB7IHUuc3R5bGUuY3NzVGV4dCA9ICJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi0xMTExMXB4O3dpZHRoOjYwcHg7bWFyZ2luLXRvcDoxcHg7cGFkZGluZzowO2JvcmRlcjowIiwgbC5zdHlsZS5jc3NUZXh0ID0gInBvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2s7Ym94LXNpemluZzpib3JkZXItYm94O292ZXJmbG93OnNjcm9sbDttYXJnaW46YXV0bztib3JkZXI6MXB4O3BhZGRpbmc6MXB4O3dpZHRoOjYwJTt0b3A6MSUiLCBKLmFwcGVuZENoaWxkKHUpLmFwcGVuZENoaWxkKGwpOyB2YXIgZSA9IGllLmdldENvbXB1dGVkU3R5bGUobCk7IG4gPSAiMSUiICE9PSBlLnRvcCwgcyA9IDEyID09PSB0KGUubWFyZ2luTGVmdCksIGwuc3R5bGUucmlnaHQgPSAiNjAlIiwgbyA9IDM2ID09PSB0KGUucmlnaHQpLCByID0gMzYgPT09IHQoZS53aWR0aCksIGwuc3R5bGUucG9zaXRpb24gPSAiYWJzb2x1dGUiLCBpID0gMTIgPT09IHQobC5vZmZzZXRXaWR0aCAvIDMpLCBKLnJlbW92ZUNoaWxkKHUpLCBsID0gbnVsbCB9IH0gZnVuY3Rpb24gdChlKSB7IHJldHVybiBNYXRoLnJvdW5kKHBhcnNlRmxvYXQoZSkpIH0gdmFyIG4sIHIsIGksIG8sIGEsIHMsIHUgPSBDLmNyZWF0ZUVsZW1lbnQoImRpdiIpLCBsID0gQy5jcmVhdGVFbGVtZW50KCJkaXYiKTsgbC5zdHlsZSAmJiAobC5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9ICJjb250ZW50LWJveCIsIGwuY2xvbmVOb2RlKCEwKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9ICIiLCBsZS5jbGVhckNsb25lU3R5bGUgPSAiY29udGVudC1ib3giID09PSBsLnN0eWxlLmJhY2tncm91bmRDbGlwLCBjZS5leHRlbmQobGUsIHsgYm94U2l6aW5nUmVsaWFibGU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGUoKSwgciB9LCBwaXhlbEJveFN0eWxlczogZnVuY3Rpb24gKCkgeyByZXR1cm4gZSgpLCBvIH0sIHBpeGVsUG9zaXRpb246IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGUoKSwgbiB9LCByZWxpYWJsZU1hcmdpbkxlZnQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGUoKSwgcyB9LCBzY3JvbGxib3hTaXplOiBmdW5jdGlvbiAoKSB7IHJldHVybiBlKCksIGkgfSwgcmVsaWFibGVUckRpbWVuc2lvbnM6IGZ1bmN0aW9uICgpIHsgdmFyIGUsIHQsIG4sIHI7IHJldHVybiBudWxsID09IGEgJiYgKGUgPSBDLmNyZWF0ZUVsZW1lbnQoInRhYmxlIiksIHQgPSBDLmNyZWF0ZUVsZW1lbnQoInRyIiksIG4gPSBDLmNyZWF0ZUVsZW1lbnQoImRpdiIpLCBlLnN0eWxlLmNzc1RleHQgPSAicG9zaXRpb246YWJzb2x1dGU7bGVmdDotMTExMTFweDtib3JkZXItY29sbGFwc2U6c2VwYXJhdGUiLCB0LnN0eWxlLmNzc1RleHQgPSAiYm94LXNpemluZzpjb250ZW50LWJveDtib3JkZXI6MXB4IHNvbGlkIiwgdC5zdHlsZS5oZWlnaHQgPSAiMXB4Iiwgbi5zdHlsZS5oZWlnaHQgPSAiOXB4Iiwgbi5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIiwgSi5hcHBlbmRDaGlsZChlKS5hcHBlbmRDaGlsZCh0KS5hcHBlbmRDaGlsZChuKSwgciA9IGllLmdldENvbXB1dGVkU3R5bGUodCksIGEgPSBwYXJzZUludChyLmhlaWdodCwgMTApICsgcGFyc2VJbnQoci5ib3JkZXJUb3BXaWR0aCwgMTApICsgcGFyc2VJbnQoci5ib3JkZXJCb3R0b21XaWR0aCwgMTApID09PSB0Lm9mZnNldEhlaWdodCwgSi5yZW1vdmVDaGlsZChlKSksIGEgfSB9KSkgfSgpOyB2YXIgUWUgPSBbIldlYmtpdCIsICJNb3oiLCAibXMiXSwgSmUgPSBDLmNyZWF0ZUVsZW1lbnQoImRpdiIpLnN0eWxlLCBLZSA9IHt9OyBmdW5jdGlvbiBaZShlKSB7IHZhciB0ID0gY2UuY3NzUHJvcHNbZV0gfHwgS2VbZV07IHJldHVybiB0IHx8IChlIGluIEplID8gZSA6IEtlW2VdID0gZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBlWzBdLnRvVXBwZXJDYXNlKCkgKyBlLnNsaWNlKDEpLCBuID0gUWUubGVuZ3RoOyB3aGlsZSAobi0tKSBpZiAoKGUgPSBRZVtuXSArIHQpIGluIEplKSByZXR1cm4gZSB9KGUpIHx8IGUpIH0gdmFyIGV0ID0gL14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLCB0dCA9IHsgcG9zaXRpb246ICJhYnNvbHV0ZSIsIHZpc2liaWxpdHk6ICJoaWRkZW4iLCBkaXNwbGF5OiAiYmxvY2siIH0sIG50ID0geyBsZXR0ZXJTcGFjaW5nOiAiMCIsIGZvbnRXZWlnaHQ6ICI0MDAiIH07IGZ1bmN0aW9uIHJ0KGUsIHQsIG4pIHsgdmFyIHIgPSBZLmV4ZWModCk7IHJldHVybiByID8gTWF0aC5tYXgoMCwgclsyXSAtIChuIHx8IDApKSArIChyWzNdIHx8ICJweCIpIDogdCB9IGZ1bmN0aW9uIGl0KGUsIHQsIG4sIHIsIGksIG8pIHsgdmFyIGEgPSAid2lkdGgiID09PSB0ID8gMSA6IDAsIHMgPSAwLCB1ID0gMCwgbCA9IDA7IGlmIChuID09PSAociA/ICJib3JkZXIiIDogImNvbnRlbnQiKSkgcmV0dXJuIDA7IGZvciAoOyBhIDwgNDsgYSArPSAyKSJtYXJnaW4iID09PSBuICYmIChsICs9IGNlLmNzcyhlLCBuICsgUVthXSwgITAsIGkpKSwgciA/ICgiY29udGVudCIgPT09IG4gJiYgKHUgLT0gY2UuY3NzKGUsICJwYWRkaW5nIiArIFFbYV0sICEwLCBpKSksICJtYXJnaW4iICE9PSBuICYmICh1IC09IGNlLmNzcyhlLCAiYm9yZGVyIiArIFFbYV0gKyAiV2lkdGgiLCAhMCwgaSkpKSA6ICh1ICs9IGNlLmNzcyhlLCAicGFkZGluZyIgKyBRW2FdLCAhMCwgaSksICJwYWRkaW5nIiAhPT0gbiA/IHUgKz0gY2UuY3NzKGUsICJib3JkZXIiICsgUVthXSArICJXaWR0aCIsICEwLCBpKSA6IHMgKz0gY2UuY3NzKGUsICJib3JkZXIiICsgUVthXSArICJXaWR0aCIsICEwLCBpKSk7IHJldHVybiAhciAmJiAwIDw9IG8gJiYgKHUgKz0gTWF0aC5tYXgoMCwgTWF0aC5jZWlsKGVbIm9mZnNldCIgKyB0WzBdLnRvVXBwZXJDYXNlKCkgKyB0LnNsaWNlKDEpXSAtIG8gLSB1IC0gcyAtIC41KSkgfHwgMCksIHUgKyBsIH0gZnVuY3Rpb24gb3QoZSwgdCwgbikgeyB2YXIgciA9IFhlKGUpLCBpID0gKCFsZS5ib3hTaXppbmdSZWxpYWJsZSgpIHx8IG4pICYmICJib3JkZXItYm94IiA9PT0gY2UuY3NzKGUsICJib3hTaXppbmciLCAhMSwgciksIG8gPSBpLCBhID0gR2UoZSwgdCwgciksIHMgPSAib2Zmc2V0IiArIHRbMF0udG9VcHBlckNhc2UoKSArIHQuc2xpY2UoMSk7IGlmIChfZS50ZXN0KGEpKSB7IGlmICghbikgcmV0dXJuIGE7IGEgPSAiYXV0byIgfSByZXR1cm4gKCFsZS5ib3hTaXppbmdSZWxpYWJsZSgpICYmIGkgfHwgIWxlLnJlbGlhYmxlVHJEaW1lbnNpb25zKCkgJiYgZmUoZSwgInRyIikgfHwgImF1dG8iID09PSBhIHx8ICFwYXJzZUZsb2F0KGEpICYmICJpbmxpbmUiID09PSBjZS5jc3MoZSwgImRpc3BsYXkiLCAhMSwgcikpICYmIGUuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGggJiYgKGkgPSAiYm9yZGVyLWJveCIgPT09IGNlLmNzcyhlLCAiYm94U2l6aW5nIiwgITEsIHIpLCAobyA9IHMgaW4gZSkgJiYgKGEgPSBlW3NdKSksIChhID0gcGFyc2VGbG9hdChhKSB8fCAwKSArIGl0KGUsIHQsIG4gfHwgKGkgPyAiYm9yZGVyIiA6ICJjb250ZW50IiksIG8sIHIsIGEpICsgInB4IiB9IGZ1bmN0aW9uIGF0KGUsIHQsIG4sIHIsIGkpIHsgcmV0dXJuIG5ldyBhdC5wcm90b3R5cGUuaW5pdChlLCB0LCBuLCByLCBpKSB9IGNlLmV4dGVuZCh7IGNzc0hvb2tzOiB7IG9wYWNpdHk6IHsgZ2V0OiBmdW5jdGlvbiAoZSwgdCkgeyBpZiAodCkgeyB2YXIgbiA9IEdlKGUsICJvcGFjaXR5Iik7IHJldHVybiAiIiA9PT0gbiA/ICIxIiA6IG4gfSB9IH0gfSwgY3NzTnVtYmVyOiB7IGFuaW1hdGlvbkl0ZXJhdGlvbkNvdW50OiAhMCwgYXNwZWN0UmF0aW86ICEwLCBib3JkZXJJbWFnZVNsaWNlOiAhMCwgY29sdW1uQ291bnQ6ICEwLCBmbGV4R3JvdzogITAsIGZsZXhTaHJpbms6ICEwLCBmb250V2VpZ2h0OiAhMCwgZ3JpZEFyZWE6ICEwLCBncmlkQ29sdW1uOiAhMCwgZ3JpZENvbHVtbkVuZDogITAsIGdyaWRDb2x1bW5TdGFydDogITAsIGdyaWRSb3c6ICEwLCBncmlkUm93RW5kOiAhMCwgZ3JpZFJvd1N0YXJ0OiAhMCwgbGluZUhlaWdodDogITAsIG9wYWNpdHk6ICEwLCBvcmRlcjogITAsIG9ycGhhbnM6ICEwLCBzY2FsZTogITAsIHdpZG93czogITAsIHpJbmRleDogITAsIHpvb206ICEwLCBmaWxsT3BhY2l0eTogITAsIGZsb29kT3BhY2l0eTogITAsIHN0b3BPcGFjaXR5OiAhMCwgc3Ryb2tlTWl0ZXJsaW1pdDogITAsIHN0cm9rZU9wYWNpdHk6ICEwIH0sIGNzc1Byb3BzOiB7fSwgc3R5bGU6IGZ1bmN0aW9uIChlLCB0LCBuLCByKSB7IGlmIChlICYmIDMgIT09IGUubm9kZVR5cGUgJiYgOCAhPT0gZS5ub2RlVHlwZSAmJiBlLnN0eWxlKSB7IHZhciBpLCBvLCBhLCBzID0gRih0KSwgdSA9IHplLnRlc3QodCksIGwgPSBlLnN0eWxlOyBpZiAodSB8fCAodCA9IFplKHMpKSwgYSA9IGNlLmNzc0hvb2tzW3RdIHx8IGNlLmNzc0hvb2tzW3NdLCB2b2lkIDAgPT09IG4pIHJldHVybiBhICYmICJnZXQiIGluIGEgJiYgdm9pZCAwICE9PSAoaSA9IGEuZ2V0KGUsICExLCByKSkgPyBpIDogbFt0XTsgInN0cmluZyIgPT09IChvID0gdHlwZW9mIG4pICYmIChpID0gWS5leGVjKG4pKSAmJiBpWzFdICYmIChuID0gdGUoZSwgdCwgaSksIG8gPSAibnVtYmVyIiksIG51bGwgIT0gbiAmJiBuID09IG4gJiYgKCJudW1iZXIiICE9PSBvIHx8IHUgfHwgKG4gKz0gaSAmJiBpWzNdIHx8IChjZS5jc3NOdW1iZXJbc10gPyAiIiA6ICJweCIpKSwgbGUuY2xlYXJDbG9uZVN0eWxlIHx8ICIiICE9PSBuIHx8IDAgIT09IHQuaW5kZXhPZigiYmFja2dyb3VuZCIpIHx8IChsW3RdID0gImluaGVyaXQiKSwgYSAmJiAic2V0IiBpbiBhICYmIHZvaWQgMCA9PT0gKG4gPSBhLnNldChlLCBuLCByKSkgfHwgKHUgPyBsLnNldFByb3BlcnR5KHQsIG4pIDogbFt0XSA9IG4pKSB9IH0sIGNzczogZnVuY3Rpb24gKGUsIHQsIG4sIHIpIHsgdmFyIGksIG8sIGEsIHMgPSBGKHQpOyByZXR1cm4gemUudGVzdCh0KSB8fCAodCA9IFplKHMpKSwgKGEgPSBjZS5jc3NIb29rc1t0XSB8fCBjZS5jc3NIb29rc1tzXSkgJiYgImdldCIgaW4gYSAmJiAoaSA9IGEuZ2V0KGUsICEwLCBuKSksIHZvaWQgMCA9PT0gaSAmJiAoaSA9IEdlKGUsIHQsIHIpKSwgIm5vcm1hbCIgPT09IGkgJiYgdCBpbiBudCAmJiAoaSA9IG50W3RdKSwgIiIgPT09IG4gfHwgbiA/IChvID0gcGFyc2VGbG9hdChpKSwgITAgPT09IG4gfHwgaXNGaW5pdGUobykgPyBvIHx8IDAgOiBpKSA6IGkgfSB9KSwgY2UuZWFjaChbImhlaWdodCIsICJ3aWR0aCJdLCBmdW5jdGlvbiAoZSwgdSkgeyBjZS5jc3NIb29rc1t1XSA9IHsgZ2V0OiBmdW5jdGlvbiAoZSwgdCwgbikgeyBpZiAodCkgcmV0dXJuICFldC50ZXN0KGNlLmNzcyhlLCAiZGlzcGxheSIpKSB8fCBlLmdldENsaWVudFJlY3RzKCkubGVuZ3RoICYmIGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggPyBvdChlLCB1LCBuKSA6IFVlKGUsIHR0LCBmdW5jdGlvbiAoKSB7IHJldHVybiBvdChlLCB1LCBuKSB9KSB9LCBzZXQ6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHZhciByLCBpID0gWGUoZSksIG8gPSAhbGUuc2Nyb2xsYm94U2l6ZSgpICYmICJhYnNvbHV0ZSIgPT09IGkucG9zaXRpb24sIGEgPSAobyB8fCBuKSAmJiAiYm9yZGVyLWJveCIgPT09IGNlLmNzcyhlLCAiYm94U2l6aW5nIiwgITEsIGkpLCBzID0gbiA/IGl0KGUsIHUsIG4sIGEsIGkpIDogMDsgcmV0dXJuIGEgJiYgbyAmJiAocyAtPSBNYXRoLmNlaWwoZVsib2Zmc2V0IiArIHVbMF0udG9VcHBlckNhc2UoKSArIHUuc2xpY2UoMSldIC0gcGFyc2VGbG9hdChpW3VdKSAtIGl0KGUsIHUsICJib3JkZXIiLCAhMSwgaSkgLSAuNSkpLCBzICYmIChyID0gWS5leGVjKHQpKSAmJiAicHgiICE9PSAoclszXSB8fCAicHgiKSAmJiAoZS5zdHlsZVt1XSA9IHQsIHQgPSBjZS5jc3MoZSwgdSkpLCBydCgwLCB0LCBzKSB9IH0gfSksIGNlLmNzc0hvb2tzLm1hcmdpbkxlZnQgPSBZZShsZS5yZWxpYWJsZU1hcmdpbkxlZnQsIGZ1bmN0aW9uIChlLCB0KSB7IGlmICh0KSByZXR1cm4gKHBhcnNlRmxvYXQoR2UoZSwgIm1hcmdpbkxlZnQiKSkgfHwgZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0IC0gVWUoZSwgeyBtYXJnaW5MZWZ0OiAwIH0sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCB9KSkgKyAicHgiIH0pLCBjZS5lYWNoKHsgbWFyZ2luOiAiIiwgcGFkZGluZzogIiIsIGJvcmRlcjogIldpZHRoIiB9LCBmdW5jdGlvbiAoaSwgbykgeyBjZS5jc3NIb29rc1tpICsgb10gPSB7IGV4cGFuZDogZnVuY3Rpb24gKGUpIHsgZm9yICh2YXIgdCA9IDAsIG4gPSB7fSwgciA9ICJzdHJpbmciID09IHR5cGVvZiBlID8gZS5zcGxpdCgiICIpIDogW2VdOyB0IDwgNDsgdCsrKW5baSArIFFbdF0gKyBvXSA9IHJbdF0gfHwgclt0IC0gMl0gfHwgclswXTsgcmV0dXJuIG4gfSB9LCAibWFyZ2luIiAhPT0gaSAmJiAoY2UuY3NzSG9va3NbaSArIG9dLnNldCA9IHJ0KSB9KSwgY2UuZm4uZXh0ZW5kKHsgY3NzOiBmdW5jdGlvbiAoZSwgdCkgeyByZXR1cm4gTSh0aGlzLCBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciwgaSwgbyA9IHt9LCBhID0gMDsgaWYgKEFycmF5LmlzQXJyYXkodCkpIHsgZm9yIChyID0gWGUoZSksIGkgPSB0Lmxlbmd0aDsgYSA8IGk7IGErKylvW3RbYV1dID0gY2UuY3NzKGUsIHRbYV0sICExLCByKTsgcmV0dXJuIG8gfSByZXR1cm4gdm9pZCAwICE9PSBuID8gY2Uuc3R5bGUoZSwgdCwgbikgOiBjZS5jc3MoZSwgdCkgfSwgZSwgdCwgMSA8IGFyZ3VtZW50cy5sZW5ndGgpIH0gfSksICgoY2UuVHdlZW4gPSBhdCkucHJvdG90eXBlID0geyBjb25zdHJ1Y3RvcjogYXQsIGluaXQ6IGZ1bmN0aW9uIChlLCB0LCBuLCByLCBpLCBvKSB7IHRoaXMuZWxlbSA9IGUsIHRoaXMucHJvcCA9IG4sIHRoaXMuZWFzaW5nID0gaSB8fCBjZS5lYXNpbmcuX2RlZmF1bHQsIHRoaXMub3B0aW9ucyA9IHQsIHRoaXMuc3RhcnQgPSB0aGlzLm5vdyA9IHRoaXMuY3VyKCksIHRoaXMuZW5kID0gciwgdGhpcy51bml0ID0gbyB8fCAoY2UuY3NzTnVtYmVyW25dID8gIiIgOiAicHgiKSB9LCBjdXI6IGZ1bmN0aW9uICgpIHsgdmFyIGUgPSBhdC5wcm9wSG9va3NbdGhpcy5wcm9wXTsgcmV0dXJuIGUgJiYgZS5nZXQgPyBlLmdldCh0aGlzKSA6IGF0LnByb3BIb29rcy5fZGVmYXVsdC5nZXQodGhpcykgfSwgcnVuOiBmdW5jdGlvbiAoZSkgeyB2YXIgdCwgbiA9IGF0LnByb3BIb29rc1t0aGlzLnByb3BdOyByZXR1cm4gdGhpcy5vcHRpb25zLmR1cmF0aW9uID8gdGhpcy5wb3MgPSB0ID0gY2UuZWFzaW5nW3RoaXMuZWFzaW5nXShlLCB0aGlzLm9wdGlvbnMuZHVyYXRpb24gKiBlLCAwLCAxLCB0aGlzLm9wdGlvbnMuZHVyYXRpb24pIDogdGhpcy5wb3MgPSB0ID0gZSwgdGhpcy5ub3cgPSAodGhpcy5lbmQgLSB0aGlzLnN0YXJ0KSAqIHQgKyB0aGlzLnN0YXJ0LCB0aGlzLm9wdGlvbnMuc3RlcCAmJiB0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKHRoaXMuZWxlbSwgdGhpcy5ub3csIHRoaXMpLCBuICYmIG4uc2V0ID8gbi5zZXQodGhpcykgOiBhdC5wcm9wSG9va3MuX2RlZmF1bHQuc2V0KHRoaXMpLCB0aGlzIH0gfSkuaW5pdC5wcm90b3R5cGUgPSBhdC5wcm90b3R5cGUsIChhdC5wcm9wSG9va3MgPSB7IF9kZWZhdWx0OiB7IGdldDogZnVuY3Rpb24gKGUpIHsgdmFyIHQ7IHJldHVybiAxICE9PSBlLmVsZW0ubm9kZVR5cGUgfHwgbnVsbCAhPSBlLmVsZW1bZS5wcm9wXSAmJiBudWxsID09IGUuZWxlbS5zdHlsZVtlLnByb3BdID8gZS5lbGVtW2UucHJvcF0gOiAodCA9IGNlLmNzcyhlLmVsZW0sIGUucHJvcCwgIiIpKSAmJiAiYXV0byIgIT09IHQgPyB0IDogMCB9LCBzZXQ6IGZ1bmN0aW9uIChlKSB7IGNlLmZ4LnN0ZXBbZS5wcm9wXSA/IGNlLmZ4LnN0ZXBbZS5wcm9wXShlKSA6IDEgIT09IGUuZWxlbS5ub2RlVHlwZSB8fCAhY2UuY3NzSG9va3NbZS5wcm9wXSAmJiBudWxsID09IGUuZWxlbS5zdHlsZVtaZShlLnByb3ApXSA/IGUuZWxlbVtlLnByb3BdID0gZS5ub3cgOiBjZS5zdHlsZShlLmVsZW0sIGUucHJvcCwgZS5ub3cgKyBlLnVuaXQpIH0gfSB9KS5zY3JvbGxUb3AgPSBhdC5wcm9wSG9va3Muc2Nyb2xsTGVmdCA9IHsgc2V0OiBmdW5jdGlvbiAoZSkgeyBlLmVsZW0ubm9kZVR5cGUgJiYgZS5lbGVtLnBhcmVudE5vZGUgJiYgKGUuZWxlbVtlLnByb3BdID0gZS5ub3cpIH0gfSwgY2UuZWFzaW5nID0geyBsaW5lYXI6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBlIH0sIHN3aW5nOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gLjUgLSBNYXRoLmNvcyhlICogTWF0aC5QSSkgLyAyIH0sIF9kZWZhdWx0OiAic3dpbmciIH0sIGNlLmZ4ID0gYXQucHJvdG90eXBlLmluaXQsIGNlLmZ4LnN0ZXAgPSB7fTsgdmFyIHN0LCB1dCwgbHQsIGN0LCBmdCA9IC9eKD86dG9nZ2xlfHNob3d8aGlkZSkkLywgcHQgPSAvcXVldWVIb29rcyQvOyBmdW5jdGlvbiBkdCgpIHsgdXQgJiYgKCExID09PSBDLmhpZGRlbiAmJiBpZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPyBpZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZHQpIDogaWUuc2V0VGltZW91dChkdCwgY2UuZnguaW50ZXJ2YWwpLCBjZS5meC50aWNrKCkpIH0gZnVuY3Rpb24gaHQoKSB7IHJldHVybiBpZS5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgc3QgPSB2b2lkIDAgfSksIHN0ID0gRGF0ZS5ub3coKSB9IGZ1bmN0aW9uIGd0KGUsIHQpIHsgdmFyIG4sIHIgPSAwLCBpID0geyBoZWlnaHQ6IGUgfTsgZm9yICh0ID0gdCA/IDEgOiAwOyByIDwgNDsgciArPSAyIC0gdClpWyJtYXJnaW4iICsgKG4gPSBRW3JdKV0gPSBpWyJwYWRkaW5nIiArIG5dID0gZTsgcmV0dXJuIHQgJiYgKGkub3BhY2l0eSA9IGkud2lkdGggPSBlKSwgaSB9IGZ1bmN0aW9uIHZ0KGUsIHQsIG4pIHsgZm9yICh2YXIgciwgaSA9ICh5dC50d2VlbmVyc1t0XSB8fCBbXSkuY29uY2F0KHl0LnR3ZWVuZXJzWyIqIl0pLCBvID0gMCwgYSA9IGkubGVuZ3RoOyBvIDwgYTsgbysrKWlmIChyID0gaVtvXS5jYWxsKG4sIHQsIGUpKSByZXR1cm4gciB9IGZ1bmN0aW9uIHl0KG8sIGUsIHQpIHsgdmFyIG4sIGEsIHIgPSAwLCBpID0geXQucHJlZmlsdGVycy5sZW5ndGgsIHMgPSBjZS5EZWZlcnJlZCgpLmFsd2F5cyhmdW5jdGlvbiAoKSB7IGRlbGV0ZSB1LmVsZW0gfSksIHUgPSBmdW5jdGlvbiAoKSB7IGlmIChhKSByZXR1cm4gITE7IGZvciAodmFyIGUgPSBzdCB8fCBodCgpLCB0ID0gTWF0aC5tYXgoMCwgbC5zdGFydFRpbWUgKyBsLmR1cmF0aW9uIC0gZSksIG4gPSAxIC0gKHQgLyBsLmR1cmF0aW9uIHx8IDApLCByID0gMCwgaSA9IGwudHdlZW5zLmxlbmd0aDsgciA8IGk7IHIrKylsLnR3ZWVuc1tyXS5ydW4obik7IHJldHVybiBzLm5vdGlmeVdpdGgobywgW2wsIG4sIHRdKSwgbiA8IDEgJiYgaSA/IHQgOiAoaSB8fCBzLm5vdGlmeVdpdGgobywgW2wsIDEsIDBdKSwgcy5yZXNvbHZlV2l0aChvLCBbbF0pLCAhMSkgfSwgbCA9IHMucHJvbWlzZSh7IGVsZW06IG8sIHByb3BzOiBjZS5leHRlbmQoe30sIGUpLCBvcHRzOiBjZS5leHRlbmQoITAsIHsgc3BlY2lhbEVhc2luZzoge30sIGVhc2luZzogY2UuZWFzaW5nLl9kZWZhdWx0IH0sIHQpLCBvcmlnaW5hbFByb3BlcnRpZXM6IGUsIG9yaWdpbmFsT3B0aW9uczogdCwgc3RhcnRUaW1lOiBzdCB8fCBodCgpLCBkdXJhdGlvbjogdC5kdXJhdGlvbiwgdHdlZW5zOiBbXSwgY3JlYXRlVHdlZW46IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuID0gY2UuVHdlZW4obywgbC5vcHRzLCBlLCB0LCBsLm9wdHMuc3BlY2lhbEVhc2luZ1tlXSB8fCBsLm9wdHMuZWFzaW5nKTsgcmV0dXJuIGwudHdlZW5zLnB1c2gobiksIG4gfSwgc3RvcDogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSAwLCBuID0gZSA/IGwudHdlZW5zLmxlbmd0aCA6IDA7IGlmIChhKSByZXR1cm4gdGhpczsgZm9yIChhID0gITA7IHQgPCBuOyB0KyspbC50d2VlbnNbdF0ucnVuKDEpOyByZXR1cm4gZSA/IChzLm5vdGlmeVdpdGgobywgW2wsIDEsIDBdKSwgcy5yZXNvbHZlV2l0aChvLCBbbCwgZV0pKSA6IHMucmVqZWN0V2l0aChvLCBbbCwgZV0pLCB0aGlzIH0gfSksIGMgPSBsLnByb3BzOyBmb3IgKCFmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiwgciwgaSwgbywgYTsgZm9yIChuIGluIGUpIGlmIChpID0gdFtyID0gRihuKV0sIG8gPSBlW25dLCBBcnJheS5pc0FycmF5KG8pICYmIChpID0gb1sxXSwgbyA9IGVbbl0gPSBvWzBdKSwgbiAhPT0gciAmJiAoZVtyXSA9IG8sIGRlbGV0ZSBlW25dKSwgKGEgPSBjZS5jc3NIb29rc1tyXSkgJiYgImV4cGFuZCIgaW4gYSkgZm9yIChuIGluIG8gPSBhLmV4cGFuZChvKSwgZGVsZXRlIGVbcl0sIG8pIG4gaW4gZSB8fCAoZVtuXSA9IG9bbl0sIHRbbl0gPSBpKTsgZWxzZSB0W3JdID0gaSB9KGMsIGwub3B0cy5zcGVjaWFsRWFzaW5nKTsgciA8IGk7IHIrKylpZiAobiA9IHl0LnByZWZpbHRlcnNbcl0uY2FsbChsLCBvLCBjLCBsLm9wdHMpKSByZXR1cm4gdihuLnN0b3ApICYmIChjZS5fcXVldWVIb29rcyhsLmVsZW0sIGwub3B0cy5xdWV1ZSkuc3RvcCA9IG4uc3RvcC5iaW5kKG4pKSwgbjsgcmV0dXJuIGNlLm1hcChjLCB2dCwgbCksIHYobC5vcHRzLnN0YXJ0KSAmJiBsLm9wdHMuc3RhcnQuY2FsbChvLCBsKSwgbC5wcm9ncmVzcyhsLm9wdHMucHJvZ3Jlc3MpLmRvbmUobC5vcHRzLmRvbmUsIGwub3B0cy5jb21wbGV0ZSkuZmFpbChsLm9wdHMuZmFpbCkuYWx3YXlzKGwub3B0cy5hbHdheXMpLCBjZS5meC50aW1lcihjZS5leHRlbmQodSwgeyBlbGVtOiBvLCBhbmltOiBsLCBxdWV1ZTogbC5vcHRzLnF1ZXVlIH0pKSwgbCB9IGNlLkFuaW1hdGlvbiA9IGNlLmV4dGVuZCh5dCwgeyB0d2VlbmVyczogeyAiKiI6IFtmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiA9IHRoaXMuY3JlYXRlVHdlZW4oZSwgdCk7IHJldHVybiB0ZShuLmVsZW0sIGUsIFkuZXhlYyh0KSwgbiksIG4gfV0gfSwgdHdlZW5lcjogZnVuY3Rpb24gKGUsIHQpIHsgdihlKSA/ICh0ID0gZSwgZSA9IFsiKiJdKSA6IGUgPSBlLm1hdGNoKEQpOyBmb3IgKHZhciBuLCByID0gMCwgaSA9IGUubGVuZ3RoOyByIDwgaTsgcisrKW4gPSBlW3JdLCB5dC50d2VlbmVyc1tuXSA9IHl0LnR3ZWVuZXJzW25dIHx8IFtdLCB5dC50d2VlbmVyc1tuXS51bnNoaWZ0KHQpIH0sIHByZWZpbHRlcnM6IFtmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciwgaSwgbywgYSwgcywgdSwgbCwgYywgZiA9ICJ3aWR0aCIgaW4gdCB8fCAiaGVpZ2h0IiBpbiB0LCBwID0gdGhpcywgZCA9IHt9LCBoID0gZS5zdHlsZSwgZyA9IGUubm9kZVR5cGUgJiYgZWUoZSksIHYgPSBfLmdldChlLCAiZnhzaG93Iik7IGZvciAociBpbiBuLnF1ZXVlIHx8IChudWxsID09IChhID0gY2UuX3F1ZXVlSG9va3MoZSwgImZ4IikpLnVucXVldWVkICYmIChhLnVucXVldWVkID0gMCwgcyA9IGEuZW1wdHkuZmlyZSwgYS5lbXB0eS5maXJlID0gZnVuY3Rpb24gKCkgeyBhLnVucXVldWVkIHx8IHMoKSB9KSwgYS51bnF1ZXVlZCsrLCBwLmFsd2F5cyhmdW5jdGlvbiAoKSB7IHAuYWx3YXlzKGZ1bmN0aW9uICgpIHsgYS51bnF1ZXVlZC0tLCBjZS5xdWV1ZShlLCAiZngiKS5sZW5ndGggfHwgYS5lbXB0eS5maXJlKCkgfSkgfSkpLCB0KSBpZiAoaSA9IHRbcl0sIGZ0LnRlc3QoaSkpIHsgaWYgKGRlbGV0ZSB0W3JdLCBvID0gbyB8fCAidG9nZ2xlIiA9PT0gaSwgaSA9PT0gKGcgPyAiaGlkZSIgOiAic2hvdyIpKSB7IGlmICgic2hvdyIgIT09IGkgfHwgIXYgfHwgdm9pZCAwID09PSB2W3JdKSBjb250aW51ZTsgZyA9ICEwIH0gZFtyXSA9IHYgJiYgdltyXSB8fCBjZS5zdHlsZShlLCByKSB9IGlmICgodSA9ICFjZS5pc0VtcHR5T2JqZWN0KHQpKSB8fCAhY2UuaXNFbXB0eU9iamVjdChkKSkgZm9yIChyIGluIGYgJiYgMSA9PT0gZS5ub2RlVHlwZSAmJiAobi5vdmVyZmxvdyA9IFtoLm92ZXJmbG93LCBoLm92ZXJmbG93WCwgaC5vdmVyZmxvd1ldLCBudWxsID09IChsID0gdiAmJiB2LmRpc3BsYXkpICYmIChsID0gXy5nZXQoZSwgImRpc3BsYXkiKSksICJub25lIiA9PT0gKGMgPSBjZS5jc3MoZSwgImRpc3BsYXkiKSkgJiYgKGwgPyBjID0gbCA6IChyZShbZV0sICEwKSwgbCA9IGUuc3R5bGUuZGlzcGxheSB8fCBsLCBjID0gY2UuY3NzKGUsICJkaXNwbGF5IiksIHJlKFtlXSkpKSwgKCJpbmxpbmUiID09PSBjIHx8ICJpbmxpbmUtYmxvY2siID09PSBjICYmIG51bGwgIT0gbCkgJiYgIm5vbmUiID09PSBjZS5jc3MoZSwgImZsb2F0IikgJiYgKHUgfHwgKHAuZG9uZShmdW5jdGlvbiAoKSB7IGguZGlzcGxheSA9IGwgfSksIG51bGwgPT0gbCAmJiAoYyA9IGguZGlzcGxheSwgbCA9ICJub25lIiA9PT0gYyA/ICIiIDogYykpLCBoLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIikpLCBuLm92ZXJmbG93ICYmIChoLm92ZXJmbG93ID0gImhpZGRlbiIsIHAuYWx3YXlzKGZ1bmN0aW9uICgpIHsgaC5vdmVyZmxvdyA9IG4ub3ZlcmZsb3dbMF0sIGgub3ZlcmZsb3dYID0gbi5vdmVyZmxvd1sxXSwgaC5vdmVyZmxvd1kgPSBuLm92ZXJmbG93WzJdIH0pKSwgdSA9ICExLCBkKSB1IHx8ICh2ID8gImhpZGRlbiIgaW4gdiAmJiAoZyA9IHYuaGlkZGVuKSA6IHYgPSBfLmFjY2VzcyhlLCAiZnhzaG93IiwgeyBkaXNwbGF5OiBsIH0pLCBvICYmICh2LmhpZGRlbiA9ICFnKSwgZyAmJiByZShbZV0sICEwKSwgcC5kb25lKGZ1bmN0aW9uICgpIHsgZm9yIChyIGluIGcgfHwgcmUoW2VdKSwgXy5yZW1vdmUoZSwgImZ4c2hvdyIpLCBkKSBjZS5zdHlsZShlLCByLCBkW3JdKSB9KSksIHUgPSB2dChnID8gdltyXSA6IDAsIHIsIHApLCByIGluIHYgfHwgKHZbcl0gPSB1LnN0YXJ0LCBnICYmICh1LmVuZCA9IHUuc3RhcnQsIHUuc3RhcnQgPSAwKSkgfV0sIHByZWZpbHRlcjogZnVuY3Rpb24gKGUsIHQpIHsgdCA/IHl0LnByZWZpbHRlcnMudW5zaGlmdChlKSA6IHl0LnByZWZpbHRlcnMucHVzaChlKSB9IH0pLCBjZS5zcGVlZCA9IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHZhciByID0gZSAmJiAib2JqZWN0IiA9PSB0eXBlb2YgZSA/IGNlLmV4dGVuZCh7fSwgZSkgOiB7IGNvbXBsZXRlOiBuIHx8ICFuICYmIHQgfHwgdihlKSAmJiBlLCBkdXJhdGlvbjogZSwgZWFzaW5nOiBuICYmIHQgfHwgdCAmJiAhdih0KSAmJiB0IH07IHJldHVybiBjZS5meC5vZmYgPyByLmR1cmF0aW9uID0gMCA6ICJudW1iZXIiICE9IHR5cGVvZiByLmR1cmF0aW9uICYmIChyLmR1cmF0aW9uIGluIGNlLmZ4LnNwZWVkcyA/IHIuZHVyYXRpb24gPSBjZS5meC5zcGVlZHNbci5kdXJhdGlvbl0gOiByLmR1cmF0aW9uID0gY2UuZnguc3BlZWRzLl9kZWZhdWx0KSwgbnVsbCAhPSByLnF1ZXVlICYmICEwICE9PSByLnF1ZXVlIHx8IChyLnF1ZXVlID0gImZ4IiksIHIub2xkID0gci5jb21wbGV0ZSwgci5jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsgdihyLm9sZCkgJiYgci5vbGQuY2FsbCh0aGlzKSwgci5xdWV1ZSAmJiBjZS5kZXF1ZXVlKHRoaXMsIHIucXVldWUpIH0sIHIgfSwgY2UuZm4uZXh0ZW5kKHsgZmFkZVRvOiBmdW5jdGlvbiAoZSwgdCwgbiwgcikgeyByZXR1cm4gdGhpcy5maWx0ZXIoZWUpLmNzcygib3BhY2l0eSIsIDApLnNob3coKS5lbmQoKS5hbmltYXRlKHsgb3BhY2l0eTogdCB9LCBlLCBuLCByKSB9LCBhbmltYXRlOiBmdW5jdGlvbiAodCwgZSwgbiwgcikgeyB2YXIgaSA9IGNlLmlzRW1wdHlPYmplY3QodCksIG8gPSBjZS5zcGVlZChlLCBuLCByKSwgYSA9IGZ1bmN0aW9uICgpIHsgdmFyIGUgPSB5dCh0aGlzLCBjZS5leHRlbmQoe30sIHQpLCBvKTsgKGkgfHwgXy5nZXQodGhpcywgImZpbmlzaCIpKSAmJiBlLnN0b3AoITApIH07IHJldHVybiBhLmZpbmlzaCA9IGEsIGkgfHwgITEgPT09IG8ucXVldWUgPyB0aGlzLmVhY2goYSkgOiB0aGlzLnF1ZXVlKG8ucXVldWUsIGEpIH0sIHN0b3A6IGZ1bmN0aW9uIChpLCBlLCBvKSB7IHZhciBhID0gZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBlLnN0b3A7IGRlbGV0ZSBlLnN0b3AsIHQobykgfTsgcmV0dXJuICJzdHJpbmciICE9IHR5cGVvZiBpICYmIChvID0gZSwgZSA9IGksIGkgPSB2b2lkIDApLCBlICYmIHRoaXMucXVldWUoaSB8fCAiZngiLCBbXSksIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IHZhciBlID0gITAsIHQgPSBudWxsICE9IGkgJiYgaSArICJxdWV1ZUhvb2tzIiwgbiA9IGNlLnRpbWVycywgciA9IF8uZ2V0KHRoaXMpOyBpZiAodCkgclt0XSAmJiByW3RdLnN0b3AgJiYgYShyW3RdKTsgZWxzZSBmb3IgKHQgaW4gcikgclt0XSAmJiByW3RdLnN0b3AgJiYgcHQudGVzdCh0KSAmJiBhKHJbdF0pOyBmb3IgKHQgPSBuLmxlbmd0aDsgdC0tOyluW3RdLmVsZW0gIT09IHRoaXMgfHwgbnVsbCAhPSBpICYmIG5bdF0ucXVldWUgIT09IGkgfHwgKG5bdF0uYW5pbS5zdG9wKG8pLCBlID0gITEsIG4uc3BsaWNlKHQsIDEpKTsgIWUgJiYgbyB8fCBjZS5kZXF1ZXVlKHRoaXMsIGkpIH0pIH0sIGZpbmlzaDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuICExICE9PSBhICYmIChhID0gYSB8fCAiZngiKSwgdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgdmFyIGUsIHQgPSBfLmdldCh0aGlzKSwgbiA9IHRbYSArICJxdWV1ZSJdLCByID0gdFthICsgInF1ZXVlSG9va3MiXSwgaSA9IGNlLnRpbWVycywgbyA9IG4gPyBuLmxlbmd0aCA6IDA7IGZvciAodC5maW5pc2ggPSAhMCwgY2UucXVldWUodGhpcywgYSwgW10pLCByICYmIHIuc3RvcCAmJiByLnN0b3AuY2FsbCh0aGlzLCAhMCksIGUgPSBpLmxlbmd0aDsgZS0tOylpW2VdLmVsZW0gPT09IHRoaXMgJiYgaVtlXS5xdWV1ZSA9PT0gYSAmJiAoaVtlXS5hbmltLnN0b3AoITApLCBpLnNwbGljZShlLCAxKSk7IGZvciAoZSA9IDA7IGUgPCBvOyBlKyspbltlXSAmJiBuW2VdLmZpbmlzaCAmJiBuW2VdLmZpbmlzaC5jYWxsKHRoaXMpOyBkZWxldGUgdC5maW5pc2ggfSkgfSB9KSwgY2UuZWFjaChbInRvZ2dsZSIsICJzaG93IiwgImhpZGUiXSwgZnVuY3Rpb24gKGUsIHIpIHsgdmFyIGkgPSBjZS5mbltyXTsgY2UuZm5bcl0gPSBmdW5jdGlvbiAoZSwgdCwgbikgeyByZXR1cm4gbnVsbCA9PSBlIHx8ICJib29sZWFuIiA9PSB0eXBlb2YgZSA/IGkuYXBwbHkodGhpcywgYXJndW1lbnRzKSA6IHRoaXMuYW5pbWF0ZShndChyLCAhMCksIGUsIHQsIG4pIH0gfSksIGNlLmVhY2goeyBzbGlkZURvd246IGd0KCJzaG93IiksIHNsaWRlVXA6IGd0KCJoaWRlIiksIHNsaWRlVG9nZ2xlOiBndCgidG9nZ2xlIiksIGZhZGVJbjogeyBvcGFjaXR5OiAic2hvdyIgfSwgZmFkZU91dDogeyBvcGFjaXR5OiAiaGlkZSIgfSwgZmFkZVRvZ2dsZTogeyBvcGFjaXR5OiAidG9nZ2xlIiB9IH0sIGZ1bmN0aW9uIChlLCByKSB7IGNlLmZuW2VdID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIHRoaXMuYW5pbWF0ZShyLCBlLCB0LCBuKSB9IH0pLCBjZS50aW1lcnMgPSBbXSwgY2UuZngudGljayA9IGZ1bmN0aW9uICgpIHsgdmFyIGUsIHQgPSAwLCBuID0gY2UudGltZXJzOyBmb3IgKHN0ID0gRGF0ZS5ub3coKTsgdCA8IG4ubGVuZ3RoOyB0KyspKGUgPSBuW3RdKSgpIHx8IG5bdF0gIT09IGUgfHwgbi5zcGxpY2UodC0tLCAxKTsgbi5sZW5ndGggfHwgY2UuZnguc3RvcCgpLCBzdCA9IHZvaWQgMCB9LCBjZS5meC50aW1lciA9IGZ1bmN0aW9uIChlKSB7IGNlLnRpbWVycy5wdXNoKGUpLCBjZS5meC5zdGFydCgpIH0sIGNlLmZ4LmludGVydmFsID0gMTMsIGNlLmZ4LnN0YXJ0ID0gZnVuY3Rpb24gKCkgeyB1dCB8fCAodXQgPSAhMCwgZHQoKSkgfSwgY2UuZnguc3RvcCA9IGZ1bmN0aW9uICgpIHsgdXQgPSBudWxsIH0sIGNlLmZ4LnNwZWVkcyA9IHsgc2xvdzogNjAwLCBmYXN0OiAyMDAsIF9kZWZhdWx0OiA0MDAgfSwgY2UuZm4uZGVsYXkgPSBmdW5jdGlvbiAociwgZSkgeyByZXR1cm4gciA9IGNlLmZ4ICYmIGNlLmZ4LnNwZWVkc1tyXSB8fCByLCBlID0gZSB8fCAiZngiLCB0aGlzLnF1ZXVlKGUsIGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuID0gaWUuc2V0VGltZW91dChlLCByKTsgdC5zdG9wID0gZnVuY3Rpb24gKCkgeyBpZS5jbGVhclRpbWVvdXQobikgfSB9KSB9LCBsdCA9IEMuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSwgY3QgPSBDLmNyZWF0ZUVsZW1lbnQoInNlbGVjdCIpLmFwcGVuZENoaWxkKEMuY3JlYXRlRWxlbWVudCgib3B0aW9uIikpLCBsdC50eXBlID0gImNoZWNrYm94IiwgbGUuY2hlY2tPbiA9ICIiICE9PSBsdC52YWx1ZSwgbGUub3B0U2VsZWN0ZWQgPSBjdC5zZWxlY3RlZCwgKGx0ID0gQy5jcmVhdGVFbGVtZW50KCJpbnB1dCIpKS52YWx1ZSA9ICJ0IiwgbHQudHlwZSA9ICJyYWRpbyIsIGxlLnJhZGlvVmFsdWUgPSAidCIgPT09IGx0LnZhbHVlOyB2YXIgbXQsIHh0ID0gY2UuZXhwci5hdHRySGFuZGxlOyBjZS5mbi5leHRlbmQoeyBhdHRyOiBmdW5jdGlvbiAoZSwgdCkgeyByZXR1cm4gTSh0aGlzLCBjZS5hdHRyLCBlLCB0LCAxIDwgYXJndW1lbnRzLmxlbmd0aCkgfSwgcmVtb3ZlQXR0cjogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IGNlLnJlbW92ZUF0dHIodGhpcywgZSkgfSkgfSB9KSwgY2UuZXh0ZW5kKHsgYXR0cjogZnVuY3Rpb24gKGUsIHQsIG4pIHsgdmFyIHIsIGksIG8gPSBlLm5vZGVUeXBlOyBpZiAoMyAhPT0gbyAmJiA4ICE9PSBvICYmIDIgIT09IG8pIHJldHVybiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgZS5nZXRBdHRyaWJ1dGUgPyBjZS5wcm9wKGUsIHQsIG4pIDogKDEgPT09IG8gJiYgY2UuaXNYTUxEb2MoZSkgfHwgKGkgPSBjZS5hdHRySG9va3NbdC50b0xvd2VyQ2FzZSgpXSB8fCAoY2UuZXhwci5tYXRjaC5ib29sLnRlc3QodCkgPyBtdCA6IHZvaWQgMCkpLCB2b2lkIDAgIT09IG4gPyBudWxsID09PSBuID8gdm9pZCBjZS5yZW1vdmVBdHRyKGUsIHQpIDogaSAmJiAic2V0IiBpbiBpICYmIHZvaWQgMCAhPT0gKHIgPSBpLnNldChlLCBuLCB0KSkgPyByIDogKGUuc2V0QXR0cmlidXRlKHQsIG4gKyAiIiksIG4pIDogaSAmJiAiZ2V0IiBpbiBpICYmIG51bGwgIT09IChyID0gaS5nZXQoZSwgdCkpID8gciA6IG51bGwgPT0gKHIgPSBjZS5maW5kLmF0dHIoZSwgdCkpID8gdm9pZCAwIDogcikgfSwgYXR0ckhvb2tzOiB7IHR5cGU6IHsgc2V0OiBmdW5jdGlvbiAoZSwgdCkgeyBpZiAoIWxlLnJhZGlvVmFsdWUgJiYgInJhZGlvIiA9PT0gdCAmJiBmZShlLCAiaW5wdXQiKSkgeyB2YXIgbiA9IGUudmFsdWU7IHJldHVybiBlLnNldEF0dHJpYnV0ZSgidHlwZSIsIHQpLCBuICYmIChlLnZhbHVlID0gbiksIHQgfSB9IH0gfSwgcmVtb3ZlQXR0cjogZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4sIHIgPSAwLCBpID0gdCAmJiB0Lm1hdGNoKEQpOyBpZiAoaSAmJiAxID09PSBlLm5vZGVUeXBlKSB3aGlsZSAobiA9IGlbcisrXSkgZS5yZW1vdmVBdHRyaWJ1dGUobikgfSB9KSwgbXQgPSB7IHNldDogZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuICExID09PSB0ID8gY2UucmVtb3ZlQXR0cihlLCBuKSA6IGUuc2V0QXR0cmlidXRlKG4sIG4pLCBuIH0gfSwgY2UuZWFjaChjZS5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKC9cdysvZyksIGZ1bmN0aW9uIChlLCB0KSB7IHZhciBhID0geHRbdF0gfHwgY2UuZmluZC5hdHRyOyB4dFt0XSA9IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHZhciByLCBpLCBvID0gdC50b0xvd2VyQ2FzZSgpOyByZXR1cm4gbiB8fCAoaSA9IHh0W29dLCB4dFtvXSA9IHIsIHIgPSBudWxsICE9IGEoZSwgdCwgbikgPyBvIDogbnVsbCwgeHRbb10gPSBpKSwgciB9IH0pOyB2YXIgYnQgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLCB3dCA9IC9eKD86YXxhcmVhKSQvaTsgZnVuY3Rpb24gVHQoZSkgeyByZXR1cm4gKGUubWF0Y2goRCkgfHwgW10pLmpvaW4oIiAiKSB9IGZ1bmN0aW9uIEN0KGUpIHsgcmV0dXJuIGUuZ2V0QXR0cmlidXRlICYmIGUuZ2V0QXR0cmlidXRlKCJjbGFzcyIpIHx8ICIiIH0gZnVuY3Rpb24ga3QoZSkgeyByZXR1cm4gQXJyYXkuaXNBcnJheShlKSA/IGUgOiAic3RyaW5nIiA9PSB0eXBlb2YgZSAmJiBlLm1hdGNoKEQpIHx8IFtdIH0gY2UuZm4uZXh0ZW5kKHsgcHJvcDogZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIE0odGhpcywgY2UucHJvcCwgZSwgdCwgMSA8IGFyZ3VtZW50cy5sZW5ndGgpIH0sIHJlbW92ZVByb3A6IGZ1bmN0aW9uIChlKSB7IHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyBkZWxldGUgdGhpc1tjZS5wcm9wRml4W2VdIHx8IGVdIH0pIH0gfSksIGNlLmV4dGVuZCh7IHByb3A6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHZhciByLCBpLCBvID0gZS5ub2RlVHlwZTsgaWYgKDMgIT09IG8gJiYgOCAhPT0gbyAmJiAyICE9PSBvKSByZXR1cm4gMSA9PT0gbyAmJiBjZS5pc1hNTERvYyhlKSB8fCAodCA9IGNlLnByb3BGaXhbdF0gfHwgdCwgaSA9IGNlLnByb3BIb29rc1t0XSksIHZvaWQgMCAhPT0gbiA/IGkgJiYgInNldCIgaW4gaSAmJiB2b2lkIDAgIT09IChyID0gaS5zZXQoZSwgbiwgdCkpID8gciA6IGVbdF0gPSBuIDogaSAmJiAiZ2V0IiBpbiBpICYmIG51bGwgIT09IChyID0gaS5nZXQoZSwgdCkpID8gciA6IGVbdF0gfSwgcHJvcEhvb2tzOiB7IHRhYkluZGV4OiB7IGdldDogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBjZS5maW5kLmF0dHIoZSwgInRhYmluZGV4Iik7IHJldHVybiB0ID8gcGFyc2VJbnQodCwgMTApIDogYnQudGVzdChlLm5vZGVOYW1lKSB8fCB3dC50ZXN0KGUubm9kZU5hbWUpICYmIGUuaHJlZiA/IDAgOiAtMSB9IH0gfSwgcHJvcEZpeDogeyAiZm9yIjogImh0bWxGb3IiLCAiY2xhc3MiOiAiY2xhc3NOYW1lIiB9IH0pLCBsZS5vcHRTZWxlY3RlZCB8fCAoY2UucHJvcEhvb2tzLnNlbGVjdGVkID0geyBnZXQ6IGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gZS5wYXJlbnROb2RlOyByZXR1cm4gdCAmJiB0LnBhcmVudE5vZGUgJiYgdC5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsIG51bGwgfSwgc2V0OiBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IGUucGFyZW50Tm9kZTsgdCAmJiAodC5zZWxlY3RlZEluZGV4LCB0LnBhcmVudE5vZGUgJiYgdC5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgpIH0gfSksIGNlLmVhY2goWyJ0YWJJbmRleCIsICJyZWFkT25seSIsICJtYXhMZW5ndGgiLCAiY2VsbFNwYWNpbmciLCAiY2VsbFBhZGRpbmciLCAicm93U3BhbiIsICJjb2xTcGFuIiwgInVzZU1hcCIsICJmcmFtZUJvcmRlciIsICJjb250ZW50RWRpdGFibGUiXSwgZnVuY3Rpb24gKCkgeyBjZS5wcm9wRml4W3RoaXMudG9Mb3dlckNhc2UoKV0gPSB0aGlzIH0pLCBjZS5mbi5leHRlbmQoeyBhZGRDbGFzczogZnVuY3Rpb24gKHQpIHsgdmFyIGUsIG4sIHIsIGksIG8sIGE7IHJldHVybiB2KHQpID8gdGhpcy5lYWNoKGZ1bmN0aW9uIChlKSB7IGNlKHRoaXMpLmFkZENsYXNzKHQuY2FsbCh0aGlzLCBlLCBDdCh0aGlzKSkpIH0pIDogKGUgPSBrdCh0KSkubGVuZ3RoID8gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgaWYgKHIgPSBDdCh0aGlzKSwgbiA9IDEgPT09IHRoaXMubm9kZVR5cGUgJiYgIiAiICsgVHQocikgKyAiICIpIHsgZm9yIChvID0gMDsgbyA8IGUubGVuZ3RoOyBvKyspaSA9IGVbb10sIG4uaW5kZXhPZigiICIgKyBpICsgIiAiKSA8IDAgJiYgKG4gKz0gaSArICIgIik7IGEgPSBUdChuKSwgciAhPT0gYSAmJiB0aGlzLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCBhKSB9IH0pIDogdGhpcyB9LCByZW1vdmVDbGFzczogZnVuY3Rpb24gKHQpIHsgdmFyIGUsIG4sIHIsIGksIG8sIGE7IHJldHVybiB2KHQpID8gdGhpcy5lYWNoKGZ1bmN0aW9uIChlKSB7IGNlKHRoaXMpLnJlbW92ZUNsYXNzKHQuY2FsbCh0aGlzLCBlLCBDdCh0aGlzKSkpIH0pIDogYXJndW1lbnRzLmxlbmd0aCA/IChlID0ga3QodCkpLmxlbmd0aCA/IHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IGlmIChyID0gQ3QodGhpcyksIG4gPSAxID09PSB0aGlzLm5vZGVUeXBlICYmICIgIiArIFR0KHIpICsgIiAiKSB7IGZvciAobyA9IDA7IG8gPCBlLmxlbmd0aDsgbysrKSB7IGkgPSBlW29dOyB3aGlsZSAoLTEgPCBuLmluZGV4T2YoIiAiICsgaSArICIgIikpIG4gPSBuLnJlcGxhY2UoIiAiICsgaSArICIgIiwgIiAiKSB9IGEgPSBUdChuKSwgciAhPT0gYSAmJiB0aGlzLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCBhKSB9IH0pIDogdGhpcyA6IHRoaXMuYXR0cigiY2xhc3MiLCAiIikgfSwgdG9nZ2xlQ2xhc3M6IGZ1bmN0aW9uICh0LCBuKSB7IHZhciBlLCByLCBpLCBvLCBhID0gdHlwZW9mIHQsIHMgPSAic3RyaW5nIiA9PT0gYSB8fCBBcnJheS5pc0FycmF5KHQpOyByZXR1cm4gdih0KSA/IHRoaXMuZWFjaChmdW5jdGlvbiAoZSkgeyBjZSh0aGlzKS50b2dnbGVDbGFzcyh0LmNhbGwodGhpcywgZSwgQ3QodGhpcyksIG4pLCBuKSB9KSA6ICJib29sZWFuIiA9PSB0eXBlb2YgbiAmJiBzID8gbiA/IHRoaXMuYWRkQ2xhc3ModCkgOiB0aGlzLnJlbW92ZUNsYXNzKHQpIDogKGUgPSBrdCh0KSwgdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgaWYgKHMpIGZvciAobyA9IGNlKHRoaXMpLCBpID0gMDsgaSA8IGUubGVuZ3RoOyBpKyspciA9IGVbaV0sIG8uaGFzQ2xhc3MocikgPyBvLnJlbW92ZUNsYXNzKHIpIDogby5hZGRDbGFzcyhyKTsgZWxzZSB2b2lkIDAgIT09IHQgJiYgImJvb2xlYW4iICE9PSBhIHx8ICgociA9IEN0KHRoaXMpKSAmJiBfLnNldCh0aGlzLCAiX19jbGFzc05hbWVfXyIsIHIpLCB0aGlzLnNldEF0dHJpYnV0ZSAmJiB0aGlzLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCByIHx8ICExID09PSB0ID8gIiIgOiBfLmdldCh0aGlzLCAiX19jbGFzc05hbWVfXyIpIHx8ICIiKSkgfSkpIH0sIGhhc0NsYXNzOiBmdW5jdGlvbiAoZSkgeyB2YXIgdCwgbiwgciA9IDA7IHQgPSAiICIgKyBlICsgIiAiOyB3aGlsZSAobiA9IHRoaXNbcisrXSkgaWYgKDEgPT09IG4ubm9kZVR5cGUgJiYgLTEgPCAoIiAiICsgVHQoQ3QobikpICsgIiAiKS5pbmRleE9mKHQpKSByZXR1cm4gITA7IHJldHVybiAhMSB9IH0pOyB2YXIgU3QgPSAvXHIvZzsgY2UuZm4uZXh0ZW5kKHsgdmFsOiBmdW5jdGlvbiAobikgeyB2YXIgciwgZSwgaSwgdCA9IHRoaXNbMF07IHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKGkgPSB2KG4pLCB0aGlzLmVhY2goZnVuY3Rpb24gKGUpIHsgdmFyIHQ7IDEgPT09IHRoaXMubm9kZVR5cGUgJiYgKG51bGwgPT0gKHQgPSBpID8gbi5jYWxsKHRoaXMsIGUsIGNlKHRoaXMpLnZhbCgpKSA6IG4pID8gdCA9ICIiIDogIm51bWJlciIgPT0gdHlwZW9mIHQgPyB0ICs9ICIiIDogQXJyYXkuaXNBcnJheSh0KSAmJiAodCA9IGNlLm1hcCh0LCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gbnVsbCA9PSBlID8gIiIgOiBlICsgIiIgfSkpLCAociA9IGNlLnZhbEhvb2tzW3RoaXMudHlwZV0gfHwgY2UudmFsSG9va3NbdGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSkgJiYgInNldCIgaW4gciAmJiB2b2lkIDAgIT09IHIuc2V0KHRoaXMsIHQsICJ2YWx1ZSIpIHx8ICh0aGlzLnZhbHVlID0gdCkpIH0pKSA6IHQgPyAociA9IGNlLnZhbEhvb2tzW3QudHlwZV0gfHwgY2UudmFsSG9va3NbdC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSkgJiYgImdldCIgaW4gciAmJiB2b2lkIDAgIT09IChlID0gci5nZXQodCwgInZhbHVlIikpID8gZSA6ICJzdHJpbmciID09IHR5cGVvZiAoZSA9IHQudmFsdWUpID8gZS5yZXBsYWNlKFN0LCAiIikgOiBudWxsID09IGUgPyAiIiA6IGUgOiB2b2lkIDAgfSB9KSwgY2UuZXh0ZW5kKHsgdmFsSG9va3M6IHsgb3B0aW9uOiB7IGdldDogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBjZS5maW5kLmF0dHIoZSwgInZhbHVlIik7IHJldHVybiBudWxsICE9IHQgPyB0IDogVHQoY2UudGV4dChlKSkgfSB9LCBzZWxlY3Q6IHsgZ2V0OiBmdW5jdGlvbiAoZSkgeyB2YXIgdCwgbiwgciwgaSA9IGUub3B0aW9ucywgbyA9IGUuc2VsZWN0ZWRJbmRleCwgYSA9ICJzZWxlY3Qtb25lIiA9PT0gZS50eXBlLCBzID0gYSA/IG51bGwgOiBbXSwgdSA9IGEgPyBvICsgMSA6IGkubGVuZ3RoOyBmb3IgKHIgPSBvIDwgMCA/IHUgOiBhID8gbyA6IDA7IHIgPCB1OyByKyspaWYgKCgobiA9IGlbcl0pLnNlbGVjdGVkIHx8IHIgPT09IG8pICYmICFuLmRpc2FibGVkICYmICghbi5wYXJlbnROb2RlLmRpc2FibGVkIHx8ICFmZShuLnBhcmVudE5vZGUsICJvcHRncm91cCIpKSkgeyBpZiAodCA9IGNlKG4pLnZhbCgpLCBhKSByZXR1cm4gdDsgcy5wdXNoKHQpIH0gcmV0dXJuIHMgfSwgc2V0OiBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiwgciwgaSA9IGUub3B0aW9ucywgbyA9IGNlLm1ha2VBcnJheSh0KSwgYSA9IGkubGVuZ3RoOyB3aGlsZSAoYS0tKSAoKHIgPSBpW2FdKS5zZWxlY3RlZCA9IC0xIDwgY2UuaW5BcnJheShjZS52YWxIb29rcy5vcHRpb24uZ2V0KHIpLCBvKSkgJiYgKG4gPSAhMCk7IHJldHVybiBuIHx8IChlLnNlbGVjdGVkSW5kZXggPSAtMSksIG8gfSB9IH0gfSksIGNlLmVhY2goWyJyYWRpbyIsICJjaGVja2JveCJdLCBmdW5jdGlvbiAoKSB7IGNlLnZhbEhvb2tzW3RoaXNdID0geyBzZXQ6IGZ1bmN0aW9uIChlLCB0KSB7IGlmIChBcnJheS5pc0FycmF5KHQpKSByZXR1cm4gZS5jaGVja2VkID0gLTEgPCBjZS5pbkFycmF5KGNlKGUpLnZhbCgpLCB0KSB9IH0sIGxlLmNoZWNrT24gfHwgKGNlLnZhbEhvb2tzW3RoaXNdLmdldCA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiBudWxsID09PSBlLmdldEF0dHJpYnV0ZSgidmFsdWUiKSA/ICJvbiIgOiBlLnZhbHVlIH0pIH0pOyB2YXIgRXQgPSBpZS5sb2NhdGlvbiwganQgPSB7IGd1aWQ6IERhdGUubm93KCkgfSwgQXQgPSAvXD8vOyBjZS5wYXJzZVhNTCA9IGZ1bmN0aW9uIChlKSB7IHZhciB0LCBuOyBpZiAoIWUgfHwgInN0cmluZyIgIT0gdHlwZW9mIGUpIHJldHVybiBudWxsOyB0cnkgeyB0ID0gKG5ldyBpZS5ET01QYXJzZXIpLnBhcnNlRnJvbVN0cmluZyhlLCAidGV4dC94bWwiKSB9IGNhdGNoIChlKSB7IH0gcmV0dXJuIG4gPSB0ICYmIHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInBhcnNlcmVycm9yIilbMF0sIHQgJiYgIW4gfHwgY2UuZXJyb3IoIkludmFsaWQgWE1MOiAiICsgKG4gPyBjZS5tYXAobi5jaGlsZE5vZGVzLCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZS50ZXh0Q29udGVudCB9KS5qb2luKCJcbiIpIDogZSkpLCB0IH07IHZhciBEdCA9IC9eKD86Zm9jdXNpbmZvY3VzfGZvY3Vzb3V0Ymx1cikkLywgTnQgPSBmdW5jdGlvbiAoZSkgeyBlLnN0b3BQcm9wYWdhdGlvbigpIH07IGNlLmV4dGVuZChjZS5ldmVudCwgeyB0cmlnZ2VyOiBmdW5jdGlvbiAoZSwgdCwgbiwgcikgeyB2YXIgaSwgbywgYSwgcywgdSwgbCwgYywgZiwgcCA9IFtuIHx8IENdLCBkID0gdWUuY2FsbChlLCAidHlwZSIpID8gZS50eXBlIDogZSwgaCA9IHVlLmNhbGwoZSwgIm5hbWVzcGFjZSIpID8gZS5uYW1lc3BhY2Uuc3BsaXQoIi4iKSA6IFtdOyBpZiAobyA9IGYgPSBhID0gbiA9IG4gfHwgQywgMyAhPT0gbi5ub2RlVHlwZSAmJiA4ICE9PSBuLm5vZGVUeXBlICYmICFEdC50ZXN0KGQgKyBjZS5ldmVudC50cmlnZ2VyZWQpICYmICgtMSA8IGQuaW5kZXhPZigiLiIpICYmIChkID0gKGggPSBkLnNwbGl0KCIuIikpLnNoaWZ0KCksIGguc29ydCgpKSwgdSA9IGQuaW5kZXhPZigiOiIpIDwgMCAmJiAib24iICsgZCwgKGUgPSBlW2NlLmV4cGFuZG9dID8gZSA6IG5ldyBjZS5FdmVudChkLCAib2JqZWN0IiA9PSB0eXBlb2YgZSAmJiBlKSkuaXNUcmlnZ2VyID0gciA/IDIgOiAzLCBlLm5hbWVzcGFjZSA9IGguam9pbigiLiIpLCBlLnJuYW1lc3BhY2UgPSBlLm5hbWVzcGFjZSA/IG5ldyBSZWdFeHAoIihefFxcLikiICsgaC5qb2luKCJcXC4oPzouKlxcLnwpIikgKyAiKFxcLnwkKSIpIDogbnVsbCwgZS5yZXN1bHQgPSB2b2lkIDAsIGUudGFyZ2V0IHx8IChlLnRhcmdldCA9IG4pLCB0ID0gbnVsbCA9PSB0ID8gW2VdIDogY2UubWFrZUFycmF5KHQsIFtlXSksIGMgPSBjZS5ldmVudC5zcGVjaWFsW2RdIHx8IHt9LCByIHx8ICFjLnRyaWdnZXIgfHwgITEgIT09IGMudHJpZ2dlci5hcHBseShuLCB0KSkpIHsgaWYgKCFyICYmICFjLm5vQnViYmxlICYmICF5KG4pKSB7IGZvciAocyA9IGMuZGVsZWdhdGVUeXBlIHx8IGQsIER0LnRlc3QocyArIGQpIHx8IChvID0gby5wYXJlbnROb2RlKTsgbzsgbyA9IG8ucGFyZW50Tm9kZSlwLnB1c2gobyksIGEgPSBvOyBhID09PSAobi5vd25lckRvY3VtZW50IHx8IEMpICYmIHAucHVzaChhLmRlZmF1bHRWaWV3IHx8IGEucGFyZW50V2luZG93IHx8IGllKSB9IGkgPSAwOyB3aGlsZSAoKG8gPSBwW2krK10pICYmICFlLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpIGYgPSBvLCBlLnR5cGUgPSAxIDwgaSA/IHMgOiBjLmJpbmRUeXBlIHx8IGQsIChsID0gKF8uZ2V0KG8sICJldmVudHMiKSB8fCBPYmplY3QuY3JlYXRlKG51bGwpKVtlLnR5cGVdICYmIF8uZ2V0KG8sICJoYW5kbGUiKSkgJiYgbC5hcHBseShvLCB0KSwgKGwgPSB1ICYmIG9bdV0pICYmIGwuYXBwbHkgJiYgJChvKSAmJiAoZS5yZXN1bHQgPSBsLmFwcGx5KG8sIHQpLCAhMSA9PT0gZS5yZXN1bHQgJiYgZS5wcmV2ZW50RGVmYXVsdCgpKTsgcmV0dXJuIGUudHlwZSA9IGQsIHIgfHwgZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSB8fCBjLl9kZWZhdWx0ICYmICExICE9PSBjLl9kZWZhdWx0LmFwcGx5KHAucG9wKCksIHQpIHx8ICEkKG4pIHx8IHUgJiYgdihuW2RdKSAmJiAheShuKSAmJiAoKGEgPSBuW3VdKSAmJiAoblt1XSA9IG51bGwpLCBjZS5ldmVudC50cmlnZ2VyZWQgPSBkLCBlLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkgJiYgZi5hZGRFdmVudExpc3RlbmVyKGQsIE50KSwgbltkXSgpLCBlLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkgJiYgZi5yZW1vdmVFdmVudExpc3RlbmVyKGQsIE50KSwgY2UuZXZlbnQudHJpZ2dlcmVkID0gdm9pZCAwLCBhICYmIChuW3VdID0gYSkpLCBlLnJlc3VsdCB9IH0sIHNpbXVsYXRlOiBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciA9IGNlLmV4dGVuZChuZXcgY2UuRXZlbnQsIG4sIHsgdHlwZTogZSwgaXNTaW11bGF0ZWQ6ICEwIH0pOyBjZS5ldmVudC50cmlnZ2VyKHIsIG51bGwsIHQpIH0gfSksIGNlLmZuLmV4dGVuZCh7IHRyaWdnZXI6IGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyBjZS5ldmVudC50cmlnZ2VyKGUsIHQsIHRoaXMpIH0pIH0sIHRyaWdnZXJIYW5kbGVyOiBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiA9IHRoaXNbMF07IGlmIChuKSByZXR1cm4gY2UuZXZlbnQudHJpZ2dlcihlLCB0LCBuLCAhMCkgfSB9KTsgdmFyIHF0ID0gL1xbXF0kLywgTHQgPSAvXHI/XG4vZywgSHQgPSAvXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2ksIE90ID0gL14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8a2V5Z2VuKS9pOyBmdW5jdGlvbiBQdChuLCBlLCByLCBpKSB7IHZhciB0OyBpZiAoQXJyYXkuaXNBcnJheShlKSkgY2UuZWFjaChlLCBmdW5jdGlvbiAoZSwgdCkgeyByIHx8IHF0LnRlc3QobikgPyBpKG4sIHQpIDogUHQobiArICJbIiArICgib2JqZWN0IiA9PSB0eXBlb2YgdCAmJiBudWxsICE9IHQgPyBlIDogIiIpICsgIl0iLCB0LCByLCBpKSB9KTsgZWxzZSBpZiAociB8fCAib2JqZWN0IiAhPT0geChlKSkgaShuLCBlKTsgZWxzZSBmb3IgKHQgaW4gZSkgUHQobiArICJbIiArIHQgKyAiXSIsIGVbdF0sIHIsIGkpIH0gY2UucGFyYW0gPSBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiwgciA9IFtdLCBpID0gZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4gPSB2KHQpID8gdCgpIDogdDsgcltyLmxlbmd0aF0gPSBlbmNvZGVVUklDb21wb25lbnQoZSkgKyAiPSIgKyBlbmNvZGVVUklDb21wb25lbnQobnVsbCA9PSBuID8gIiIgOiBuKSB9OyBpZiAobnVsbCA9PSBlKSByZXR1cm4gIiI7IGlmIChBcnJheS5pc0FycmF5KGUpIHx8IGUuanF1ZXJ5ICYmICFjZS5pc1BsYWluT2JqZWN0KGUpKSBjZS5lYWNoKGUsIGZ1bmN0aW9uICgpIHsgaSh0aGlzLm5hbWUsIHRoaXMudmFsdWUpIH0pOyBlbHNlIGZvciAobiBpbiBlKSBQdChuLCBlW25dLCB0LCBpKTsgcmV0dXJuIHIuam9pbigiJiIpIH0sIGNlLmZuLmV4dGVuZCh7IHNlcmlhbGl6ZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gY2UucGFyYW0odGhpcy5zZXJpYWxpemVBcnJheSgpKSB9LCBzZXJpYWxpemVBcnJheTogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKCkgeyB2YXIgZSA9IGNlLnByb3AodGhpcywgImVsZW1lbnRzIik7IHJldHVybiBlID8gY2UubWFrZUFycmF5KGUpIDogdGhpcyB9KS5maWx0ZXIoZnVuY3Rpb24gKCkgeyB2YXIgZSA9IHRoaXMudHlwZTsgcmV0dXJuIHRoaXMubmFtZSAmJiAhY2UodGhpcykuaXMoIjpkaXNhYmxlZCIpICYmIE90LnRlc3QodGhpcy5ub2RlTmFtZSkgJiYgIUh0LnRlc3QoZSkgJiYgKHRoaXMuY2hlY2tlZCB8fCAhd2UudGVzdChlKSkgfSkubWFwKGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuID0gY2UodGhpcykudmFsKCk7IHJldHVybiBudWxsID09IG4gPyBudWxsIDogQXJyYXkuaXNBcnJheShuKSA/IGNlLm1hcChuLCBmdW5jdGlvbiAoZSkgeyByZXR1cm4geyBuYW1lOiB0Lm5hbWUsIHZhbHVlOiBlLnJlcGxhY2UoTHQsICJcclxuIikgfSB9KSA6IHsgbmFtZTogdC5uYW1lLCB2YWx1ZTogbi5yZXBsYWNlKEx0LCAiXHJcbiIpIH0gfSkuZ2V0KCkgfSB9KTsgdmFyIE10ID0gLyUyMC9nLCBSdCA9IC8jLiokLywgSXQgPSAvKFs/Jl0pXz1bXiZdKi8sIFd0ID0gL14oLio/KTpbIFx0XSooW15cclxuXSopJC9nbSwgRnQgPSAvXig/OkdFVHxIRUFEKSQvLCAkdCA9IC9eXC9cLy8sIEJ0ID0ge30sIF90ID0ge30sIHp0ID0gIiovIi5jb25jYXQoIioiKSwgWHQgPSBDLmNyZWF0ZUVsZW1lbnQoImEiKTsgZnVuY3Rpb24gVXQobykgeyByZXR1cm4gZnVuY3Rpb24gKGUsIHQpIHsgInN0cmluZyIgIT0gdHlwZW9mIGUgJiYgKHQgPSBlLCBlID0gIioiKTsgdmFyIG4sIHIgPSAwLCBpID0gZS50b0xvd2VyQ2FzZSgpLm1hdGNoKEQpIHx8IFtdOyBpZiAodih0KSkgd2hpbGUgKG4gPSBpW3IrK10pICIrIiA9PT0gblswXSA/IChuID0gbi5zbGljZSgxKSB8fCAiKiIsIChvW25dID0gb1tuXSB8fCBbXSkudW5zaGlmdCh0KSkgOiAob1tuXSA9IG9bbl0gfHwgW10pLnB1c2godCkgfSB9IGZ1bmN0aW9uIFZ0KHQsIGksIG8sIGEpIHsgdmFyIHMgPSB7fSwgdSA9IHQgPT09IF90OyBmdW5jdGlvbiBsKGUpIHsgdmFyIHI7IHJldHVybiBzW2VdID0gITAsIGNlLmVhY2godFtlXSB8fCBbXSwgZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4gPSB0KGksIG8sIGEpOyByZXR1cm4gInN0cmluZyIgIT0gdHlwZW9mIG4gfHwgdSB8fCBzW25dID8gdSA/ICEociA9IG4pIDogdm9pZCAwIDogKGkuZGF0YVR5cGVzLnVuc2hpZnQobiksIGwobiksICExKSB9KSwgciB9IHJldHVybiBsKGkuZGF0YVR5cGVzWzBdKSB8fCAhc1siKiJdICYmIGwoIioiKSB9IGZ1bmN0aW9uIEd0KGUsIHQpIHsgdmFyIG4sIHIsIGkgPSBjZS5hamF4U2V0dGluZ3MuZmxhdE9wdGlvbnMgfHwge307IGZvciAobiBpbiB0KSB2b2lkIDAgIT09IHRbbl0gJiYgKChpW25dID8gZSA6IHIgfHwgKHIgPSB7fSkpW25dID0gdFtuXSk7IHJldHVybiByICYmIGNlLmV4dGVuZCghMCwgZSwgciksIGUgfSBYdC5ocmVmID0gRXQuaHJlZiwgY2UuZXh0ZW5kKHsgYWN0aXZlOiAwLCBsYXN0TW9kaWZpZWQ6IHt9LCBldGFnOiB7fSwgYWpheFNldHRpbmdzOiB7IHVybDogRXQuaHJlZiwgdHlwZTogIkdFVCIsIGlzTG9jYWw6IC9eKD86YWJvdXR8YXBwfGFwcC1zdG9yYWdlfC4rLWV4dGVuc2lvbnxmaWxlfHJlc3x3aWRnZXQpOiQvLnRlc3QoRXQucHJvdG9jb2wpLCBnbG9iYWw6ICEwLCBwcm9jZXNzRGF0YTogITAsIGFzeW5jOiAhMCwgY29udGVudFR5cGU6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLCBhY2NlcHRzOiB7ICIqIjogenQsIHRleHQ6ICJ0ZXh0L3BsYWluIiwgaHRtbDogInRleHQvaHRtbCIsIHhtbDogImFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwiLCBqc29uOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0IiB9LCBjb250ZW50czogeyB4bWw6IC9cYnhtbFxiLywgaHRtbDogL1xiaHRtbC8sIGpzb246IC9cYmpzb25cYi8gfSwgcmVzcG9uc2VGaWVsZHM6IHsgeG1sOiAicmVzcG9uc2VYTUwiLCB0ZXh0OiAicmVzcG9uc2VUZXh0IiwganNvbjogInJlc3BvbnNlSlNPTiIgfSwgY29udmVydGVyczogeyAiKiB0ZXh0IjogU3RyaW5nLCAidGV4dCBodG1sIjogITAsICJ0ZXh0IGpzb24iOiBKU09OLnBhcnNlLCAidGV4dCB4bWwiOiBjZS5wYXJzZVhNTCB9LCBmbGF0T3B0aW9uczogeyB1cmw6ICEwLCBjb250ZXh0OiAhMCB9IH0sIGFqYXhTZXR1cDogZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIHQgPyBHdChHdChlLCBjZS5hamF4U2V0dGluZ3MpLCB0KSA6IEd0KGNlLmFqYXhTZXR0aW5ncywgZSkgfSwgYWpheFByZWZpbHRlcjogVXQoQnQpLCBhamF4VHJhbnNwb3J0OiBVdChfdCksIGFqYXg6IGZ1bmN0aW9uIChlLCB0KSB7ICJvYmplY3QiID09IHR5cGVvZiBlICYmICh0ID0gZSwgZSA9IHZvaWQgMCksIHQgPSB0IHx8IHt9OyB2YXIgYywgZiwgcCwgbiwgZCwgciwgaCwgZywgaSwgbywgdiA9IGNlLmFqYXhTZXR1cCh7fSwgdCksIHkgPSB2LmNvbnRleHQgfHwgdiwgbSA9IHYuY29udGV4dCAmJiAoeS5ub2RlVHlwZSB8fCB5LmpxdWVyeSkgPyBjZSh5KSA6IGNlLmV2ZW50LCB4ID0gY2UuRGVmZXJyZWQoKSwgYiA9IGNlLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwgdyA9IHYuc3RhdHVzQ29kZSB8fCB7fSwgYSA9IHt9LCBzID0ge30sIHUgPSAiY2FuY2VsZWQiLCBUID0geyByZWFkeVN0YXRlOiAwLCBnZXRSZXNwb25zZUhlYWRlcjogZnVuY3Rpb24gKGUpIHsgdmFyIHQ7IGlmIChoKSB7IGlmICghbikgeyBuID0ge307IHdoaWxlICh0ID0gV3QuZXhlYyhwKSkgblt0WzFdLnRvTG93ZXJDYXNlKCkgKyAiICJdID0gKG5bdFsxXS50b0xvd2VyQ2FzZSgpICsgIiAiXSB8fCBbXSkuY29uY2F0KHRbMl0pIH0gdCA9IG5bZS50b0xvd2VyQ2FzZSgpICsgIiAiXSB9IHJldHVybiBudWxsID09IHQgPyBudWxsIDogdC5qb2luKCIsICIpIH0sIGdldEFsbFJlc3BvbnNlSGVhZGVyczogZnVuY3Rpb24gKCkgeyByZXR1cm4gaCA/IHAgOiBudWxsIH0sIHNldFJlcXVlc3RIZWFkZXI6IGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiBudWxsID09IGggJiYgKGUgPSBzW2UudG9Mb3dlckNhc2UoKV0gPSBzW2UudG9Mb3dlckNhc2UoKV0gfHwgZSwgYVtlXSA9IHQpLCB0aGlzIH0sIG92ZXJyaWRlTWltZVR5cGU6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBudWxsID09IGggJiYgKHYubWltZVR5cGUgPSBlKSwgdGhpcyB9LCBzdGF0dXNDb2RlOiBmdW5jdGlvbiAoZSkgeyB2YXIgdDsgaWYgKGUpIGlmIChoKSBULmFsd2F5cyhlW1Quc3RhdHVzXSk7IGVsc2UgZm9yICh0IGluIGUpIHdbdF0gPSBbd1t0XSwgZVt0XV07IHJldHVybiB0aGlzIH0sIGFib3J0OiBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IGUgfHwgdTsgcmV0dXJuIGMgJiYgYy5hYm9ydCh0KSwgbCgwLCB0KSwgdGhpcyB9IH07IGlmICh4LnByb21pc2UoVCksIHYudXJsID0gKChlIHx8IHYudXJsIHx8IEV0LmhyZWYpICsgIiIpLnJlcGxhY2UoJHQsIEV0LnByb3RvY29sICsgIi8vIiksIHYudHlwZSA9IHQubWV0aG9kIHx8IHQudHlwZSB8fCB2Lm1ldGhvZCB8fCB2LnR5cGUsIHYuZGF0YVR5cGVzID0gKHYuZGF0YVR5cGUgfHwgIioiKS50b0xvd2VyQ2FzZSgpLm1hdGNoKEQpIHx8IFsiIl0sIG51bGwgPT0gdi5jcm9zc0RvbWFpbikgeyByID0gQy5jcmVhdGVFbGVtZW50KCJhIik7IHRyeSB7IHIuaHJlZiA9IHYudXJsLCByLmhyZWYgPSByLmhyZWYsIHYuY3Jvc3NEb21haW4gPSBYdC5wcm90b2NvbCArICIvLyIgKyBYdC5ob3N0ICE9IHIucHJvdG9jb2wgKyAiLy8iICsgci5ob3N0IH0gY2F0Y2ggKGUpIHsgdi5jcm9zc0RvbWFpbiA9ICEwIH0gfSBpZiAodi5kYXRhICYmIHYucHJvY2Vzc0RhdGEgJiYgInN0cmluZyIgIT0gdHlwZW9mIHYuZGF0YSAmJiAodi5kYXRhID0gY2UucGFyYW0odi5kYXRhLCB2LnRyYWRpdGlvbmFsKSksIFZ0KEJ0LCB2LCB0LCBUKSwgaCkgcmV0dXJuIFQ7IGZvciAoaSBpbiAoZyA9IGNlLmV2ZW50ICYmIHYuZ2xvYmFsKSAmJiAwID09IGNlLmFjdGl2ZSsrICYmIGNlLmV2ZW50LnRyaWdnZXIoImFqYXhTdGFydCIpLCB2LnR5cGUgPSB2LnR5cGUudG9VcHBlckNhc2UoKSwgdi5oYXNDb250ZW50ID0gIUZ0LnRlc3Qodi50eXBlKSwgZiA9IHYudXJsLnJlcGxhY2UoUnQsICIiKSwgdi5oYXNDb250ZW50ID8gdi5kYXRhICYmIHYucHJvY2Vzc0RhdGEgJiYgMCA9PT0gKHYuY29udGVudFR5cGUgfHwgIiIpLmluZGV4T2YoImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpICYmICh2LmRhdGEgPSB2LmRhdGEucmVwbGFjZShNdCwgIisiKSkgOiAobyA9IHYudXJsLnNsaWNlKGYubGVuZ3RoKSwgdi5kYXRhICYmICh2LnByb2Nlc3NEYXRhIHx8ICJzdHJpbmciID09IHR5cGVvZiB2LmRhdGEpICYmIChmICs9IChBdC50ZXN0KGYpID8gIiYiIDogIj8iKSArIHYuZGF0YSwgZGVsZXRlIHYuZGF0YSksICExID09PSB2LmNhY2hlICYmIChmID0gZi5yZXBsYWNlKEl0LCAiJDEiKSwgbyA9IChBdC50ZXN0KGYpID8gIiYiIDogIj8iKSArICJfPSIgKyBqdC5ndWlkKysgKyBvKSwgdi51cmwgPSBmICsgbyksIHYuaWZNb2RpZmllZCAmJiAoY2UubGFzdE1vZGlmaWVkW2ZdICYmIFQuc2V0UmVxdWVzdEhlYWRlcigiSWYtTW9kaWZpZWQtU2luY2UiLCBjZS5sYXN0TW9kaWZpZWRbZl0pLCBjZS5ldGFnW2ZdICYmIFQuc2V0UmVxdWVzdEhlYWRlcigiSWYtTm9uZS1NYXRjaCIsIGNlLmV0YWdbZl0pKSwgKHYuZGF0YSAmJiB2Lmhhc0NvbnRlbnQgJiYgITEgIT09IHYuY29udGVudFR5cGUgfHwgdC5jb250ZW50VHlwZSkgJiYgVC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCB2LmNvbnRlbnRUeXBlKSwgVC5zZXRSZXF1ZXN0SGVhZGVyKCJBY2NlcHQiLCB2LmRhdGFUeXBlc1swXSAmJiB2LmFjY2VwdHNbdi5kYXRhVHlwZXNbMF1dID8gdi5hY2NlcHRzW3YuZGF0YVR5cGVzWzBdXSArICgiKiIgIT09IHYuZGF0YVR5cGVzWzBdID8gIiwgIiArIHp0ICsgIjsgcT0wLjAxIiA6ICIiKSA6IHYuYWNjZXB0c1siKiJdKSwgdi5oZWFkZXJzKSBULnNldFJlcXVlc3RIZWFkZXIoaSwgdi5oZWFkZXJzW2ldKTsgaWYgKHYuYmVmb3JlU2VuZCAmJiAoITEgPT09IHYuYmVmb3JlU2VuZC5jYWxsKHksIFQsIHYpIHx8IGgpKSByZXR1cm4gVC5hYm9ydCgpOyBpZiAodSA9ICJhYm9ydCIsIGIuYWRkKHYuY29tcGxldGUpLCBULmRvbmUodi5zdWNjZXNzKSwgVC5mYWlsKHYuZXJyb3IpLCBjID0gVnQoX3QsIHYsIHQsIFQpKSB7IGlmIChULnJlYWR5U3RhdGUgPSAxLCBnICYmIG0udHJpZ2dlcigiYWpheFNlbmQiLCBbVCwgdl0pLCBoKSByZXR1cm4gVDsgdi5hc3luYyAmJiAwIDwgdi50aW1lb3V0ICYmIChkID0gaWUuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IFQuYWJvcnQoInRpbWVvdXQiKSB9LCB2LnRpbWVvdXQpKTsgdHJ5IHsgaCA9ICExLCBjLnNlbmQoYSwgbCkgfSBjYXRjaCAoZSkgeyBpZiAoaCkgdGhyb3cgZTsgbCgtMSwgZSkgfSB9IGVsc2UgbCgtMSwgIk5vIFRyYW5zcG9ydCIpOyBmdW5jdGlvbiBsKGUsIHQsIG4sIHIpIHsgdmFyIGksIG8sIGEsIHMsIHUsIGwgPSB0OyBoIHx8IChoID0gITAsIGQgJiYgaWUuY2xlYXJUaW1lb3V0KGQpLCBjID0gdm9pZCAwLCBwID0gciB8fCAiIiwgVC5yZWFkeVN0YXRlID0gMCA8IGUgPyA0IDogMCwgaSA9IDIwMCA8PSBlICYmIGUgPCAzMDAgfHwgMzA0ID09PSBlLCBuICYmIChzID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsgdmFyIHIsIGksIG8sIGEsIHMgPSBlLmNvbnRlbnRzLCB1ID0gZS5kYXRhVHlwZXM7IHdoaWxlICgiKiIgPT09IHVbMF0pIHUuc2hpZnQoKSwgdm9pZCAwID09PSByICYmIChyID0gZS5taW1lVHlwZSB8fCB0LmdldFJlc3BvbnNlSGVhZGVyKCJDb250ZW50LVR5cGUiKSk7IGlmIChyKSBmb3IgKGkgaW4gcykgaWYgKHNbaV0gJiYgc1tpXS50ZXN0KHIpKSB7IHUudW5zaGlmdChpKTsgYnJlYWsgfSBpZiAodVswXSBpbiBuKSBvID0gdVswXTsgZWxzZSB7IGZvciAoaSBpbiBuKSB7IGlmICghdVswXSB8fCBlLmNvbnZlcnRlcnNbaSArICIgIiArIHVbMF1dKSB7IG8gPSBpOyBicmVhayB9IGEgfHwgKGEgPSBpKSB9IG8gPSBvIHx8IGEgfSBpZiAobykgcmV0dXJuIG8gIT09IHVbMF0gJiYgdS51bnNoaWZ0KG8pLCBuW29dIH0odiwgVCwgbikpLCAhaSAmJiAtMSA8IGNlLmluQXJyYXkoInNjcmlwdCIsIHYuZGF0YVR5cGVzKSAmJiBjZS5pbkFycmF5KCJqc29uIiwgdi5kYXRhVHlwZXMpIDwgMCAmJiAodi5jb252ZXJ0ZXJzWyJ0ZXh0IHNjcmlwdCJdID0gZnVuY3Rpb24gKCkgeyB9KSwgcyA9IGZ1bmN0aW9uIChlLCB0LCBuLCByKSB7IHZhciBpLCBvLCBhLCBzLCB1LCBsID0ge30sIGMgPSBlLmRhdGFUeXBlcy5zbGljZSgpOyBpZiAoY1sxXSkgZm9yIChhIGluIGUuY29udmVydGVycykgbFthLnRvTG93ZXJDYXNlKCldID0gZS5jb252ZXJ0ZXJzW2FdOyBvID0gYy5zaGlmdCgpOyB3aGlsZSAobykgaWYgKGUucmVzcG9uc2VGaWVsZHNbb10gJiYgKG5bZS5yZXNwb25zZUZpZWxkc1tvXV0gPSB0KSwgIXUgJiYgciAmJiBlLmRhdGFGaWx0ZXIgJiYgKHQgPSBlLmRhdGFGaWx0ZXIodCwgZS5kYXRhVHlwZSkpLCB1ID0gbywgbyA9IGMuc2hpZnQoKSkgaWYgKCIqIiA9PT0gbykgbyA9IHU7IGVsc2UgaWYgKCIqIiAhPT0gdSAmJiB1ICE9PSBvKSB7IGlmICghKGEgPSBsW3UgKyAiICIgKyBvXSB8fCBsWyIqICIgKyBvXSkpIGZvciAoaSBpbiBsKSBpZiAoKHMgPSBpLnNwbGl0KCIgIikpWzFdID09PSBvICYmIChhID0gbFt1ICsgIiAiICsgc1swXV0gfHwgbFsiKiAiICsgc1swXV0pKSB7ICEwID09PSBhID8gYSA9IGxbaV0gOiAhMCAhPT0gbFtpXSAmJiAobyA9IHNbMF0sIGMudW5zaGlmdChzWzFdKSk7IGJyZWFrIH0gaWYgKCEwICE9PSBhKSBpZiAoYSAmJiBlWyJ0aHJvd3MiXSkgdCA9IGEodCk7IGVsc2UgdHJ5IHsgdCA9IGEodCkgfSBjYXRjaCAoZSkgeyByZXR1cm4geyBzdGF0ZTogInBhcnNlcmVycm9yIiwgZXJyb3I6IGEgPyBlIDogIk5vIGNvbnZlcnNpb24gZnJvbSAiICsgdSArICIgdG8gIiArIG8gfSB9IH0gcmV0dXJuIHsgc3RhdGU6ICJzdWNjZXNzIiwgZGF0YTogdCB9IH0odiwgcywgVCwgaSksIGkgPyAodi5pZk1vZGlmaWVkICYmICgodSA9IFQuZ2V0UmVzcG9uc2VIZWFkZXIoIkxhc3QtTW9kaWZpZWQiKSkgJiYgKGNlLmxhc3RNb2RpZmllZFtmXSA9IHUpLCAodSA9IFQuZ2V0UmVzcG9uc2VIZWFkZXIoImV0YWciKSkgJiYgKGNlLmV0YWdbZl0gPSB1KSksIDIwNCA9PT0gZSB8fCAiSEVBRCIgPT09IHYudHlwZSA/IGwgPSAibm9jb250ZW50IiA6IDMwNCA9PT0gZSA/IGwgPSAibm90bW9kaWZpZWQiIDogKGwgPSBzLnN0YXRlLCBvID0gcy5kYXRhLCBpID0gIShhID0gcy5lcnJvcikpKSA6IChhID0gbCwgIWUgJiYgbCB8fCAobCA9ICJlcnJvciIsIGUgPCAwICYmIChlID0gMCkpKSwgVC5zdGF0dXMgPSBlLCBULnN0YXR1c1RleHQgPSAodCB8fCBsKSArICIiLCBpID8geC5yZXNvbHZlV2l0aCh5LCBbbywgbCwgVF0pIDogeC5yZWplY3RXaXRoKHksIFtULCBsLCBhXSksIFQuc3RhdHVzQ29kZSh3KSwgdyA9IHZvaWQgMCwgZyAmJiBtLnRyaWdnZXIoaSA/ICJhamF4U3VjY2VzcyIgOiAiYWpheEVycm9yIiwgW1QsIHYsIGkgPyBvIDogYV0pLCBiLmZpcmVXaXRoKHksIFtULCBsXSksIGcgJiYgKG0udHJpZ2dlcigiYWpheENvbXBsZXRlIiwgW1QsIHZdKSwgLS1jZS5hY3RpdmUgfHwgY2UuZXZlbnQudHJpZ2dlcigiYWpheFN0b3AiKSkpIH0gcmV0dXJuIFQgfSwgZ2V0SlNPTjogZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIGNlLmdldChlLCB0LCBuLCAianNvbiIpIH0sIGdldFNjcmlwdDogZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIGNlLmdldChlLCB2b2lkIDAsIHQsICJzY3JpcHQiKSB9IH0pLCBjZS5lYWNoKFsiZ2V0IiwgInBvc3QiXSwgZnVuY3Rpb24gKGUsIGkpIHsgY2VbaV0gPSBmdW5jdGlvbiAoZSwgdCwgbiwgcikgeyByZXR1cm4gdih0KSAmJiAociA9IHIgfHwgbiwgbiA9IHQsIHQgPSB2b2lkIDApLCBjZS5hamF4KGNlLmV4dGVuZCh7IHVybDogZSwgdHlwZTogaSwgZGF0YVR5cGU6IHIsIGRhdGE6IHQsIHN1Y2Nlc3M6IG4gfSwgY2UuaXNQbGFpbk9iamVjdChlKSAmJiBlKSkgfSB9KSwgY2UuYWpheFByZWZpbHRlcihmdW5jdGlvbiAoZSkgeyB2YXIgdDsgZm9yICh0IGluIGUuaGVhZGVycykgImNvbnRlbnQtdHlwZSIgPT09IHQudG9Mb3dlckNhc2UoKSAmJiAoZS5jb250ZW50VHlwZSA9IGUuaGVhZGVyc1t0XSB8fCAiIikgfSksIGNlLl9ldmFsVXJsID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIGNlLmFqYXgoeyB1cmw6IGUsIHR5cGU6ICJHRVQiLCBkYXRhVHlwZTogInNjcmlwdCIsIGNhY2hlOiAhMCwgYXN5bmM6ICExLCBnbG9iYWw6ICExLCBjb252ZXJ0ZXJzOiB7ICJ0ZXh0IHNjcmlwdCI6IGZ1bmN0aW9uICgpIHsgfSB9LCBkYXRhRmlsdGVyOiBmdW5jdGlvbiAoZSkgeyBjZS5nbG9iYWxFdmFsKGUsIHQsIG4pIH0gfSkgfSwgY2UuZm4uZXh0ZW5kKHsgd3JhcEFsbDogZnVuY3Rpb24gKGUpIHsgdmFyIHQ7IHJldHVybiB0aGlzWzBdICYmICh2KGUpICYmIChlID0gZS5jYWxsKHRoaXNbMF0pKSwgdCA9IGNlKGUsIHRoaXNbMF0ub3duZXJEb2N1bWVudCkuZXEoMCkuY2xvbmUoITApLCB0aGlzWzBdLnBhcmVudE5vZGUgJiYgdC5pbnNlcnRCZWZvcmUodGhpc1swXSksIHQubWFwKGZ1bmN0aW9uICgpIHsgdmFyIGUgPSB0aGlzOyB3aGlsZSAoZS5maXJzdEVsZW1lbnRDaGlsZCkgZSA9IGUuZmlyc3RFbGVtZW50Q2hpbGQ7IHJldHVybiBlIH0pLmFwcGVuZCh0aGlzKSksIHRoaXMgfSwgd3JhcElubmVyOiBmdW5jdGlvbiAobikgeyByZXR1cm4gdihuKSA/IHRoaXMuZWFjaChmdW5jdGlvbiAoZSkgeyBjZSh0aGlzKS53cmFwSW5uZXIobi5jYWxsKHRoaXMsIGUpKSB9KSA6IHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IHZhciBlID0gY2UodGhpcyksIHQgPSBlLmNvbnRlbnRzKCk7IHQubGVuZ3RoID8gdC53cmFwQWxsKG4pIDogZS5hcHBlbmQobikgfSkgfSwgd3JhcDogZnVuY3Rpb24gKHQpIHsgdmFyIG4gPSB2KHQpOyByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChlKSB7IGNlKHRoaXMpLndyYXBBbGwobiA/IHQuY2FsbCh0aGlzLCBlKSA6IHQpIH0pIH0sIHVud3JhcDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHRoaXMucGFyZW50KGUpLm5vdCgiYm9keSIpLmVhY2goZnVuY3Rpb24gKCkgeyBjZSh0aGlzKS5yZXBsYWNlV2l0aCh0aGlzLmNoaWxkTm9kZXMpIH0pLCB0aGlzIH0gfSksIGNlLmV4cHIucHNldWRvcy5oaWRkZW4gPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gIWNlLmV4cHIucHNldWRvcy52aXNpYmxlKGUpIH0sIGNlLmV4cHIucHNldWRvcy52aXNpYmxlID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuICEhKGUub2Zmc2V0V2lkdGggfHwgZS5vZmZzZXRIZWlnaHQgfHwgZS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCkgfSwgY2UuYWpheFNldHRpbmdzLnhociA9IGZ1bmN0aW9uICgpIHsgdHJ5IHsgcmV0dXJuIG5ldyBpZS5YTUxIdHRwUmVxdWVzdCB9IGNhdGNoIChlKSB7IH0gfTsgdmFyIFl0ID0geyAwOiAyMDAsIDEyMjM6IDIwNCB9LCBRdCA9IGNlLmFqYXhTZXR0aW5ncy54aHIoKTsgbGUuY29ycyA9ICEhUXQgJiYgIndpdGhDcmVkZW50aWFscyIgaW4gUXQsIGxlLmFqYXggPSBRdCA9ICEhUXQsIGNlLmFqYXhUcmFuc3BvcnQoZnVuY3Rpb24gKGkpIHsgdmFyIG8sIGE7IGlmIChsZS5jb3JzIHx8IFF0ICYmICFpLmNyb3NzRG9tYWluKSByZXR1cm4geyBzZW5kOiBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiwgciA9IGkueGhyKCk7IGlmIChyLm9wZW4oaS50eXBlLCBpLnVybCwgaS5hc3luYywgaS51c2VybmFtZSwgaS5wYXNzd29yZCksIGkueGhyRmllbGRzKSBmb3IgKG4gaW4gaS54aHJGaWVsZHMpIHJbbl0gPSBpLnhockZpZWxkc1tuXTsgZm9yIChuIGluIGkubWltZVR5cGUgJiYgci5vdmVycmlkZU1pbWVUeXBlICYmIHIub3ZlcnJpZGVNaW1lVHlwZShpLm1pbWVUeXBlKSwgaS5jcm9zc0RvbWFpbiB8fCBlWyJYLVJlcXVlc3RlZC1XaXRoIl0gfHwgKGVbIlgtUmVxdWVzdGVkLVdpdGgiXSA9ICJYTUxIdHRwUmVxdWVzdCIpLCBlKSByLnNldFJlcXVlc3RIZWFkZXIobiwgZVtuXSk7IG8gPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyBvICYmIChvID0gYSA9IHIub25sb2FkID0gci5vbmVycm9yID0gci5vbmFib3J0ID0gci5vbnRpbWVvdXQgPSByLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGwsICJhYm9ydCIgPT09IGUgPyByLmFib3J0KCkgOiAiZXJyb3IiID09PSBlID8gIm51bWJlciIgIT0gdHlwZW9mIHIuc3RhdHVzID8gdCgwLCAiZXJyb3IiKSA6IHQoci5zdGF0dXMsIHIuc3RhdHVzVGV4dCkgOiB0KFl0W3Iuc3RhdHVzXSB8fCByLnN0YXR1cywgci5zdGF0dXNUZXh0LCAidGV4dCIgIT09IChyLnJlc3BvbnNlVHlwZSB8fCAidGV4dCIpIHx8ICJzdHJpbmciICE9IHR5cGVvZiByLnJlc3BvbnNlVGV4dCA/IHsgYmluYXJ5OiByLnJlc3BvbnNlIH0gOiB7IHRleHQ6IHIucmVzcG9uc2VUZXh0IH0sIHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpKSB9IH0sIHIub25sb2FkID0gbygpLCBhID0gci5vbmVycm9yID0gci5vbnRpbWVvdXQgPSBvKCJlcnJvciIpLCB2b2lkIDAgIT09IHIub25hYm9ydCA/IHIub25hYm9ydCA9IGEgOiByLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsgNCA9PT0gci5yZWFkeVN0YXRlICYmIGllLnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBvICYmIGEoKSB9KSB9LCBvID0gbygiYWJvcnQiKTsgdHJ5IHsgci5zZW5kKGkuaGFzQ29udGVudCAmJiBpLmRhdGEgfHwgbnVsbCkgfSBjYXRjaCAoZSkgeyBpZiAobykgdGhyb3cgZSB9IH0sIGFib3J0OiBmdW5jdGlvbiAoKSB7IG8gJiYgbygpIH0gfSB9KSwgY2UuYWpheFByZWZpbHRlcihmdW5jdGlvbiAoZSkgeyBlLmNyb3NzRG9tYWluICYmIChlLmNvbnRlbnRzLnNjcmlwdCA9ICExKSB9KSwgY2UuYWpheFNldHVwKHsgYWNjZXB0czogeyBzY3JpcHQ6ICJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdCIgfSwgY29udGVudHM6IHsgc2NyaXB0OiAvXGIoPzpqYXZhfGVjbWEpc2NyaXB0XGIvIH0sIGNvbnZlcnRlcnM6IHsgInRleHQgc2NyaXB0IjogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGNlLmdsb2JhbEV2YWwoZSksIGUgfSB9IH0pLCBjZS5hamF4UHJlZmlsdGVyKCJzY3JpcHQiLCBmdW5jdGlvbiAoZSkgeyB2b2lkIDAgPT09IGUuY2FjaGUgJiYgKGUuY2FjaGUgPSAhMSksIGUuY3Jvc3NEb21haW4gJiYgKGUudHlwZSA9ICJHRVQiKSB9KSwgY2UuYWpheFRyYW5zcG9ydCgic2NyaXB0IiwgZnVuY3Rpb24gKG4pIHsgdmFyIHIsIGk7IGlmIChuLmNyb3NzRG9tYWluIHx8IG4uc2NyaXB0QXR0cnMpIHJldHVybiB7IHNlbmQ6IGZ1bmN0aW9uIChlLCB0KSB7IHIgPSBjZSgiPHNjcmlwdD4iKS5hdHRyKG4uc2NyaXB0QXR0cnMgfHwge30pLnByb3AoeyBjaGFyc2V0OiBuLnNjcmlwdENoYXJzZXQsIHNyYzogbi51cmwgfSkub24oImxvYWQgZXJyb3IiLCBpID0gZnVuY3Rpb24gKGUpIHsgci5yZW1vdmUoKSwgaSA9IG51bGwsIGUgJiYgdCgiZXJyb3IiID09PSBlLnR5cGUgPyA0MDQgOiAyMDAsIGUudHlwZSkgfSksIEMuaGVhZC5hcHBlbmRDaGlsZChyWzBdKSB9LCBhYm9ydDogZnVuY3Rpb24gKCkgeyBpICYmIGkoKSB9IH0gfSk7IHZhciBKdCwgS3QgPSBbXSwgWnQgPSAvKD0pXD8oPz0mfCQpfFw/XD8vOyBjZS5hamF4U2V0dXAoeyBqc29ucDogImNhbGxiYWNrIiwganNvbnBDYWxsYmFjazogZnVuY3Rpb24gKCkgeyB2YXIgZSA9IEt0LnBvcCgpIHx8IGNlLmV4cGFuZG8gKyAiXyIgKyBqdC5ndWlkKys7IHJldHVybiB0aGlzW2VdID0gITAsIGUgfSB9KSwgY2UuYWpheFByZWZpbHRlcigianNvbiBqc29ucCIsIGZ1bmN0aW9uIChlLCB0LCBuKSB7IHZhciByLCBpLCBvLCBhID0gITEgIT09IGUuanNvbnAgJiYgKFp0LnRlc3QoZS51cmwpID8gInVybCIgOiAic3RyaW5nIiA9PSB0eXBlb2YgZS5kYXRhICYmIDAgPT09IChlLmNvbnRlbnRUeXBlIHx8ICIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSAmJiBadC50ZXN0KGUuZGF0YSkgJiYgImRhdGEiKTsgaWYgKGEgfHwgImpzb25wIiA9PT0gZS5kYXRhVHlwZXNbMF0pIHJldHVybiByID0gZS5qc29ucENhbGxiYWNrID0gdihlLmpzb25wQ2FsbGJhY2spID8gZS5qc29ucENhbGxiYWNrKCkgOiBlLmpzb25wQ2FsbGJhY2ssIGEgPyBlW2FdID0gZVthXS5yZXBsYWNlKFp0LCAiJDEiICsgcikgOiAhMSAhPT0gZS5qc29ucCAmJiAoZS51cmwgKz0gKEF0LnRlc3QoZS51cmwpID8gIiYiIDogIj8iKSArIGUuanNvbnAgKyAiPSIgKyByKSwgZS5jb252ZXJ0ZXJzWyJzY3JpcHQganNvbiJdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gbyB8fCBjZS5lcnJvcihyICsgIiB3YXMgbm90IGNhbGxlZCIpLCBvWzBdIH0sIGUuZGF0YVR5cGVzWzBdID0gImpzb24iLCBpID0gaWVbcl0sIGllW3JdID0gZnVuY3Rpb24gKCkgeyBvID0gYXJndW1lbnRzIH0sIG4uYWx3YXlzKGZ1bmN0aW9uICgpIHsgdm9pZCAwID09PSBpID8gY2UoaWUpLnJlbW92ZVByb3AocikgOiBpZVtyXSA9IGksIGVbcl0gJiYgKGUuanNvbnBDYWxsYmFjayA9IHQuanNvbnBDYWxsYmFjaywgS3QucHVzaChyKSksIG8gJiYgdihpKSAmJiBpKG9bMF0pLCBvID0gaSA9IHZvaWQgMCB9KSwgInNjcmlwdCIgfSksIGxlLmNyZWF0ZUhUTUxEb2N1bWVudCA9ICgoSnQgPSBDLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikuYm9keSkuaW5uZXJIVE1MID0gIjxmb3JtPjwvZm9ybT48Zm9ybT48L2Zvcm0+IiwgMiA9PT0gSnQuY2hpbGROb2Rlcy5sZW5ndGgpLCBjZS5wYXJzZUhUTUwgPSBmdW5jdGlvbiAoZSwgdCwgbikgeyByZXR1cm4gInN0cmluZyIgIT0gdHlwZW9mIGUgPyBbXSA6ICgiYm9vbGVhbiIgPT0gdHlwZW9mIHQgJiYgKG4gPSB0LCB0ID0gITEpLCB0IHx8IChsZS5jcmVhdGVIVE1MRG9jdW1lbnQgPyAoKHIgPSAodCA9IEMuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50KCIiKSkuY3JlYXRlRWxlbWVudCgiYmFzZSIpKS5ocmVmID0gQy5sb2NhdGlvbi5ocmVmLCB0LmhlYWQuYXBwZW5kQ2hpbGQocikpIDogdCA9IEMpLCBvID0gIW4gJiYgW10sIChpID0gdy5leGVjKGUpKSA/IFt0LmNyZWF0ZUVsZW1lbnQoaVsxXSldIDogKGkgPSBBZShbZV0sIHQsIG8pLCBvICYmIG8ubGVuZ3RoICYmIGNlKG8pLnJlbW92ZSgpLCBjZS5tZXJnZShbXSwgaS5jaGlsZE5vZGVzKSkpOyB2YXIgciwgaSwgbyB9LCBjZS5mbi5sb2FkID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsgdmFyIHIsIGksIG8sIGEgPSB0aGlzLCBzID0gZS5pbmRleE9mKCIgIik7IHJldHVybiAtMSA8IHMgJiYgKHIgPSBUdChlLnNsaWNlKHMpKSwgZSA9IGUuc2xpY2UoMCwgcykpLCB2KHQpID8gKG4gPSB0LCB0ID0gdm9pZCAwKSA6IHQgJiYgIm9iamVjdCIgPT0gdHlwZW9mIHQgJiYgKGkgPSAiUE9TVCIpLCAwIDwgYS5sZW5ndGggJiYgY2UuYWpheCh7IHVybDogZSwgdHlwZTogaSB8fCAiR0VUIiwgZGF0YVR5cGU6ICJodG1sIiwgZGF0YTogdCB9KS5kb25lKGZ1bmN0aW9uIChlKSB7IG8gPSBhcmd1bWVudHMsIGEuaHRtbChyID8gY2UoIjxkaXY+IikuYXBwZW5kKGNlLnBhcnNlSFRNTChlKSkuZmluZChyKSA6IGUpIH0pLmFsd2F5cyhuICYmIGZ1bmN0aW9uIChlLCB0KSB7IGEuZWFjaChmdW5jdGlvbiAoKSB7IG4uYXBwbHkodGhpcywgbyB8fCBbZS5yZXNwb25zZVRleHQsIHQsIGVdKSB9KSB9KSwgdGhpcyB9LCBjZS5leHByLnBzZXVkb3MuYW5pbWF0ZWQgPSBmdW5jdGlvbiAodCkgeyByZXR1cm4gY2UuZ3JlcChjZS50aW1lcnMsIGZ1bmN0aW9uIChlKSB7IHJldHVybiB0ID09PSBlLmVsZW0gfSkubGVuZ3RoIH0sIGNlLm9mZnNldCA9IHsgc2V0T2Zmc2V0OiBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciwgaSwgbywgYSwgcywgdSwgbCA9IGNlLmNzcyhlLCAicG9zaXRpb24iKSwgYyA9IGNlKGUpLCBmID0ge307ICJzdGF0aWMiID09PSBsICYmIChlLnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIiksIHMgPSBjLm9mZnNldCgpLCBvID0gY2UuY3NzKGUsICJ0b3AiKSwgdSA9IGNlLmNzcyhlLCAibGVmdCIpLCAoImFic29sdXRlIiA9PT0gbCB8fCAiZml4ZWQiID09PSBsKSAmJiAtMSA8IChvICsgdSkuaW5kZXhPZigiYXV0byIpID8gKGEgPSAociA9IGMucG9zaXRpb24oKSkudG9wLCBpID0gci5sZWZ0KSA6IChhID0gcGFyc2VGbG9hdChvKSB8fCAwLCBpID0gcGFyc2VGbG9hdCh1KSB8fCAwKSwgdih0KSAmJiAodCA9IHQuY2FsbChlLCBuLCBjZS5leHRlbmQoe30sIHMpKSksIG51bGwgIT0gdC50b3AgJiYgKGYudG9wID0gdC50b3AgLSBzLnRvcCArIGEpLCBudWxsICE9IHQubGVmdCAmJiAoZi5sZWZ0ID0gdC5sZWZ0IC0gcy5sZWZ0ICsgaSksICJ1c2luZyIgaW4gdCA/IHQudXNpbmcuY2FsbChlLCBmKSA6IGMuY3NzKGYpIH0gfSwgY2UuZm4uZXh0ZW5kKHsgb2Zmc2V0OiBmdW5jdGlvbiAodCkgeyBpZiAoYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHZvaWQgMCA9PT0gdCA/IHRoaXMgOiB0aGlzLmVhY2goZnVuY3Rpb24gKGUpIHsgY2Uub2Zmc2V0LnNldE9mZnNldCh0aGlzLCB0LCBlKSB9KTsgdmFyIGUsIG4sIHIgPSB0aGlzWzBdOyByZXR1cm4gciA/IHIuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGggPyAoZSA9IHIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksIG4gPSByLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcsIHsgdG9wOiBlLnRvcCArIG4ucGFnZVlPZmZzZXQsIGxlZnQ6IGUubGVmdCArIG4ucGFnZVhPZmZzZXQgfSkgOiB7IHRvcDogMCwgbGVmdDogMCB9IDogdm9pZCAwIH0sIHBvc2l0aW9uOiBmdW5jdGlvbiAoKSB7IGlmICh0aGlzWzBdKSB7IHZhciBlLCB0LCBuLCByID0gdGhpc1swXSwgaSA9IHsgdG9wOiAwLCBsZWZ0OiAwIH07IGlmICgiZml4ZWQiID09PSBjZS5jc3MociwgInBvc2l0aW9uIikpIHQgPSByLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOyBlbHNlIHsgdCA9IHRoaXMub2Zmc2V0KCksIG4gPSByLm93bmVyRG9jdW1lbnQsIGUgPSByLm9mZnNldFBhcmVudCB8fCBuLmRvY3VtZW50RWxlbWVudDsgd2hpbGUgKGUgJiYgKGUgPT09IG4uYm9keSB8fCBlID09PSBuLmRvY3VtZW50RWxlbWVudCkgJiYgInN0YXRpYyIgPT09IGNlLmNzcyhlLCAicG9zaXRpb24iKSkgZSA9IGUucGFyZW50Tm9kZTsgZSAmJiBlICE9PSByICYmIDEgPT09IGUubm9kZVR5cGUgJiYgKChpID0gY2UoZSkub2Zmc2V0KCkpLnRvcCArPSBjZS5jc3MoZSwgImJvcmRlclRvcFdpZHRoIiwgITApLCBpLmxlZnQgKz0gY2UuY3NzKGUsICJib3JkZXJMZWZ0V2lkdGgiLCAhMCkpIH0gcmV0dXJuIHsgdG9wOiB0LnRvcCAtIGkudG9wIC0gY2UuY3NzKHIsICJtYXJnaW5Ub3AiLCAhMCksIGxlZnQ6IHQubGVmdCAtIGkubGVmdCAtIGNlLmNzcyhyLCAibWFyZ2luTGVmdCIsICEwKSB9IH0gfSwgb2Zmc2V0UGFyZW50OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoKSB7IHZhciBlID0gdGhpcy5vZmZzZXRQYXJlbnQ7IHdoaWxlIChlICYmICJzdGF0aWMiID09PSBjZS5jc3MoZSwgInBvc2l0aW9uIikpIGUgPSBlLm9mZnNldFBhcmVudDsgcmV0dXJuIGUgfHwgSiB9KSB9IH0pLCBjZS5lYWNoKHsgc2Nyb2xsTGVmdDogInBhZ2VYT2Zmc2V0Iiwgc2Nyb2xsVG9wOiAicGFnZVlPZmZzZXQiIH0sIGZ1bmN0aW9uICh0LCBpKSB7IHZhciBvID0gInBhZ2VZT2Zmc2V0IiA9PT0gaTsgY2UuZm5bdF0gPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gTSh0aGlzLCBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgcjsgaWYgKHkoZSkgPyByID0gZSA6IDkgPT09IGUubm9kZVR5cGUgJiYgKHIgPSBlLmRlZmF1bHRWaWV3KSwgdm9pZCAwID09PSBuKSByZXR1cm4gciA/IHJbaV0gOiBlW3RdOyByID8gci5zY3JvbGxUbyhvID8gci5wYWdlWE9mZnNldCA6IG4sIG8gPyBuIDogci5wYWdlWU9mZnNldCkgOiBlW3RdID0gbiB9LCB0LCBlLCBhcmd1bWVudHMubGVuZ3RoKSB9IH0pLCBjZS5lYWNoKFsidG9wIiwgImxlZnQiXSwgZnVuY3Rpb24gKGUsIG4pIHsgY2UuY3NzSG9va3Nbbl0gPSBZZShsZS5waXhlbFBvc2l0aW9uLCBmdW5jdGlvbiAoZSwgdCkgeyBpZiAodCkgcmV0dXJuIHQgPSBHZShlLCBuKSwgX2UudGVzdCh0KSA/IGNlKGUpLnBvc2l0aW9uKClbbl0gKyAicHgiIDogdCB9KSB9KSwgY2UuZWFjaCh7IEhlaWdodDogImhlaWdodCIsIFdpZHRoOiAid2lkdGgiIH0sIGZ1bmN0aW9uIChhLCBzKSB7IGNlLmVhY2goeyBwYWRkaW5nOiAiaW5uZXIiICsgYSwgY29udGVudDogcywgIiI6ICJvdXRlciIgKyBhIH0sIGZ1bmN0aW9uIChyLCBvKSB7IGNlLmZuW29dID0gZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4gPSBhcmd1bWVudHMubGVuZ3RoICYmIChyIHx8ICJib29sZWFuIiAhPSB0eXBlb2YgZSksIGkgPSByIHx8ICghMCA9PT0gZSB8fCAhMCA9PT0gdCA/ICJtYXJnaW4iIDogImJvcmRlciIpOyByZXR1cm4gTSh0aGlzLCBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgcjsgcmV0dXJuIHkoZSkgPyAwID09PSBvLmluZGV4T2YoIm91dGVyIikgPyBlWyJpbm5lciIgKyBhXSA6IGUuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyJjbGllbnQiICsgYV0gOiA5ID09PSBlLm5vZGVUeXBlID8gKHIgPSBlLmRvY3VtZW50RWxlbWVudCwgTWF0aC5tYXgoZS5ib2R5WyJzY3JvbGwiICsgYV0sIHJbInNjcm9sbCIgKyBhXSwgZS5ib2R5WyJvZmZzZXQiICsgYV0sIHJbIm9mZnNldCIgKyBhXSwgclsiY2xpZW50IiArIGFdKSkgOiB2b2lkIDAgPT09IG4gPyBjZS5jc3MoZSwgdCwgaSkgOiBjZS5zdHlsZShlLCB0LCBuLCBpKSB9LCBzLCBuID8gZSA6IHZvaWQgMCwgbikgfSB9KSB9KSwgY2UuZWFjaChbImFqYXhTdGFydCIsICJhamF4U3RvcCIsICJhamF4Q29tcGxldGUiLCAiYWpheEVycm9yIiwgImFqYXhTdWNjZXNzIiwgImFqYXhTZW5kIl0sIGZ1bmN0aW9uIChlLCB0KSB7IGNlLmZuW3RdID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHRoaXMub24odCwgZSkgfSB9KSwgY2UuZm4uZXh0ZW5kKHsgYmluZDogZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIHRoaXMub24oZSwgbnVsbCwgdCwgbikgfSwgdW5iaW5kOiBmdW5jdGlvbiAoZSwgdCkgeyByZXR1cm4gdGhpcy5vZmYoZSwgbnVsbCwgdCkgfSwgZGVsZWdhdGU6IGZ1bmN0aW9uIChlLCB0LCBuLCByKSB7IHJldHVybiB0aGlzLm9uKHQsIGUsIG4sIHIpIH0sIHVuZGVsZWdhdGU6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHJldHVybiAxID09PSBhcmd1bWVudHMubGVuZ3RoID8gdGhpcy5vZmYoZSwgIioqIikgOiB0aGlzLm9mZih0LCBlIHx8ICIqKiIsIG4pIH0sIGhvdmVyOiBmdW5jdGlvbiAoZSwgdCkgeyByZXR1cm4gdGhpcy5vbigibW91c2VlbnRlciIsIGUpLm9uKCJtb3VzZWxlYXZlIiwgdCB8fCBlKSB9IH0pLCBjZS5lYWNoKCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgcmVzaXplIHNjcm9sbCBjbGljayBkYmxjbGljayBtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIgbW91c2VsZWF2ZSBjaGFuZ2Ugc2VsZWN0IHN1Ym1pdCBrZXlkb3duIGtleXByZXNzIGtleXVwIGNvbnRleHRtZW51Ii5zcGxpdCgiICIpLCBmdW5jdGlvbiAoZSwgbikgeyBjZS5mbltuXSA9IGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiAwIDwgYXJndW1lbnRzLmxlbmd0aCA/IHRoaXMub24obiwgbnVsbCwgZSwgdCkgOiB0aGlzLnRyaWdnZXIobikgfSB9KTsgdmFyIGVuID0gL15bXHNcdUZFRkZceEEwXSt8KFteXHNcdUZFRkZceEEwXSlbXHNcdUZFRkZceEEwXSskL2c7IGNlLnByb3h5ID0gZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4sIHIsIGk7IGlmICgic3RyaW5nIiA9PSB0eXBlb2YgdCAmJiAobiA9IGVbdF0sIHQgPSBlLCBlID0gbiksIHYoZSkpIHJldHVybiByID0gYWUuY2FsbChhcmd1bWVudHMsIDIpLCAoaSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGUuYXBwbHkodCB8fCB0aGlzLCByLmNvbmNhdChhZS5jYWxsKGFyZ3VtZW50cykpKSB9KS5ndWlkID0gZS5ndWlkID0gZS5ndWlkIHx8IGNlLmd1aWQrKywgaSB9LCBjZS5ob2xkUmVhZHkgPSBmdW5jdGlvbiAoZSkgeyBlID8gY2UucmVhZHlXYWl0KysgOiBjZS5yZWFkeSghMCkgfSwgY2UuaXNBcnJheSA9IEFycmF5LmlzQXJyYXksIGNlLnBhcnNlSlNPTiA9IEpTT04ucGFyc2UsIGNlLm5vZGVOYW1lID0gZmUsIGNlLmlzRnVuY3Rpb24gPSB2LCBjZS5pc1dpbmRvdyA9IHksIGNlLmNhbWVsQ2FzZSA9IEYsIGNlLnR5cGUgPSB4LCBjZS5ub3cgPSBEYXRlLm5vdywgY2UuaXNOdW1lcmljID0gZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBjZS50eXBlKGUpOyByZXR1cm4gKCJudW1iZXIiID09PSB0IHx8ICJzdHJpbmciID09PSB0KSAmJiAhaXNOYU4oZSAtIHBhcnNlRmxvYXQoZSkpIH0sIGNlLnRyaW0gPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gbnVsbCA9PSBlID8gIiIgOiAoZSArICIiKS5yZXBsYWNlKGVuLCAiJDEiKSB9LCAiZnVuY3Rpb24iID09IHR5cGVvZiBkZWZpbmUgJiYgZGVmaW5lLmFtZCAmJiBkZWZpbmUoImpxdWVyeSIsIFtdLCBmdW5jdGlvbiAoKSB7IHJldHVybiBjZSB9KTsgdmFyIHRuID0gaWUualF1ZXJ5LCBubiA9IGllLiQ7IHJldHVybiBjZS5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGllLiQgPT09IGNlICYmIChpZS4kID0gbm4pLCBlICYmIGllLmpRdWVyeSA9PT0gY2UgJiYgKGllLmpRdWVyeSA9IHRuKSwgY2UgfSwgInVuZGVmaW5lZCIgPT0gdHlwZW9mIGUgJiYgKGllLmpRdWVyeSA9IGllLiQgPSBjZSksIGNlIH0pOw==";
        jq = atob(jq);
        new Function(jq)();

    </script>
    <script>
        var GenLoadWorker = function () {
        };
        GenLoadWorker.prototype = {
            loadJSasync: function () {
                let jsLinks = ["https://www.googletagmanager.com/gtag/js?id=G-LTGW85D79N"];
                for (let js of jsLinks) {
                    let usedLaterScript = document.createElement('script');
                    usedLaterScript.src = js;
                    usedLaterScript.async = true;
                    document.body.appendChild(usedLaterScript);
                }
            },
            loadCSSasync: function () {
                let asyncStyleSheets = ["/style/video-js.css"];
                for (let ss of asyncStyleSheets) {
                    let link = document.createElement('link');
                    link.setAttribute('rel', 'stylesheet');
                    link.setAttribute('href', ss);
                    document.head.appendChild(link);
                }
            },
            imgResize: function () {

            },
            modalLoad: function () {
                let modal = document.getElementById("myModal");
                let imgs = document.getElementsByClassName("img0");
                let modalImg = document.getElementById("img01");
                for (let item of imgs) {
                    item.onclick = function () {
                        modal.style.display = "flex";
                        modalImg.src = this.src;
                    }
                }
                let span = document.getElementsByClassName("close")[0];
                span.onclick = function () {
                    modal.style.display = "none";
                }
            },
            run: function () {
                this.imgResize();
                //   this.loadCSSasync();
                let gdprA = localStorage.getItem("gdprAccepted");
                if (gdprA === "true") {
                    this.loadJSasync();
                }
                this.modalLoad();
            }
        };

        var GGenLoadWorker = new GenLoadWorker();
        $(window).on("DOMContentLoaded", function () {
            GGenLoadWorker.run();
        });

        $(window).on("load", function () {
            setTimeout(function () {
                document.getElementById("acceptCookie").addEventListener("click", () => {
                    localStorage.setItem("gdprAccepted", "true");
                    let popUp = document.getElementById("cookiePopup");
                    popUp.style.display = "none";
                    GGenLoadWorker.loadJSasync();
                });
                document.getElementById("closeCookie").addEventListener("click", () => {
                    localStorage.setItem("gdprAccepted", "false");
                    localStorage.setItem("gdprInit", Math.floor(Date.now() / 1000));

                    let popUp = document.getElementById("cookiePopup");
                    popUp.style.display = "none";
                });

                let gdprA = localStorage.getItem("gdprAccepted");
                if (gdprA === "true") {
                } else {
                    let gdprI = localStorage.getItem("gdprInit");
                    let popUp = document.getElementById("cookiePopup");
                    if ((gdprI !== undefined) && (gdprI != null)) {
                        if ((Math.floor(Date.now() / 1000) - parseInt(gdprI)) > 86400 * 3) {
                            popUp.style.display = "flex";
                        }
                    } else {
                        popUp.style.display = "flex";
                    }
                }
            }, 2000);
        });


        let slideIndex = 1;
        showSlides(slideIndex);

        function plusSlides(event, n) {
            event.preventDefault();
            showSlides(slideIndex += n);
        }

        function currentSlide(n) {
            showSlides(slideIndex = n);
        }

        function showSlides(n) {
            let i;
            let slides = document.getElementsByClassName("mySlides");
            let dots = document.getElementsByClassName("dot");
            if (n > slides.length) { slideIndex = 1 }
            if (n < 1) { slideIndex = slides.length }
            for (i = 0; i < slides.length; i++) {
                slides[i].style.display = "none";
            }
            for (i = 0; i < dots.length; i++) {
                dots[i].className = dots[i].className.replace(" active", "");
            }
            slides[slideIndex - 1].style.display = "block";
            dots[slideIndex - 1].className += " active";
        }

        function startPlayer() {
            var g_player;
            let playimg = document.getElementById("imgPlay");
            playimg.style.display = "none";
            let player = document.getElementById("my-video");
            player.style.display = "block";


            let link = document.createElement('link');
            link.setAttribute('rel', 'stylesheet');
            link.setAttribute('href', "/style/video-js.css");
            link.onload = () => {
                let usedLaterScript = document.createElement('script');
                usedLaterScript.src = "/js/video.min.js";
                usedLaterScript.async = false;
                usedLaterScript.onload = () => {
                    let _player = videojs('my-video');
                    _player.on('ready', function () {
                        g_player = _player;
                    });
                }
                document.body.appendChild(usedLaterScript);
            }
            document.head.appendChild(link);

            let _int = setInterval(() => {
                if ((g_player !== undefined) && (g_player.play !== undefined)) {
                    g_player.play();
                    clearInterval(_int);
                }
            }, 15);
        }

        var checkoutDone;
        function coinbaseStarted() {
            checkoutDone = false;

            BuyWithCrypto.registerCallback('onSuccess', function (e) {
                if (checkoutDone === false) {
                    checkoutDone = true;
                    let audio = new Audio('sounds/notification.wav');
                    setTimeout(function () {
                        let toast = document.getElementById("toast");
                        document.getElementById("oid").innerText = e.code;
                        audio.play();
                        toast.className = "show";
                    }, 1000);
                }
            });

            BuyWithCrypto.registerCallback('onFailure', function (e) {
                return;
                if (checkoutDone === false) {
                    checkoutDone = true;
                    let audio = new Audio('sounds/notification.wav');
                    setTimeout(function () {
                        let toast = document.getElementById("toast");
                        document.getElementById("oid").innerText = e.code;
                        audio.play();
                        toast.className = "show";
                    }, 1000);
                }
            });

            BuyWithCrypto.registerCallback('onPaymentDetected', function (e) {
                if (checkoutDone === false) {
                    checkoutDone = true;
                    let audio = new Audio('sounds/notification.wav');
                    setTimeout(function () {
                        let toast = document.getElementById("toast");
                        document.getElementById("oid").innerText = e.code;
                        audio.play();
                        toast.className = "show";
                    }, 1000);
                }
            });
        }

        function fallbackCopyTextToClipboard(text) {
            var textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";

            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();

            try {
                var successful = document.execCommand('copy');
            } catch (err) {
            }

            document.body.removeChild(textArea);
        }
        function copyTextToClipboard(text) {
            if (!navigator.clipboard) {
                fallbackCopyTextToClipboard(text);
                return;
            }
            navigator.clipboard.writeText(text).then(function () {
            }, function (err) {
            });
        }



        function PIRICheckout() {
            this.invoiceJSON = null;
            this.loadedJS = 0;
            this._self = this;
            this.working = true;
        };
        const PIRICheckoutPrototype = {
            validateEmail(email) {
                let res = /^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/;
                return res.test(email);
            },
            validateLength(value) {
                if (value.length > 0) {
                    return true;
                }
                return false;
            },
            async createInvoice(name, email, product, answ) {
                let invoice = new Object();
                invoice.Name = name;
                invoice.Email = email;
                invoice.Product = product;
                invoice.do = "createinvoice";
                let jsonString = JSON.stringify(invoice);

                const response = await fetch('https://checkoutpiri.azurewebsites.net/api/CheckoutAPI?code=TjPLuNeU_35LH8TDIY6byBmEMx7guO4MLBldG1tDeKIZAzFuCiPJTA==', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json; charset=utf-8',
                        'Access-Control-Allow-Origin': '*',
                        'Access-Control-Allow-Methods': 'POST,PATCH,OPTIONS'
                    },
                    body: jsonString
                });
                return await response.json();
            },
            startCountdown(c, seconds, callback) {
                var $circleBorder = $('.countdown__icon__circle').get(c);
                $('.countdown__icon__circle').css("stroke-dashoffset", 0);
                $('.countdown__icon__circle').css("stroke", '#76e19e');
                $('.countdown__icon__circle').css("stroke-dasharray", 375.787322998);

                var $countdown = $('.countdown');

                var length = $circleBorder.getTotalLength();
                var counter = {
                    var: seconds
                };

                var tl = new TimelineMax({
                    delay: 0.0,
                });

                tl.play();

                tl.set($countdown, {
                    scale: 0,
                }).to($countdown, 0.4, {
                    scale: 1,
                    ease: Back.easeOut.config(1.4),
                }).to($circleBorder, seconds, {
                    strokeDashoffset: length,
                    stroke: '#FB7593',
                    ease: Power0.easeNone
                }).to(counter, seconds, {
                    var: 0,
                    onUpdate: function () {
                        let _minutes = Math.floor(counter.var / 60);
                        let _seconds = Math.floor(counter.var - _minutes * 60);
                        _minutes = _minutes.toString().padStart(2, '0');
                        _seconds = _seconds.toString().padStart(2, '0');
                        $('.countdown__number').html(_minutes + ":" + _seconds);
                    },
                    ease: Power0.easeNone
                }, '-= 10')
                    .to($countdown, 0.4, {
                        scale: 0,
                        ease: Back.easeIn.config(1.4),
                        onComplete: function () {
                            callback();
                        }
                    });
                return tl;
            },
            async checkWallet(wallet) {
                let bal = 0.0;
                let req = new Object();
                req.address = wallet;
                req.assetID = "-1";
                let jsonString = JSON.stringify(req);


                const response = await fetch('https://core.pirichain.com/getBalance', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    body: jsonString,
                });
                let invoiceJSON = await response.json();
                bal = parseFloat(invoiceJSON.balance);
                return bal;
            },
            showInvoice() {
                let anim1 = null;
                let anim2 = null;
                let _t= null;
                let _self = this;

                $('#checkout2-wait').css("display", "none");
                $('#checkout2-qr').css("display", "none");
                $('#checkout2-error').css("display", "none");
                $('#checkout2-confirmed').css("display", "none");
                $('#checkout2-waitconfirm').css("display", "none");

                $('#checkout2Modal').css("display", "flex");
                $('#checkout2-input').css("display", "flex");

                $('#close-checkout2').off().on("click", function () {

                    $('#checkout2Modal').css('display', 'none');
                    if (anim1 != null) anim1.pause();
                    if (anim2 != null) anim2.pause();
                    if (_t != null) clearInterval(_t);
                });

                const list = document.getElementById("qrcode");

                while (list.hasChildNodes()) {
                    list.removeChild(list.firstChild);
                }

                $("#nextCheckout2").off().on("click", function () {

                    let fname = $('#fname');
                    let email = $('#email');
                    fname.css("borderColor", "black");
                    email.css("borderColor", "black");
                    if (!_self.validateLength(fname.val())) {
                        fname.css("borderColor", "red");
                    } else if (!_self.validateEmail(email.val())) {
                        email.css("borderColor", "red");
                    } else {
                        $('#checkout2-input').css("display", "none");
                        $('#checkout2-wait').css("display", "flex");
                        _self.createInvoice(fname.val(), email.val(), "1").then(function (invoiceJSON) {
                            if(_self.working!==true)return;

                            $('#checkout2-wait').css("display", "none");

                            anim1 = _self.startCountdown(0, 3600, function () {
                                if(_self.working!==true)return;
                                $('#checkout2-qr').css("display", "none");
                                $('#checkout2-error').css("display", "flex");


                                let checkout2errormsg = document.getElementById("errorMsg");
                                checkout2errormsg.innerText = "Time is over.";
                                checkout2errormsg.style.display = "flex";
                            });


                            if ((invoiceJSON !== null) && (invoiceJSON !== undefined)) {
                                _self.invoiceJSON = invoiceJSON;

                                $('#checkout2-qr').css("display", "flex");

                                let checkout2qr = document.getElementById("qrcode");
                                checkout2qr.style.display = "flex";

                                var qrcode = new QRCode(checkout2qr, {
                                    text: _self.invoiceJSON.Walletid,
                                    width: 170,
                                    height: 170,
                                    colorDark: "#000000",
                                    colorLight: "#ffffff",
                                    correctLevel: QRCode.CorrectLevel.H
                                });

                                $("#checkout2-Address").text(_self.invoiceJSON.Walletid);
                                $("#checkout2-Amount").text(_self.invoiceJSON.Amount);
                                $("#checkout2-Email").text(_self.invoiceJSON.Email);

                                $("#checkout2paid").off().on("click", function () {
                                    if(_self.working!==true)return;
                                    anim1.pause();
                                    $('#checkout2-qr').css("display", "none");
                                    $('#checkout2-waitconfirm').css("display", "flex");

                                    

                                    anim2 = _self.startCountdown(1, 180, function () {
                                        if(_self.working!==true)return;

                                        clearInterval(_t);
                                        $('#checkout2-waitconfirm').css("display", "none");

                                        let checkout2errormsg = document.getElementById("errorMsg");
                                        checkout2errormsg.innerText = "Time is over.";
                                        checkout2errormsg.style.display = "flex";

                                        let checkout2error = document.getElementById("checkout2-error");
                                        checkout2error.style.display = "flex";
                                    });

                                    _t = setInterval(function () {
                                        _self.checkWallet(_self.invoiceJSON.Walletid).then(function (r) {
                                            if(_self.working!==true)return;
                                            if (r >= parseFloat(_self.invoiceJSON.Amount)) {
                                                anim2.pause();
                                                clearInterval(_t);
                                                $('#checkout2-waitconfirm').css("display", "none");

                                                let checkout2confirmed = document.getElementById("checkout2-confirmed");
                                                checkout2confirmed.style.display = "flex";

                                                let audio = new Audio('sounds/notification.wav');
                                                setTimeout(function () {
                                                    let toast = document.getElementById("toast");
                                                    toast.classList.remove("show");
                                                    document.getElementById("oid").innerText = _self.invoiceJSON.id;
                                                    audio.play();
                                                    toast.className = "show";
                                                    toast.style.display = "block";
                                                }, 1000);
                                            }
                                        });
                                    }, 2000);
                                });
                            } else {
                                $('#checkout2-wait').css("display", "none");

                                let checkout2errormsg = document.getElementById("errorMsg");
                                checkout2errormsg.innerText = "Something was wrong.";
                                checkout2errormsg.style.display = "flex";

                                let checkout2error = document.getElementById("checkout2-error");
                                checkout2error.style.display = "flex";
                            }
                        });
                    }
                });
            },
            preRun() {
                let _self = this;
                let jsLinks = ["https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js",
                    "/js/qrgen.js"];
                for (let js of jsLinks) {
                    let usedLaterScript = document.createElement('script');
                    usedLaterScript.src = js;
                    usedLaterScript.async = true;
                    usedLaterScript.onload = () => {
                        _self.loadedJS++;
                    }
                    document.body.appendChild(usedLaterScript);
                };
                let _int = setInterval(function () {

                    if (_self.loadedJS == 2) {
                        clearInterval(_int);
                        _self.run();
                    }
                }, 50);
            },
            run: function () {
                this.showInvoice();
            }
        };

        Object.assign(PIRICheckout.prototype, PIRICheckoutPrototype);

        var GPIRICheckout = null;
        $("#btnCheckout2").on("click", function () {
            if (GPIRICheckout == null) {
                GPIRICheckout = new PIRICheckout();
                GPIRICheckout.preRun();
            } else {
                GPIRICheckout.run();
            }
        });

        $("#copy1").on("click", function () {
            $('#copy1').css("display", "none");
            $('#confirm1').css("display", "unset");
            setTimeout(function () {
                $('#copy1').css("display", "unset");
                $('#confirm1').css("display", "none");
            }, 2000);
        });

        $("#copy2").on("click", function () {
            $('#copy2').css("display", "none");
            $('#confirm2').css("display", "unset");
            setTimeout(function () {
                $('#copy2').css("display", "unset");
                $('#confirm2').css("display", "none");
            }, 2000);
        });

        $("#copy3").on("click", function () {
            $('#copy3').css("display", "none");
            $('#confirm3').css("display", "unset");
            setTimeout(function () {
                $('#copy3').css("display", "unset");
                $('#confirm3').css("display", "none");
            }, 2000);
        });
    </script>
</body>

</html>